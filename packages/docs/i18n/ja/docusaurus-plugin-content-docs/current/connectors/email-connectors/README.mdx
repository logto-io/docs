---
id: email-connectors
title: Email connectors
sidebar_label: Email connectors
sidebar_position: 1
---

# Email connectors

Email コネクターは、メール配信サービスを Logto と統合し、メールを通じた安全なユーザー認証 (Authentication) を可能にします。設定が完了すると、ユーザーの [サインアップ](/end-user-flows/sign-up-and-sign-in/sign-up)、[サインイン](/end-user-flows/sign-up-and-sign-in/sign-in)、[パスワードリセット](/end-user-flows/sign-up-and-sign-in/reset-password)、[アカウントリンク](/end-user-flows/sign-up-and-sign-in/social-sign-in#account-linking)、[メンバー招待](/end-user-flows/organization-experience/invite-organization-members)、および [高リスク操作の検証](/end-user-flows/security-verification) のために [ワンタイムパスワード (OTPs)](https://auth.wiki/otp) を送信できます。

## Email コネクターを選択する \{#choose-your-email-connector}

Logto は 3 種類の Email コネクターオプションを提供しています：

### 無料の Logto Email サービス (Cloud のみ) \{#free-logto-email-service-cloud-only}

この組み込みのメールサービスオプションは、[テスト](/logto-cloud/tenant-settings#development) と [本番](/logto-cloud/tenant-settings#production) の両方で迅速に開始するのに理想的です。サードパーティの統合が不要で、無料で信頼性のあるメール配信を提供します。事前にデザインされたメールテンプレートに対して基本的なブランディングをカスタマイズするだけです。

Logto Email サービスコネクターは現在、ロゴ、会社情報、送信者名を含むブランディングカスタマイズ機能を提供しています。

ただし、便利ではありますが、送信者のメールアドレス、ドメイン、特定のメール内容をカスタマイズできないという制限があります。

```mdx-code-block
import DocCardList from '@theme/DocCardList';
import LogtoEmailService from '@site/docs/connectors/assets/icons/logto-email-service.svg';
import AwsDm from '@site/docs/connectors/assets/icons/aws-direct-mail.svg';
import SendGrid from '@site/docs/connectors/assets/icons/sendgrid.svg';
import Mailgun from '@site/docs/connectors/assets/icons/mailgun.svg';
import Postmark from '@site/docs/connectors/assets/icons/postmark.svg';
import AliyunDm from '@site/docs/connectors/assets/icons/aliyun-direct-mail.svg';
import Smtp from '@site/docs/connectors/assets/icons/smtp.svg';
import Http from '@site/docs/connectors/assets/icons/http.svg';

<DocCardList
  items={[
    {
      type: 'link',
      label: 'Logto Email Service',
      href: '/connectors/email-connectors/built-in-email-service',
      description: 'Official connector for Logto Email Service.',
      customProps: {
        icon: <LogtoEmailService />,
      }
    },
  ]}
/>
```

### 人気のあるメールプロバイダー \{#popular-email-providers}

Logto のステップバイステップガイドを使用して、お好みのメールサービスプロバイダー (ESP) と接続します。

これらのオプションでは、メールテンプレート、送信者名の完全な [カスタマイズ](/connectors/email-connectors/email-templates)、変数の追加などを行い、ブランディングに最適なサービスを提供できます。

以下のメールサービスプロバイダーに対して、すぐに使用できるサポートを提供しています：

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'AWS Direct Mail',
      href: '/integrations/aws-ses',
      description: 'The official Logto connector for AWS connector for direct mail service.',
      customProps: {
        icon: <AwsDm />,
      }
    },
    {
      type: 'link',
      label: 'Mailgun',
      href: '/integrations/mailgun',
      description: 'The official Logto connector for Mailgun email service.',
      customProps: {
        icon: <Mailgun />,
      }
    },
    {
      type: 'link',
      label: 'SendGrid Email',
      href: '/integrations/sendgrid-email',
      description: 'The official Logto connector for SendGrid email service.',
      customProps: {
        icon: <SendGrid />,
      }
    },
    {
      type: 'link',
      label: 'Aliyun Direct Mail',
      href: '/integrations/aliyun-dm',
      description: 'The official Logto connector for Aliyun connector for direct mail service.',
      customProps: {
        icon: <AliyunDm />,
      }
    },
    {
      type: 'link',
      label: 'Postmark Mail',
      href: '/integrations/postmark',
      description: 'Logto connector for Postmark email service.',
      customProps: {
        icon: <Postmark />,
      }
    },
  ]}
/>
```

### Email コネクターをカスタマイズする \{#customize-your-email-connector}

上記のソリューションがニーズを満たさない場合は、Simple Mail Transfer Protocol (SMTP) を使用して希望のメールサービスに接続することもできます。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'SMTP',
      href: '/integrations/smtp',
      description: 'The official Logto connector for SMTP.',
      customProps: {
        icon: <Smtp />,
      }
    },
  ]}
/>
```

すでに独自のメールサービスを持っていて、SMTP 接続を使用する資格がない場合は、「HTTP email connector」も提供しています。

メールを送信する必要がある場合、設定された `endpoint` に API コールを送信して、メールに依存する認証フローを完了します。認証フローのエラーを防ぐために、設定されたエンドポイントは WebHook を受信した後に 200 応答を返し、Logto にメール送信の通知を受け取ったことを知らせる必要があります。この場合、独自のメールサービスを監視して、配信が成功するようにする必要があります。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'HTTP email connector',
      href: '/integrations/http-email',
      description: 'The official Logto connector for HTTP email.',
      customProps: {
        icon: <Http />,
      }
    },
  ]}
/>
```

標準のコネクターが特定の要件を満たさない場合は、[お問い合わせ](https://logto.productlane.com/roadmap)ください。OSS ユーザーの場合、要件が緊急であれば [コネクターを実装する (OSS)](/logto-oss/develop-your-connector/implement-connectors#build-a-passwordless-connector) ことができます。私たちは常に [貢献](/logto-oss/contribution) を歓迎しています。あなたの努力が同じニーズを持つ他のコミュニティメンバーを助けるかもしれません。

## 設定手順 \{#configure-steps}

以下の手順に従って、Email コネクターを追加してください：

1. <CloudLink to="/connectors/passwordless">
     Console > Connectors > Email and SMS connectors{' '}
   </CloudLink>
   に移動します。
2. 新しい Email コネクターを追加するには、「Set up」ボタンをクリックし、希望のメールプロバイダーを選択します。
3. README ドキュメントを確認し、選択したプロバイダーの設定をステップバイステップで行います。
4. 「Save and Done」をクリックして完了します。

:::note

重要なメール（認証コードなど）がユーザーの受信トレイに確実に届き、スパムフィルターを回避するために、次の 2 つの優先事項に焦点を当ててください：

- **メール認証 (SPF, DKIM, DMARC) の設定**
  メールプロバイダー (Gmail, Outlook など) は、これらのプロトコルを使用してスパム送信者でないことを確認します。これらの設定がないと、メールがスパムに入ったり拒否されたりする可能性があります。
  - SPF (Sender Policy Framework)：ドメインのメール送信を許可されたサーバー / IP をリストします。
  - DKIM (DomainKeys Identified Mail)：メールが改ざんされていないことを証明するデジタル署名を追加します。
  - DMARC (Domain-based Message Authentication)：SPF / DKIM に失敗したメールを受信者がどのように処理するかを指示します。
- **認証メールとマーケティングメールを分離する**
  マーケティングメールはスパムの苦情や高いバウンス率を引き起こすことがよくあります。認証メールが同じドメイン / IP を共有している場合、その配信可能性が低下します。
  - 専用ドメインを使用する：`@auth.yourdomain.com` から認証メールを送信し、`@marketing.yourdomain.com` からマーケティングメールを送信します。
  - 専用 IP：認証メール用にユニークな IP をリクエストし、徐々にウォームアップします。
  - 「From」アドレスを一致させる：送信者ドメインが SPF / DKIM / DMARC レコードと一致していることを確認します。

:::

## Email コネクターの変更 \{#change-email-connector}

Email コネクターは 1 つしか追加できないことに気付くかもしれません。

すでに Email コネクターがある場合、「Email コネクターを変更する」しか選択できません。この操作をコンソールで実行すると、保存されるとすぐに有効になるため、保存する前に設定をテストしてください。

サービスの安定性を確保するために、Cloud ユーザーは開発環境用に [dev テナント](/logto-cloud/tenant-settings#development) を作成できます。開発環境で設定をテストした後、設定を [本番](/logto-cloud/tenant-settings#production) に「移行」し、セットアップを保存します。

## Email サインアップまたはサインインを有効にする \{#enable-email-sign-up-or-sign-in}

Email コネクターを正常に追加し、設定を完了すると、ビジネスニーズに応じてメール + 認証コードに依存するサインインおよびサインアップ設定を有効にできます。

1. **移動先：** <CloudLink to="/sign-in-experience/sign-up-and-sign-in">Console > Sign-in experience > Sign-up and sign-in</CloudLink>
2. [**サインアップ方法を設定する**](/end-user-flows/sign-up-and-sign-in/sign-up)：サインアップ識別子として「メールアドレス」または「メールアドレスまたは電話番号」を選択します。注意：サインアップ時のメール認証は現在必須です。
3. [**サインイン方法を設定する**](/end-user-flows/sign-up-and-sign-in/sign-in)：選択したサインアップ識別子は自動的にサインイン方法になります。追加のサインインオプションを追加するには「Add another」をクリックします。
4. **変更を保存してテストする：** 新しいサインイン体験を実装するには「Save changes」をクリックします。機能をテストするために「[Live preview](/customization/live-preview)」を使用することを忘れないでください。

:::warning
設定が即座に有効になるため、既存の Email コネクターを削除すると、エンドユーザーの通常のログインおよび登録プロセスに影響を与える可能性があります。

たとえば、サインイン識別子に「メール + 認証コード」の組み合わせが含まれている場合、既存の Email コネクターを削除すると、ユーザーがメールで認証コードを受け取れなくなり、サインインフローでエラーが発生します。

コネクターの操作時には、潜在的なリスクに注意してください。
:::

## FAQs \{#faqs}

<details>
<summary>

### メール送信者名をカスタマイズする方法は？ \{#how-to-customize-the-email-sender-name}

</summary>

私たちはまだ多くのコネクターに取り組んでいます。さらにオプションが必要な場合は、Discord でニーズをお知らせいただき、[GitHub](https://github.com/logto-io/logto/issues) で機能リクエストを提出してください。さらにサポートが必要な場合は、[メールでお問い合わせ](mailto:contact@logto.io) いただくこともできます。

貢献者の方には、特定のシナリオに基づいて [独自のコネクターをカスタマイズ](/logto-oss/develop-your-connector) できる、拡張しやすいコネクター作成方法を提供しています。Logto にプルリクエストを提出することを常に歓迎していますので、コミュニティの他の人々もあなたの作業から恩恵を受けることができます。

</details>

<details>
<summary>

### Logto Email コネクターでメールリクエストの IP アドレスを制限する方法は？ \{#how-can-i-restrict-ip-addresses-for-email-requests-in-logto-email-connectors}

</summary>

1 つの回避策は、Logto HTTP email connector を使用することです。

サーバー上に関連するメールサービスを呼び出す API エンドポイントを実装し、この API エンドポイントを Logto の [HTTP email connector](/integrations/http-email) を通じてトリガーします。この方法では、API エンドポイントの IP アドレスを完全に制御でき、メールサービスプロバイダーの設定に対応する IP アドレスをホワイトリストに追加できます。

</details>
