Logto は、IdP から返されるユーザー属性を Logto のユーザー属性にマッピングする柔軟な方法を提供します。Logto はデフォルトで次のユーザー属性を IdP から同期します：

- id: ユーザーの一意の識別子。Logto は SAML レスポンスから `nameID` クレームを読み取り、ユーザーの SSO アイデンティティ ID として使用します。
- email: ユーザーのメールアドレス。Logto はデフォルトで SAML レスポンスから `email` クレームを読み取り、ユーザーのプライマリメールとして使用します。
- name: ユーザーの名前。

ユーザー属性のマッピングロジックは、Azure AD 側または Logto 側のいずれかで管理できます。

1. AzureAD ユーザー属性を Logto ユーザー属性に Logto 側でマッピングします。

   Azure AD SSO アプリケーションの `Attributes & Claims` セクションにアクセスします。

   次の属性名（名前空間プレフィックス付き）をコピーして、Logto の対応するフィールドに貼り付けます。

   - `http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress`
   - `http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name` （推奨：この属性値マップを `user.displayname` に更新して、より良いユーザー体験を提供します）

<img
  src="/img/assets/azure_ad_default_attribute_mapping.webp"
  alt="Azure AD デフォルト属性マッピング"
/>

1. AzureAD ユーザー属性を AzureAD 側で Logto ユーザー属性にマッピングします。

   Azure AD SSO アプリケーションの `Attributes & Claims` セクションにアクセスします。

   `Edit` をクリックし、Logto ユーザー属性設定に基づいて `Additional claims` フィールドを更新します：

   - Logto ユーザー属性設定に基づいてクレーム名の値を更新します。
   - 名前空間プレフィックスを削除します。
   - `Save` をクリックして続行します。

   次の設定で終了する必要があります：

<img src="/img/assets/azure_ad_logto_attribute_mapping.webp" alt="Azure AD_Logto 属性マッピング" />

Azure AD 側で追加のユーザー属性を指定することもできます。Logto は、ユーザーの `sso_identity` フィールドの下に IdP から返された元のユーザー属性の記録を保持します。
