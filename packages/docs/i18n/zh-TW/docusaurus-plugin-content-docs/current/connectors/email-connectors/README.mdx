---
id: email-connectors
title: 電子郵件連接器
sidebar_label: 電子郵件連接器
sidebar_position: 1
---

# 電子郵件連接器

電子郵件連接器將你的電子郵件傳送服務與 Logto 整合，以透過電子郵件啟用安全的使用者驗證。一旦配置完成，你可以發送 [一次性密碼 (OTPs)](https://auth.wiki/otp) 用於使用者的[註冊](/end-user-flows/sign-up-and-sign-in/sign-up)、[登入](/end-user-flows/sign-up-and-sign-in/sign-in)、[重設密碼](/end-user-flows/sign-up-and-sign-in/reset-password)、[帳戶連結](/end-user-flows/sign-up-and-sign-in/social-sign-in#account-linking)、[成員邀請](/end-user-flows/organization-experience/invite-organization-members)和[高風險操作驗證](/end-user-flows/security-verification)。

## 選擇你的電子郵件連接器 \{#choose-your-email-connector}

Logto 提供三種類型的電子郵件連接器選項：

### 免費 Logto 電子郵件服務（僅限 Cloud）\{#free-logto-email-service-cloud-only}

這個內建的電子郵件服務選項非常適合快速開始進行[測試](/logto-cloud/tenant-settings#development)和[生產](/logto-cloud/tenant-settings#production)。它消除了對第三方整合的需求，並提供免費且可靠的電子郵件傳送。只需為預設的電子郵件模板自訂基本品牌。

Logto 電子郵件服務連接器現在提供品牌自訂功能，包括標誌、公司資訊和發件人名稱。

然而，儘管方便，但有一些限制需要注意——你無法自訂發件人的電子郵件地址、網域或特定的電子郵件內容。

```mdx-code-block
import DocCardList from '@theme/DocCardList';
import LogtoEmailService from '@site/docs/connectors/assets/icons/logto-email-service.svg';
import AwsDm from '@site/docs/connectors/assets/icons/aws-direct-mail.svg';
import SendGrid from '@site/docs/connectors/assets/icons/sendgrid.svg';
import Mailgun from '@site/docs/connectors/assets/icons/mailgun.svg';
import Postmark from '@site/docs/connectors/assets/icons/postmark.svg';
import AliyunDm from '@site/docs/connectors/assets/icons/aliyun-direct-mail.svg';
import Smtp from '@site/docs/connectors/assets/icons/smtp.svg';
import Http from '@site/docs/connectors/assets/icons/http.svg';

<DocCardList
  items={[
    {
      type: 'link',
      label: 'Logto Email Service',
      href: '/connectors/email-connectors/built-in-email-service',
      description: 'Logto 電子郵件服務的官方連接器。',
      customProps: {
        icon: <LogtoEmailService />,
      }
    },
  ]}
/>
```

### 流行的電子郵件提供商 \{#popular-email-providers}

使用 Logto 的逐步指南連接到你偏好的電子郵件服務提供商 (ESP)。

這些選項允許你完全[自訂你的電子郵件模板](/connectors/email-connectors/email-templates)、發件人名稱、添加變數等，以最佳方式服務於你的品牌。

我們提供以下電子郵件服務提供商的即時支援：

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'AWS Direct Mail',
      href: '/integrations/aws-ses',
      description: 'AWS 直接郵件服務的 Logto 官方連接器。',
      customProps: {
        icon: <AwsDm />,
      }
    },
    {
      type: 'link',
      label: 'Mailgun',
      href: '/integrations/mailgun',
      description: 'Mailgun 電子郵件服務的 Logto 官方連接器。',
      customProps: {
        icon: <Mailgun />,
      }
    },
    {
      type: 'link',
      label: 'SendGrid Email',
      href: '/integrations/sendgrid-email',
      description: 'SendGrid 電子郵件服務的 Logto 官方連接器。',
      customProps: {
        icon: <SendGrid />,
      }
    },
    {
      type: 'link',
      label: 'Aliyun Direct Mail',
      href: '/integrations/aliyun-dm',
      description: '阿里雲直接郵件服務的 Logto 官方連接器。',
      customProps: {
        icon: <AliyunDm />,
      }
    },
    {
      type: 'link',
      label: 'Postmark Mail',
      href: '/integrations/postmark',
      description: 'Postmark 電子郵件服務的 Logto 連接器。',
      customProps: {
        icon: <Postmark />,
      }
    },
  ]}
/>
```

### 自訂你的電子郵件連接器 \{#customize-your-email-connector}

如果上述解決方案都不符合你的需求，你也可以選擇使用簡單郵件傳輸協定 (SMTP) 連接到你想要的電子郵件服務。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'SMTP',
      href: '/integrations/smtp',
      description: 'SMTP 的 Logto 官方連接器。',
      customProps: {
        icon: <Smtp />,
      }
    },
  ]}
/>
```

如果你已經擁有自己的電子郵件服務且不適合使用 SMTP 連接，我們也提供「HTTP 電子郵件連接器」。

當需要發送電子郵件時，它會向配置的 `endpoint` 發送 API 呼叫以完成依賴電子郵件的驗證流程。請注意，為防止驗證流程錯誤，配置的 endpoint 在接收到 WebHook 後需要返回 200 響應，以通知 Logto 已收到發送電子郵件的通知。在這種情況下，你需要監控自己的電子郵件服務以確保成功傳送。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'HTTP 電子郵件連接器',
      href: '/integrations/http-email',
      description: 'HTTP 電子郵件的 Logto 官方連接器。',
      customProps: {
        icon: <Http />,
      }
    },
  ]}
/>
```

如果我們的標準連接器無法滿足你的特定需求，請隨時[聯繫我們](https://logto.productlane.com/roadmap)。對於 OSS 使用者，如果需求緊急，你可以[實現你的連接器 (OSS)](/logto-oss/develop-your-connector/implement-connectors#build-a-passwordless-connector)。我們始終歡迎[貢獻](/logto-oss/contribution)；你的努力可能會幫助其他有相同需求的社群成員。

## 配置步驟 \{#configure-steps}

按照以下步驟添加電子郵件連接器：

1. 前往 <CloudLink to="/connectors/passwordless">控制台 > 連接器 > 電子郵件和簡訊連接器 </CloudLink>。
2. 要添加新的電子郵件連接器，點擊「設定」按鈕並選擇你想要的電子郵件提供商。
3. 查看 README 文件並逐步配置你選擇的提供商。
4. 點擊「儲存並完成」以完成。

:::note

為確保重要電子郵件（如驗證碼）可靠地到達使用者的收件箱並避免垃圾郵件過濾器，請專注於兩個優先事項：

- **設定電子郵件驗證 (SPF, DKIM, DMARC)**
  電子郵件提供商（Gmail、Outlook 等）使用這些協議來驗證你不是垃圾郵件發送者。缺少這些設置可能會導致你的電子郵件進入垃圾郵件或被拒絕。
  - SPF (Sender Policy Framework)：列出允許為你的網域發送電子郵件的伺服器 / IP。
  - DKIM (DomainKeys Identified Mail)：添加數位簽名以證明電子郵件未被篡改。
  - DMARC (Domain-based Message Authentication)：告訴接收者如何處理未通過 SPF / DKIM 的電子郵件。
- **分開驗證與行銷電子郵件**
  行銷電子郵件經常引發垃圾郵件投訴或高退信率。如果驗證電子郵件與行銷電子郵件共享相同的網域 / IP，其傳送能力會受到影響。
  - 使用專用網域：從 `@auth.yourdomain.com` 發送驗證電子郵件，從 `@marketing.yourdomain.com` 發送行銷電子郵件。
  - 專用 IP：為驗證電子郵件請求一個唯一的 IP，並慢慢加熱。
  - 匹配「發件人」地址：確保發件人網域與 SPF / DKIM / DMARC 記錄一致。

:::

## 更改電子郵件連接器 \{#change-email-connector}

你可能會注意到只能添加一個電子郵件連接器。

當你已經有一個電子郵件連接器時，你只能選擇「更改電子郵件連接器」。在控制台中執行此操作時，一旦儲存即立即生效，因此請確保在儲存前測試你的配置。

為確保服務的穩定性，Cloud 使用者可以為開發環境創建一個 [dev 租戶](/logto-cloud/tenant-settings#development)。在開發環境中測試配置後，將配置「遷移」到[生產環境](/logto-cloud/tenant-settings#production)，然後儲存設置。

## 啟用電子郵件註冊或登入 \{#enable-email-sign-up-or-sign-in}

一旦你成功添加電子郵件連接器並完成配置，你可以根據業務需求啟用依賴電子郵件 + 驗證碼的登入和註冊配置。

1. **前往：**<CloudLink to="/sign-in-experience/sign-up-and-sign-in">控制台 > 登入體驗 > 註冊和登入</CloudLink>
2. [**設置註冊方法**](/end-user-flows/sign-up-and-sign-in/sign-up)：選擇「電子郵件地址」或「電子郵件地址或電話號碼」作為註冊識別符。注意：目前註冊時電子郵件驗證是必須的。
3. [**設置登入方法**](/end-user-flows/sign-up-and-sign-in/sign-in)：選擇的註冊識別符自動成為登入方法。點擊「添加另一個」以獲得其他登入選項。
4. **儲存更改並測試：**點擊「儲存更改」以實施新的登入體驗。記得使用「[即時預覽](/customization/live-preview)」來測試功能。

:::warning
由於我們的配置會立即生效，刪除現有的電子郵件連接器可能會影響終端使用者的正常登入和註冊流程。

例如，如果登入識別符包含「電子郵件 + 驗證碼」組合，刪除現有的電子郵件連接器將阻止使用者通過電子郵件接收驗證碼，並導致登入流程出錯。

請在操作連接器時注意潛在風險。
:::

## 常見問題 \{#faqs}

<details>
<summary>

### 如何自訂電子郵件發件人名稱？\{#how-to-customize-the-email-sender-name}

</summary>

我們仍在開發更多連接器。如果你需要更多選項，請在 Discord 上告訴我們你的需求，並在 [GitHub](https://github.com/logto-io/logto/issues) 上提交功能請求。如果你需要進一步的協助，你也可以[通過電子郵件聯繫我們](mailto:contact@logto.io)。

對於貢獻者，我們提供了一種易於擴展的連接器創建方法，允許你根據特定情境[自訂你的連接器](/logto-oss/develop-your-connector)。我們隨時歡迎你向 Logto 提交 pull request，以便社群中的其他人也能從你的工作中受益。

</details>

<details>
<summary>

### 如何在 Logto 電子郵件連接器中限制電子郵件請求的 IP 地址？\{#how-can-i-restrict-ip-addresses-for-email-requests-in-logto-email-connectors}

</summary>

一種解決方法是使用 Logto HTTP 電子郵件連接器。

在你的伺服器上實現一個 API endpoint，調用相關的電子郵件服務，並通過 Logto [HTTP 電子郵件連接器](/integrations/http-email) 觸發此 API endpoint。這樣，你將擁有對 API endpoint 的 IP 地址的完全控制權，並可以將相應的 IP 地址添加到電子郵件服務提供商配置中的白名單中。

</details>
