"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[19344],{1886:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"authorization/organization-template/protect-api-reources","title":"API-Ressource mit Organisationstemplate sch\xfctzen","description":"Zus\xe4tzlich zu Sch\xfctze deine API, das Ressourcen sichert, indem es sicherstellt, dass ein g\xfcltiges JWT vorhanden ist, k\xf6nnen auch Organisationsrollen angewendet werden, um die Berechtigungen zu filtern. In diesem Artikel konzentrieren wir uns darauf, wie die Organisationsrolle die Berechtigungsdelegation und -validierung in deinem Authentifizierungsablauf beeinflusst.","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/authorization/organization-template/protect-api-reources.mdx","sourceDirName":"authorization/organization-template","slug":"/authorization/organization-template/protect-api-reources","permalink":"/de/authorization/organization-template/protect-api-reources","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/de/docusaurus-plugin-content-docs/current/authorization/organization-template/protect-api-reources.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Organisationsressourcen sch\xfctzen","permalink":"/de/authorization/organization-template/protect-organization-resources"},"next":{"title":"Autorisierung","permalink":"/de/authorization/"}}');var r=i(86070),o=i(15658);const a={sidebar_position:3},s="API-Ressource mit Organisationstemplate sch\xfctzen",c={},d=[{value:"Der zus\xe4tzliche <code>organization_id</code> Parameter",id:"der-zus\xe4tzliche-organization_id-parameter",level:2},{value:"Client-Einrichtung",id:"client-einrichtung",level:2},{value:"API-Server-Validierung",id:"api-server-validierung",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",mermaid:"mermaid",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"api-ressource-mit-organisationstemplate-sch\xfctzen",children:"API-Ressource mit Organisationstemplate sch\xfctzen"})}),"\n",(0,r.jsxs)(n.p,{children:["Zus\xe4tzlich zu ",(0,r.jsx)(n.a,{href:"/authorization/api-resources/protect-your-api",children:"Sch\xfctze deine API"}),", das Ressourcen sichert, indem es sicherstellt, dass ein g\xfcltiges JWT vorhanden ist, k\xf6nnen auch Organisationsrollen angewendet werden, um die Berechtigungen zu filtern. In diesem Artikel konzentrieren wir uns darauf, wie die Organisationsrolle die Berechtigungsdelegation und -validierung in deinem Authentifizierungsablauf beeinflusst."]}),"\n",(0,r.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Logto\n    participant API\n\n    Note over Client,API: Token-Anfrage\n    Client->>Logto: POST /oidc/token\n    Note right of Client: mit Ressource, organization_id,<br/>und angeforderten Berechtigungen\n\n    Note over Logto: \xdcberpr\xfcfen, ob der Benutzer<br/>zur angegebenen Organisation geh\xf6rt\n    Logto--\x3e>Client: Gibt JWT-Zugangstoken zur\xfcck\n    Note left of Logto: Token enth\xe4lt:<br/>- Standard-JWT-Anspr\xfcche<br/>- organization_id<br/>- Berechtigungen gefiltert nach Organisationsrolle\n\n    Note over Client,API: API-Anfrage\n    Client->>API: Anfrage mit Bearer-Token\n\n    Note over API: JWT-Token validieren:<br/>1. Standard-JWT-Validierung<br/>2. \xdcberpr\xfcfen der organization_id<br/>3. \xdcberpr\xfcfen der Berechtigungen\n\n    alt Token ung\xfcltig\n        API--\x3e>Client: 401 Unautorisiert\n    else Token g\xfcltig\n        alt G\xfcltige organization_id und Berechtigung\n            API--\x3e>Client: Gesch\xfctzte Ressource\n        else Andernfalls\n            API--\x3e>Client: 403 Verboten\n        end\n    end"}),"\n",(0,r.jsxs)(n.h2,{id:"der-zus\xe4tzliche-organization_id-parameter",children:["Der zus\xe4tzliche ",(0,r.jsx)(n.code,{children:"organization_id"})," Parameter"]}),"\n",(0,r.jsxs)(n.p,{children:["Zus\xe4tzlich zur normalen Zugangstoken-Anfrage f\xfcgen wir im Diagramm einen zus\xe4tzlichen ",(0,r.jsx)(n.code,{children:"organization_id"})," Parameter hinzu. Dieser teilt Logto mit, die Berechtigungen auf die Rollen einer bestimmten Organisation einzugrenzen."]}),"\n",(0,r.jsx)(n.h2,{id:"client-einrichtung",children:"Client-Einrichtung"}),"\n",(0,r.jsxs)(n.p,{children:["Wenn du das SDK von Logto verwendest, kannst du ",(0,r.jsx)(n.code,{children:"organization_id"})," als zweiten Parameter der ",(0,r.jsx)(n.code,{children:"getAccessToken"})," Methode hinzuf\xfcgen."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"const accessToken = await logto.getAccessToken('https://my-resource.com/api', 'org_1');\n\n// Oder Anspr\xfcche direkt abrufen\nconst accessTokenClaims = await logto.getAccessTokenClaims('https://my-resource.com/api', 'org_1');\nconsole.log(accessTokenClaims.organization_id); // 'org_1'\nconsole.log(accessTokenClaims.aud); // 'https://my-resource.com/api'\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Dann werden nur die Berechtigungen, die von den Rollen dieser Organisation geerbt werden, im Zugangstoken enthalten sein, sowie ein zus\xe4tzlicher Anspruch ",(0,r.jsx)(n.code,{children:"organization_id"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"api-server-validierung",children:"API-Server-Validierung"}),"\n",(0,r.jsxs)(n.p,{children:["Zus\xe4tzlich zur normalen JWT-Zugangstoken-Validierung musst du eine zus\xe4tzliche Ebene hinzuf\xfcgen, um zu \xfcberpr\xfcfen, ob ",(0,r.jsx)(n.code,{children:"organization_id"})," vorhanden und g\xfcltig ist."]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},15658:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>s});var t=i(30758);const r={},o=t.createContext(r);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);