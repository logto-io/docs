"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[27151],{24566:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"logto-oss/central-cache","title":"Central cache","description":"Logto supports using Redis\xae as a central cache for well-known data. By using a central cache, Logto can significantly speed up the end-user experience by reducing the number of database queries needed to generate a response.","source":"@site/docs/logto-oss/central-cache.mdx","sourceDirName":"logto-oss","slug":"/logto-oss/central-cache","permalink":"/logto-oss/central-cache","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/docs/logto-oss/central-cache.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Translate CLI","permalink":"/logto-oss/translate-cli"},"next":{"title":"File storage provider","permalink":"/logto-oss/file-storage-provider"}}');var t=s(86070),r=s(15658);const i={sidebar_position:5},c="Central cache",a={},d=[{value:"Configure the connection",id:"configure-the-connection",level:2},{value:"Check if the cache is working",id:"check-if-the-cache-is-working",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"central-cache",children:"Central cache"})}),"\n",(0,t.jsxs)(n.p,{children:["Logto supports using Redis\xae",(0,t.jsx)(n.sup,{children:(0,t.jsx)(n.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})," as a central cache for well-known data. By using a central cache, Logto can significantly speed up the end-user experience by reducing the number of database queries needed to generate a response."]}),"\n",(0,t.jsx)(n.p,{children:"Typically, the cache can be made public since it is designed for well-known data only. At present, Logto does not store any data requiring authentication or authorization."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"To ensure the best security practices, we still advise limiting access to the cache."})}),"\n",(0,t.jsx)(n.h2,{id:"configure-the-connection",children:"Configure the connection"}),"\n",(0,t.jsxs)(n.p,{children:["To enable the cache, you will need a Redis 6.0 instance that is up and running. In order for Logto to connect and use the cache, simply set the ",(0,t.jsx)(n.code,{children:"REDIS_URL"})," environment variable to the Redis connection string, which should begin with the ",(0,t.jsx)(n.a,{href:"https://www.iana.org/assignments/uri-schemes/prov/redis",children:'"redis" protocol'})," (",(0,t.jsx)(n.code,{children:"redis://"}),") for unsecured connections, or the ",(0,t.jsx)(n.a,{href:"https://www.iana.org/assignments/uri-schemes/prov/rediss",children:'"redis" protocol'})," (",(0,t.jsx)(n.code,{children:"redis://"}),") for connection over TLS."]}),"\n",(0,t.jsx)(n.p,{children:"For example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"REDIS_URL=redis://your-redis-username:your-password@your.redis.url.com:6380\n"})}),"\n",(0,t.jsx)(n.p,{children:'Please note that most parts of the connection string can be omitted, as shown in the example below, which composes a connection string without the username and port, using the "redis" protocol:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"REDIS_URL=redis://:your-password@your.redis.url.com\n"})}),"\n",(0,t.jsx)(n.p,{children:"If the password contains special characters, it needs to be URI-encoded:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# If the password is "foo="\nREDIS_URL=redis://:foo%3D@your.redis.url.com\n'})}),"\n",(0,t.jsx)(n.p,{children:"In cases where all default values are in use, you can set the variable to a truthy value for convenience:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'REDIS_URL=1 # or "true", "yes"\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://stackexchange.github.io/StackExchange.Redis/Configuration.html",children:"StackExchange.Redis"})," string is not supported."]})}),"\n",(0,t.jsx)(n.h2,{id:"check-if-the-cache-is-working",children:"Check if the cache is working"}),"\n",(0,t.jsx)(n.p,{children:"To check if the cache is properly connected, you should see the following message displayed when Logto starts up:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[CACHE] Connected to Redis\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Additionally, when the request hits the cache (for example, by accessing ",(0,t.jsx)(n.code,{children:"GET /api/.well-known/phrases"})," multiple times), the following message will appear in the console:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[CACHE] Well-known cache hit for ...\n"})}),"\n","\n",(0,t.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,t.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{id:"user-content-fn-1",children:["\n",(0,t.jsxs)(n.p,{children:["Redis is a registered trademark of Redis Ltd. Any rights therein are reserved to Redis Ltd. Any use by Silverhand is for referential purposes only and does not indicate any sponsorship, endorsement or affiliation between Redis and Silverhand. ",(0,t.jsx)(n.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},15658:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var o=s(30758);const t={},r=o.createContext(t);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);