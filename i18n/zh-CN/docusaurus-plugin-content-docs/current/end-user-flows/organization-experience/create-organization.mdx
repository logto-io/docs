---
sidebar_position: 3
---

# 创建组织 (Organization)

假设你正在构建一个[多租户应用](https://auth.wiki/multi-tenancy)（例如，多租户 SaaS 应用），为许多客户服务，每个客户拥有一个专属租户。

通常在以下情况下会创建组织 (Organization)：

1. 新客户注册并为其企业创建账户和租户。
2. 现有用户可以在应用内创建新组织 (Organization)。

<img src="/img/assets/new-account-creates-org.png" alt="新账户创建组织 (Organization)" />
<img src="/img/assets/existing-user-creates-org.png" alt="现有用户创建组织 (Organization)" />

## 实现组织 (Organization) 创建 \{#implement-organization-creation}

为你的应用创建组织 (Organization) 有两种方式。

### 通过 Logto Console 创建 \{#create-via-logto-console}

在 Logto Console UI 中手动创建组织 (Organization)。前往 <CloudLink to="/organizations">控制台 > 组织 (Organizations)</CloudLink> 创建组织 (Organization)、分配成员和角色，并自定义组织登录体验。

创建一个[组织模板](/authorization/organization-template)，批量创建具有相同角色和权限的类似组织 (Organization)。

### 通过 Logto Management API 创建 \{#create-via-logto-management-api}

控制台适合手动设置，但大多数应用允许终端用户自助——直接在你的应用中创建和管理组织 (Organization)。要实现这一点，请使用 Logto Management API 实现相关功能。

:::note

如果你是第一次接触 Logto Management API，请先阅读：

<Url href="/concepts/core-service/#management-api">Management API</Url>
<Url href="/integrate-logto/interact-with-management-api">与 Management API 交互</Url>

:::

假设你的后端通过机器对机器 (M2M) 机制连接到 Logto Management API，并已获取 M2M 访问令牌 (Access token)。

使用 Management API 创建组织 (Organization)（[API 参考](https://openapi.logto.io/operation/operation-createorganization)）：

```bash
curl \
 -X POST https://[tenant_id].logto.app/api/organizations \
 -H "Authorization: Bearer $M2M_ACCESS_TOKEN" \
 -H "Content-Type: application/json" \
 -d '{"tenantId":"string","name":"string","description":"string","customData":{},"isMfaRequired":false,"branding":{"logoUrl":"string","darkLogoUrl":"string","favicon":"string","darkFavicon":"string"},"createdAt":1234567890}'
```

然后将用户添加为组织 (Organization) 成员（[API 参考](https://openapi.logto.io/operation/operation-addorganizationusers)）：

```bash
curl \
 -X POST https://[tenant_id].logto.app/api/organizations/{id}/users \
 -H "Authorization: Bearer $M2M_ACCESS_TOKEN" \
 -H "Content-Type: application/json" \
 -d '{"userIds":["string"]}'
```

你还可以为用户分配特定的组织 (Organization) 角色（[API 参考](https://openapi.logto.io/operation/operation-assignorganizationrolestousers)）。

查看[完整 API 规范](https://openapi.logto.io/group/endpoint-organizations)获取更多细节。

将这些调用封装在你自己的 API 层。当用户在你的应用中执行“创建组织 (Organization)”操作时，先校验其权限，然后调用 Logto Management API 完成操作。

## 校验用户请求中的组织令牌 (Organization token) \{#validating-organization-token-in-user-request}

在你的应用中，当用户在组织 (Organization) 上下文中执行操作时，必须使用组织令牌 (Organization token)，而不是普通访问令牌 (Access token)。组织令牌 (Organization token) 是一个 [JWT](https://auth.wiki/jwt)，其中包含组织权限。与任何[访问令牌 (Access token)](https://auth.wiki/access-token)一样，你可以解码声明 (Claims) 并校验 "scope" 声明 (Claim) 以执行权限控制。

更多授权 (Authorization) 场景及如何校验组织令牌 (Organization token)，请参见 <Url href="/authorization">授权 (Authorization)</Url>。
