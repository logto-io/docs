---
id: email-connectors
title: 邮件连接器
sidebar_label: 邮件连接器
sidebar_position: 1
---

# 邮件连接器

邮件连接器将你的邮件发送服务与 Logto 集成，以通过电子邮件实现安全的用户验证。一旦配置完成，你可以发送 [一次性密码 (OTPs)](https://auth.wiki/otp) 用于用户 [注册](/end-user-flows/sign-up-and-sign-in/sign-up)、[登录](/end-user-flows/sign-up-and-sign-in/sign-in)、[密码重置](/end-user-flows/sign-up-and-sign-in/reset-password)、[账户关联](/end-user-flows/sign-up-and-sign-in/social-sign-in#account-linking)、[成员邀请](/end-user-flows/organization-experience/invite-organization-members) 和 [高风险操作验证](/end-user-flows/security-verification)。

## 选择你的邮件连接器

Logto 提供三种类型的邮件连接器选项：

### 免费 Logto 邮件服务（仅限 Cloud）

这个内置的邮件服务选项非常适合快速开始 [测试](/logto-cloud/tenant-settings#development) 和 [生产](/logto-cloud/tenant-settings#production)。它消除了对第三方集成的需求，并提供免费、可靠的邮件发送服务。只需为预设计的电子邮件模板自定义你的基本品牌。

Logto 邮件服务连接器现在提供品牌定制功能，包括徽标、公司信息和发件人名称。

然而，尽管方便，但需要注意一些限制——你不能自定义发件人的电子邮件地址、域名或具体的电子邮件内容。

```mdx-code-block
import DocCardList from '@theme/DocCardList';
import LogtoEmailService from '../assets/icons/logto-email-service.svg';
import AwsDm from '../assets/icons/aws-direct-mail.svg';
import SendGrid from '../assets/icons/sendgrid.svg';
import Mailgun from '../assets/icons/mailgun.svg';
import Postmark from '../assets/icons/postmark.svg';
import AliyunDm from '../assets/icons/aliyun-direct-mail.svg';
import Smtp from '../assets/icons/smtp.svg';
import Http from '../assets/icons/http.svg';

<DocCardList
  items={[
    {
      type: 'link',
      label: 'Logto Email Service',
      href: '/connectors/email-connectors/built-in-email-service',
      description: 'Logto 邮件服务的官方连接器。',
      customProps: {
        icon: <LogtoEmailService />,
      }
    },
  ]}
/>
```

### 流行的邮件提供商

使用 Logto 的分步指南连接你喜欢的邮件服务提供商 (ESP)。

这些选项允许你完全自定义电子邮件模板、发件人名称等，以最好地服务于你的品牌。

我们为以下邮件服务提供商提供开箱即用的支持：

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'AWS Direct Mail',
      href: '/integrations/aws-ses',
      description: 'AWS 直邮服务的 Logto 官方连接器。',
      customProps: {
        icon: <AwsDm />,
      }
    },
    {
      type: 'link',
      label: 'Mailgun',
      href: '/integrations/mailgun',
      description: 'Mailgun 邮件服务的 Logto 官方连接器。',
      customProps: {
        icon: <Mailgun />,
      }
    },
    {
      type: 'link',
      label: 'SendGrid Email',
      href: '/integrations/sendgrid-email',
      description: 'SendGrid 邮件服务的 Logto 官方连接器。',
      customProps: {
        icon: <SendGrid />,
      }
    },
    {
      type: 'link',
      label: 'Aliyun Direct Mail',
      href: '/integrations/aliyun-dm',
      description: '阿里云直邮服务的 Logto 官方连接器。',
      customProps: {
        icon: <AliyunDm />,
      }
    },
    {
      type: 'link',
      label: 'Postmark Mail',
      href: '/integrations/postmark',
      description: 'Postmark 邮件服务的 Logto 连接器。',
      customProps: {
        icon: <Postmark />,
      }
    },
  ]}
/>
```

### 自定义你的邮件连接器

如果上述解决方案都不能满足你的需求，你还可以选择使用简单邮件传输协议 (SMTP) 连接到你想要的邮件服务。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'SMTP',
      href: '/integrations/smtp',
      description: 'SMTP 的 Logto 官方连接器。',
      customProps: {
        icon: <Smtp />,
      }
    },
  ]}
/>
```

如果你已经有自己的邮件服务并且不适合使用 SMTP 连接，我们还提供“HTTP 邮件连接器”。

当需要发送电子邮件时，它会向配置的 `endpoint` 发送一个 API 调用，以完成依赖于电子邮件的认证流程。请注意，为了防止认证流程错误，配置的 endpoint 需要在接收到 WebHook 后返回 200 响应，以通知 Logto 它已收到发送电子邮件的通知。在这种情况下，你需要监控自己的邮件服务以确保成功发送。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'HTTP 邮件连接器',
      href: '/integrations/http-email',
      description: 'HTTP 邮件的 Logto 官方连接器。',
      customProps: {
        icon: <Http />,
      }
    },
  ]}
/>
```

如果我们的标准连接器不能满足你的特定要求，请不要犹豫 [联系我们](https://logto.productlane.com/roadmap)。对于 OSS 用户，如果需求紧急，你可以 [实现你的连接器 (OSS)](/logto-oss/develop-your-connector/implement-connectors#build-a-passwordless-connector)。我们始终欢迎 [贡献](/logto-oss/contribution)；你的努力可能会帮助其他有相同需求的社区成员。

## 配置步骤

按照以下步骤添加邮件连接器：

1. 导航到 <CloudLink to="/connectors/passwordless">控制台 > 连接器 > 邮件和短信连接器</CloudLink>。
2. 要添加新的邮件连接器，点击“设置”按钮并选择你想要的邮件提供商。
3. 查看 README 文档并逐步为你选择的提供商进行配置。
4. 点击“保存并完成”以完成。

## 更改邮件连接器

你可能会注意到只能添加一个邮件连接器。

当你已经有一个邮件连接器时，你只能选择“更改邮件连接器”。在控制台中执行此操作时，一旦保存就会立即生效，因此请确保在保存之前测试你的配置。

为了确保服务的稳定性，Cloud 用户可以为开发环境创建一个 [开发租户](/logto-cloud/tenant-settings#development)。在开发环境中测试配置后，将配置“迁移”到 [生产](/logto-cloud/tenant-settings#production)，然后保存设置。

## 启用邮件注册或登录

一旦你成功添加邮件连接器并完成配置，你可以根据业务需求启用依赖于电子邮件 + 验证码的登录和注册配置。

1. **导航到：**<CloudLink to="/sign-in-experience/sign-up-and-sign-in">控制台 > 登录体验 > 注册和登录</CloudLink>
2. [**设置注册方法**](/end-user-flows/sign-up-and-sign-in/sign-up)：选择“电子邮件地址”或“电子邮件地址或电话号码”作为注册标识符。注意：注册期间目前必须进行电子邮件验证。
3. [**设置登录方法**](/end-user-flows/sign-up-and-sign-in/sign-in)：选择的注册标识符会自动成为登录方法。点击“添加另一个”以获得额外的登录选项。
4. **保存更改并测试：**点击“保存更改”以实施新的登录体验。记得使用“[实时预览](/customization/live-preview)”来测试功能。

:::warning
由于我们的配置会立即生效，删除现有的邮件连接器可能会影响终端用户的正常登录和注册流程。

例如，如果登录标识符包括“电子邮件 + 验证码”组合，删除现有的邮件连接器将阻止用户通过电子邮件接收验证码，并导致登录流程出错。

在操作连接器时，请注意潜在的风险。
:::

## 常见问题

<details>
<summary>如何自定义电子邮件发件人名称？</summary>

我们仍在开发更多的连接器。如果你需要更多选项，请在 Discord 中告诉我们你的需求，并在 [GitHub](https://github.com/logto-io/logto/issues) 上提交功能请求。如果你需要进一步的帮助，你也可以 [通过电子邮件联系我们](mailto:contact@logto.io)。

对于贡献者，我们提供了一种易于扩展的连接器创建方法，允许你根据具体场景 [自定义自己的连接器](/logto-oss/develop-your-connector)。我们始终欢迎你向 Logto 提交拉取请求，以便社区中的其他人也能从你的工作中受益。

</details>

<details>
<summary>如何在 Logto 邮件连接器中限制电子邮件请求的 IP 地址？</summary>

一种解决方法是使用 Logto HTTP 邮件连接器。

在你的服务器上实现一个调用相关邮件服务的 API endpoint，并通过 Logto [HTTP 邮件连接器](/integrations/http-email) 触发此 API endpoint。通过这种方式，你将能够完全控制 API endpoint 的 IP 地址，并可以在邮件服务提供商的配置中将相应的 IP 地址添加到白名单中。

</details>
