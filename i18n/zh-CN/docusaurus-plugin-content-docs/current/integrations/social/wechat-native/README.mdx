---
slug: /integrations/wechat-native
sidebar_label: WeChat (Native)
sidebar_custom_props:
  description: WeChat æ˜¯ä¸€ä¸ªè·¨å¹³å°å³æ—¶é€šè®¯åº”ç”¨ã€‚
  logoFilename: 'wechat.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# è®¾ç½® WeChat ç¤¾äº¤ç™»å½• (Native)

Logto å®˜æ–¹è¿æ¥å™¨ç”¨äºåœ¨åŸç”Ÿåº”ç”¨ï¼ˆiOS å’Œ Androidï¼‰ä¸­è¿›è¡Œ WeChat ç¤¾äº¤ç™»å½•ã€‚

<GuideTip />

## å¼€å§‹ \{#get-started}

å¦‚æœä½ ä¸äº†è§£è¿æ¥å™¨çš„æ¦‚å¿µæˆ–ä¸çŸ¥é“å¦‚ä½•å°†æ­¤è¿æ¥å™¨æ·»åŠ åˆ°ä½ çš„ç™»å½•ä½“éªŒä¸­ï¼Œè¯·å‚é˜… [Logto æ•™ç¨‹](/connectors/social-connectors)ã€‚

åœ¨åŸç”Ÿåº”ç”¨ä¸­ï¼Œä½ ä¸èƒ½ä½¿ç”¨ç½‘é¡µä½œä¸º WeChat çš„ç™»å½•æ–¹å¼ï¼šéœ€è¦å¯¼èˆªåˆ° WeChat åº”ç”¨ï¼Œå¹¶ä¸”è¿˜éœ€è¦ä½¿ç”¨ä»–ä»¬çš„ SDKã€‚

æˆ‘ä»¬çŸ¥é“è¿™å¬èµ·æ¥æœ‰ç‚¹å“äººï¼Œä½†åˆ«æ‹…å¿ƒã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è½»æ¾å¤„ç†å®ƒã€‚

## åœ¨ WeChat å¼€æ”¾å¹³å°åˆ›å»ºä¸€ä¸ªç§»åŠ¨åº”ç”¨ \{#create-a-mobile-app-in-the-wechat-open-platform}

:::tip

å¦‚æœä½ å·²ç»å®Œæˆäº†ä¸€äº›éƒ¨åˆ†ï¼Œå¯ä»¥è·³è¿‡ã€‚

:::

### åˆ›å»ºä¸€ä¸ªè´¦æˆ· \{#create-an-account}

æ‰“å¼€ https://open.weixin.qq.com/ï¼Œç‚¹å‡»å³ä¸Šè§’çš„â€œæ³¨å†Œâ€æŒ‰é’®ï¼Œç„¶åå®Œæˆæ³¨å†Œè¿‡ç¨‹ã€‚

### åˆ›å»ºä¸€ä¸ªç§»åŠ¨åº”ç”¨ \{#create-a-mobile-app}

ä½¿ç”¨ä½ åˆšåˆ›å»ºçš„è´¦æˆ·ç™»å½•ã€‚åœ¨â€œç§»åŠ¨åº”ç”¨â€ (ç§»åŠ¨åº”ç”¨) æ ‡ç­¾ä¸­ï¼Œç‚¹å‡»ç»¿è‰²å¤§æŒ‰é’®â€œåˆ›å»ºç§»åŠ¨åº”ç”¨â€ (åˆ›å»ºç§»åŠ¨åº”ç”¨)ã€‚

<img src="/img/assets/app-tabs.png" alt="App tabs" />

è®©æˆ‘ä»¬åœ¨ç”³è¯·è¡¨ä¸­å¡«å†™æ‰€éœ€çš„ä¿¡æ¯ã€‚

<img src="/img/assets/create-mobile-app.png" alt="Create mobile app" />

#### åŸºæœ¬ä¿¡æ¯ \{#basic-info}

å¤§å¤šæ•°éƒ½å¾ˆç®€å•ï¼Œæˆ‘ä»¬è¿™é‡Œæœ‰å‡ ä¸ªæç¤ºï¼š

- å¦‚æœä½ åªæ˜¯æƒ³æµ‹è¯• WeChat ç™»å½•ä¸”åº”ç”¨ä¸åœ¨ App Store ä¸Šï¼Œåœ¨â€œåº”ç”¨æ˜¯å¦ä¸Šæ¶â€éƒ¨åˆ†é€‰æ‹©â€œå¦â€ä»¥è·³è¿‡â€œåº”ç”¨ä¸‹è½½é“¾æ¥â€ã€‚
- â€œåº”ç”¨æ“ä½œæµç¨‹å›¾â€çœ‹èµ·æ¥å¾ˆæ£˜æ‰‹ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œä½ éœ€è¦å‡†å¤‡ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾å’Œå‡ ä¸ªåº”ç”¨æˆªå›¾ä»¥æé«˜é€šè¿‡å®¡æ ¸çš„å¯èƒ½æ€§ã€‚

ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ç»§ç»­ã€‚

#### å¹³å°ä¿¡æ¯ \{#platform-info}

ä½ å¯ä»¥é…ç½® iOS å’Œ Android å¹³å°ä¸­çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªï¼Œä»¥å°† Logto ä¸ WeChat åŸç”Ÿç™»å½•é›†æˆã€‚

**iOS åº”ç”¨**

å‹¾é€‰â€œiOS åº”ç”¨â€ (iOS åº”ç”¨)ï¼Œç„¶åæ ¹æ®ä½ çš„åº”ç”¨å‹¾é€‰ç›®æ ‡è®¾å¤‡ç±»å‹ã€‚

<img src="/img/assets/platform.png" alt="App platform" />

å¦‚æœä½ é€‰æ‹©äº†â€œå¦â€ä½œä¸º App Store ä¸Šæ¶çŠ¶æ€ï¼Œä½ å¯ä»¥è·³è¿‡å¡«å†™â€œAppStore ä¸‹è½½åœ°å€â€ã€‚

å¡«å†™ _Bundle ID_ã€_æµ‹è¯•ç‰ˆ Bundle ID_ å’Œ _Universal Links_ï¼ˆå®é™…ä¸Šï¼Œåªéœ€è¦ä¸€ä¸ªé“¾æ¥ ğŸ˜‚ï¼‰ã€‚

:::note

_Bundle ID_ å’Œ _æµ‹è¯•ç‰ˆ Bundle ID_ å¯ä»¥æ˜¯ç›¸åŒçš„å€¼ã€‚

:::

:::tip

WeChat è¦æ±‚åŸç”Ÿç™»å½•ä½¿ç”¨é€šç”¨é“¾æ¥ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰è®¾ç½®æˆ–ä¸çŸ¥é“å®ƒï¼Œè¯·å‚è€ƒ [Apple å®˜æ–¹æ–‡æ¡£](https://developer.apple.com/ios/universal-links/)ã€‚

:::

**Android åº”ç”¨**

å‹¾é€‰â€œAndroid åº”ç”¨â€ (Android åº”ç”¨)ã€‚

<img src="/img/assets/platform-android-app.png" alt="Android app platform" />

å¡«å†™ _åº”ç”¨ç­¾å_ å’Œ _åº”ç”¨åŒ…å_ã€‚

:::note

ä½ éœ€è¦ç­¾ç½²ä½ çš„åº”ç”¨ä»¥è·å–ç­¾åã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [ç­¾ç½²ä½ çš„åº”ç”¨](https://developer.android.com/studio/publish/app-signing)ã€‚

:::

å®Œæˆç­¾ç½²åï¼Œä½ å¯ä»¥æ‰§è¡Œ `signingReport` ä»»åŠ¡ä»¥è·å–ç­¾åã€‚

```bash
./gradlew your-android-project:signingReport
```

ç›¸åº”æ„å»ºå˜ä½“æŠ¥å‘Šçš„ `MD5` å€¼å°†æ˜¯ _åº”ç”¨ç­¾å_ï¼Œä½†è¯·è®°ä½ä»å€¼ä¸­åˆ é™¤æ‰€æœ‰åˆ†å·å¹¶å°†å…¶å°å†™ã€‚

ä¾‹å¦‚ `1A:2B:3C:4D` -> `1a2b3c4d`ã€‚

#### ç­‰å¾…å®¡æ ¸ç»“æœ \{#waiting-for-the-review-result}

å®Œæˆå¹³å°ä¿¡æ¯åï¼Œç‚¹å‡»â€œæäº¤å®¡æ ¸â€ç»§ç»­ã€‚é€šå¸¸ï¼Œå®¡æ ¸é€Ÿåº¦å¾ˆå¿«ï¼Œé€šå¸¸åœ¨ 1-2 å¤©å†…ç»“æŸã€‚

æˆ‘ä»¬æ€€ç–‘æ¯æ¬¡æäº¤æ—¶å®¡æ ¸å‘˜æ˜¯éšæœºåˆ†é…çš„ï¼Œå› ä¸ºæ ‡å‡†æ˜¯æµ®åŠ¨çš„ã€‚ä½ å¯èƒ½ç¬¬ä¸€æ¬¡è¢«æ‹’ç»ï¼Œä½†ä¸è¦æ”¾å¼ƒï¼è¯´æ˜ä½ çš„ç°çŠ¶å¹¶è¯¢é—®å®¡æ ¸å‘˜å¦‚ä½•ä¿®æ”¹ã€‚

## åœ¨ä½ çš„åº”ç”¨ä¸­å¯ç”¨ WeChat åŸç”Ÿç™»å½• \{#enable-wechat-native-sign-in-in-your-app}

### iOS \{#ios}

æˆ‘ä»¬å‡è®¾ä½ å·²ç»åœ¨åº”ç”¨ä¸­é›†æˆäº† [Logto iOS SDK](/quick-starts/swift)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹æƒ…éå¸¸ç®€å•ï¼Œä½ ç”šè‡³ä¸éœ€è¦é˜…è¯» WeChat SDK æ–‡æ¡£ï¼š

**1. åœ¨ä½ çš„ Xcode é¡¹ç›®ä¸­é…ç½®é€šç”¨é“¾æ¥å’Œ URL æ–¹æ¡ˆ**

åœ¨ Xcode é¡¹ç›® -> Signing & Capabilities æ ‡ç­¾ä¸­ï¼Œæ·»åŠ â€œAssociated Domainsâ€åŠŸèƒ½å’Œä½ ä¹‹å‰é…ç½®çš„é€šç”¨é“¾æ¥ã€‚

<img src="/img/assets/universal-link.png" alt="Universal link" />

ç„¶åè¿›å…¥â€œInfoâ€æ ‡ç­¾ï¼Œæ·»åŠ ä¸€ä¸ª [è‡ªå®šä¹‰ URL æ–¹æ¡ˆ](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) å’Œ WeChat App IDã€‚

<img src="/img/assets/custom-url-scheme.png" alt="Custom URL scheme" />

æœ€åæ‰“å¼€ä½ çš„ `Info.plist`ï¼Œåœ¨ `LSApplicationQueriesSchemes` ä¸‹æ·»åŠ  `weixinULAPI` å’Œ `weixin`ã€‚

<img src="/img/assets/plist.png" alt="Plist" />

:::note

æˆ‘ä»¬çŸ¥é“è¿™äº›æ“ä½œä¸æ˜¯å¾ˆåˆç†ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬æ‰¾åˆ°çš„æœ€ä½å¯è¡Œè§£å†³æ–¹æ¡ˆã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [ç¥å¥‡çš„å®˜æ–¹æŒ‡å—](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html)ã€‚

:::

**2. å°† `LogtoSocialPluginWechat` æ·»åŠ åˆ°ä½ çš„ Xcode é¡¹ç›®**

æ·»åŠ æ¡†æ¶ï¼š

<img src="/img/assets/add-framework.png" alt="Add framework" />

å¹¶åœ¨ä½ çš„ Build Settings > Linking > Other Linker Flags ä¸­æ·»åŠ  `-ObjC`ï¼š

<img src="/img/assets/linker-flags.png" alt="Linker flags" />

:::note

è¯¥æ’ä»¶åŒ…å« WeChat Open SDK 1.9.2ã€‚å¯¼å…¥æ’ä»¶åï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ `import WechatOpenSDK`ã€‚

:::

**3. å°†æ’ä»¶æ·»åŠ åˆ°ä½ çš„ `LogtoClient` åˆå§‹åŒ–é€‰é¡¹ä¸­**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. æ­£ç¡®å¤„ç† `onOpenURL`**

:::note

å‡½æ•° `LogtoClient.handle(url:)` å°†å¤„ç†ä½ å¯ç”¨çš„æ‰€æœ‰åŸç”Ÿè¿æ¥å™¨ã€‚ä½ åªéœ€è°ƒç”¨ä¸€æ¬¡ã€‚

:::

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// æˆ– AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android \{#android}

æˆ‘ä»¬å‡è®¾ä½ å·²ç»åœ¨åº”ç”¨ä¸­é›†æˆäº† [Logto Android SDK](/quick-starts/android)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹æƒ…éå¸¸ç®€å•ï¼Œä½ ç”šè‡³ä¸éœ€è¦é˜…è¯» WeChat SDK æ–‡æ¡£ï¼š

**1. å°† `Wechat Open SDK` æ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­**

ç¡®ä¿ `mavenCentral()` ä»“åº“åœ¨ä½ çš„ Gradle é¡¹ç›®ä»“åº“ä¸­ï¼š

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

å°† Wechat Open SDK æ·»åŠ åˆ°ä½ çš„ä¾èµ–é¡¹ä¸­ï¼š

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // æˆ–
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. å°† `WXEntryActivity` å¼•å…¥åˆ°ä½ çš„é¡¹ç›®ä¸­**

åœ¨ä½ çš„åŒ…æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `wxapi` åŒ…ï¼Œå¹¶åœ¨ `wxapi` åŒ…ä¸­æ·»åŠ  `WXEntryActivity`ï¼ˆä»¥ `com.sample.app` ä¸ºä¾‹ï¼‰ï¼š

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

é¡¹ç›®ä¸­ `WXEntryActivity` çš„æœ€ç»ˆä½ç½®åº”å¦‚ä¸‹æ‰€ç¤ºï¼ˆä»¥ Kotlin ä¸ºä¾‹ï¼‰ï¼š

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. ä¿®æ”¹ `AndroidManifest.xml`**

åœ¨ä½ çš„ `AndroidManifest.xml` ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- è¦æ·»åŠ çš„è¡Œ -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```

## æµ‹è¯• WeChat åŸç”Ÿè¿æ¥å™¨ \{#test-wechat-native-connector}

å°±æ˜¯è¿™æ ·ã€‚åˆ«å¿˜äº†åœ¨ [ç™»å½•ä½“éªŒä¸­å¯ç”¨ç¤¾äº¤è¿æ¥å™¨](/connectors/social-connectors/#enable-social-sign-in)ã€‚

ä¸€æ—¦å¯ç”¨äº† WeChat åŸç”Ÿè¿æ¥å™¨ï¼Œä½ å¯ä»¥æ„å»ºå¹¶è¿è¡Œä½ çš„åº”ç”¨ä»¥æŸ¥çœ‹å…¶æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

:::caution

WeChat å¯¹äºæ²¡æœ‰å®‰è£… WeChat åº”ç”¨çš„è®¾å¤‡æ²¡æœ‰è®¡åˆ’ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼ŒLogto å°†åœ¨ç™»å½•æ—¶éšè—æ­¤è¿æ¥å™¨ï¼ˆè¿™æ˜¯ [å®˜æ–¹å¼€å‘æŒ‡å—](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/WeChat_Login/Development_Guide.html) æ¨èçš„æ–¹å¼ï¼‰ã€‚

:::
