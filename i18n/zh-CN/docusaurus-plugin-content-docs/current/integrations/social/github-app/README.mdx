---
slug: /integrations/github-app
sidebar_label: GitHub (GitHub App)
sidebar_custom_props:
  darkLogoFilename: 'github-dark.svg'
  description: GitHub 是一个面向软件开发和版本控制的在线社区。
tutorial_config_name: GitHub (GitHub App)
---

import GuideTip from '../../fragments/_guide-tip.mdx';

import Integration from './_integration.mdx';

# 设置 GitHub 社交登录（通过 GitHub App）

集成 GitHub App，可启用“使用 GitHub 登录”、账户绑定，并通过细粒度权限和刷新令牌 (Refresh token) 安全访问 GitHub API。

<GuideTip />

## GitHub App 与 OAuth App 的区别 \{#github-app-vs-oauth-app}

GitHub 提供两种用于认证 (Authentication) 和 API 访问的应用类型：**GitHub App** 和 **OAuth App**。以下对比可帮助你选择：

| 功能                          | GitHub App                                                                   | OAuth App                                 |
| ----------------------------- | ---------------------------------------------------------------------------- | ----------------------------------------- |
| **权限 (Permissions)**        | 细粒度权限——仅请求特定资源的访问权限                                         | 广泛权限——通常授予超出实际需求的访问权限  |
| **权限管理**                  | 仅在 GitHub 控制台配置；Logto 的 `Scope` 字段可为空                          | 通过 Logto 连接器中的权限 (Scopes) 配置   |
| **刷新令牌 (Refresh tokens)** | OAuth 流程中始终颁发                                                         | 不支持——令牌不会过期，除非被撤销          |
| **令牌过期**                  | 访问令牌 (Access token) 8 小时后过期；刷新令牌 (Refresh token) 有效期 6 个月 | 访问令牌 (Access token) 永不过期          |
| **用户控制**                  | 用户可选择应用可访问的仓库                                                   | 可访问用户有权限的所有仓库                |
| **速率限制**                  | 更高的速率限制，随安装数量扩展                                               | 速率限制较低（每用户每小时 5,000 次请求） |
| **安装方式**                  | 安装在账户 / 组织上，可细粒度控制仓库访问                                    | 由用户授权，权限范围较广                  |
| **Webhook**                   | 内置集中式 Webhook 支持                                                      | 需为每个仓库单独配置                      |
| **独立操作**                  | 可独立代表自身操作（服务器到服务器）                                         | 始终代表用户操作                          |

**适合使用 GitHub App 的场景：**

- 你需要对权限 (Permissions) 和仓库访问进行细粒度控制
- 你希望获得刷新令牌 (Refresh token)，以便长期安全访问 API
- 你需要更高的 API 速率限制
- 你希望执行与用户会话无关的自动化任务

**适合使用 OAuth App 的场景：**

- 仅需简单登录集成，对 API 访问要求极低
- 你需要不会过期的令牌（用于遗留集成）
- 你需要访问企业级资源（GitHub App 目前尚不支持企业级权限）

:::tip
GitHub 推荐在大多数场景下优先使用 GitHub App，因为其安全性更高且权限 (Permissions) 更细粒度。了解更多 [GitHub App 与 OAuth App 的区别](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/differences-between-github-apps-and-oauth-apps)。
:::

## 开始使用 \{#get-started}

GitHub App 连接器支持 OAuth 2.0 集成，让你的应用可以：

- 添加“使用 GitHub 登录”认证 (Authentication)
- 将用户账户与 GitHub 身份关联
- 从 GitHub 同步用户资料信息
- 通过 Logto Secret Vault 安全存储的令牌访问 GitHub API，实现自动化任务（如在你的应用中创建 GitHub issue、管理仓库等）
- 使用 **刷新令牌 (Refresh token)**（GitHub App 始终颁发）维持长期 API 访问，无需用户反复认证 (Authentication)

要设置这些认证 (Authentication) 功能，首先需在 Logto 创建 GitHub 连接器：

1. 前往 <CloudLink to="/connectors/social">Logto 控制台 > 连接器 > 社交连接器</CloudLink>。
2. 点击 **添加社交连接器**，选择 **GitHub App**，点击 **下一步**，并按照分步教程完成集成。

<Integration />

## 使用 GitHub 连接器 \{#utilize-the-github-connector}

创建并连接 GitHub 连接器后，你可以将其集成到终端用户流程中。根据你的需求选择相应方式：

### 启用“使用 GitHub 登录” \{#enable-sign-in-with-github}

1. 在 Logto 控制台，前往 <CloudLink to="/sign-in-experience/sign-up-and-sign-in">登录体验 > 注册与登录</CloudLink>。
2. 在 **社交登录** 区域添加 GitHub 连接器，让用户可通过 GitHub 认证 (Authentication)。

了解更多 [社交登录体验](/end-user-flows/sign-up-and-sign-in/social-sign-in)。

### 绑定或解绑 GitHub 账户 \{#link-or-unlink-a-github-account}

使用 Account API 在你的应用中构建自定义账户中心，让已登录用户绑定或解绑 GitHub 账户。[参见 Account API 教程](/end-user-flows/account-settings/by-account-api#link-a-new-social-connection)

:::tip
你可以仅为账户绑定和 API 访问启用 GitHub 连接器，无需启用社交登录。
:::

### 访问 GitHub API 并执行操作 \{#access-github-apis-and-perform-actions}

你的应用可从 Secret Vault 获取已存储的 GitHub 令牌，调用 GitHub API 并自动化后端任务（如创建 issue、管理仓库或自动化工作流）。参考相关指南，了解如何获取存储的令牌以访问 API。

由于 GitHub App 在 OAuth 流程中始终颁发刷新令牌 (Refresh token)，Logto 会同时存储访问令牌 (Access token) 和刷新令牌 (Refresh token)。访问令牌 (Access token) 8 小时后过期，但 Logto 会自动使用有效期 6 个月的刷新令牌 (Refresh token) 获取新访问令牌，确保 API 访问不中断。

## 管理用户的 GitHub 身份 \{#manage-user-s-github-identity}

用户绑定 GitHub 账户后，管理员可在 Logto 控制台管理该连接：

1. 前往 <CloudLink to="/users">Logto 控制台 > 用户管理</CloudLink> 并打开用户资料。
2. 在 **社交连接** 区域找到 GitHub 项，点击 **管理**。
3. 在此页面，管理员可管理用户的 GitHub 连接，查看所有已授权并同步的 GitHub 账户资料信息，以及访问令牌 (Access token) 和刷新令牌 (Refresh token) 状态。

:::note
与使用权限 (Scopes) 的 OAuth App 不同，GitHub App 使用在 GitHub 控制台配置的细粒度权限 (Permissions)。用户访问令牌 (Access token) 仅限于你的应用和用户双方都拥有的权限 (Permissions)。Logto 无法直接展示权限列表，但你的应用可根据 GitHub App 设置中配置的权限 (Permissions) 获得相应访问能力。
:::

## 参考资料 \{#reference}

<Url href="https://docs.github.com/en/apps/creating-github-apps/about-creating-github-apps/about-creating-github-apps">
  GitHub 开发者文档 - 关于 GitHub App
</Url>

<Url href="https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/registering-a-github-app">
  GitHub 开发者文档 - 注册 GitHub App
</Url>

<Url href="https://docs.github.com/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-a-user-access-token-for-a-github-app">
  GitHub 开发者文档 - 生成用户访问令牌 (Access token)
</Url>

<Url href="https://docs.github.com/en/apps/creating-github-apps/authenticating-with-a-github-app/refreshing-user-access-tokens">
  GitHub 开发者文档 - 刷新用户访问令牌 (Access token)
</Url>

<Url href="https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/differences-between-github-apps-and-oauth-apps">
  GitHub App 与 OAuth App 的区别
</Url>
