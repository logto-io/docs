## 在阿里云 DirectMail 控制台设置邮件服务 \{#set-up-an-email-service-in-aliyun-directmail-console}

### 创建阿里云账号 \{#create-an-aliyun-account}

前往 [阿里云](https://aliyun.com/)，如果你还没有账号，请注册一个阿里云账号。

### 开通并配置阿里云 Direct Mail \{#enable-and-configure-aliyun-direct-mail}

进入 [DM 服务控制台页面](https://www.aliyun.com/product/directmail) 并登录。点击页面左上角的“申请开通”按钮，开通 Direct Mail 服务并开始配置流程。

从 [DM 管理控制台页面](https://dm.console.aliyun.com/) 开始，你需要：

1. 在侧边栏进入“发信域名”，按照指引添加“新建域名”。
2. 分别自定义“发信地址”和“邮件标签”。

完成设置后，有两种不同的测试方式：

- 进入 [DirectMail 概览页面](https://dm.console.aliyun.com/)，在页面底部找到“操作引导”，点击“发送邮件”。你会看到各种不同的测试方法。
- 按照侧边栏“发送邮件” -> “邮件任务”的路径，创建一个测试任务。

## 编写连接器 JSON \{#compose-the-connector-json}

1. 在 [DM 管理控制台页面](https://dm.console.aliyun.com/) 右上角鼠标悬停在你的头像上，进入“AccessKey 管理”，点击“创建 AccessKey”。完成安全验证后，你会获得一对“AccessKey ID”和“AccessKey Secret”。请妥善保存。
2. 回到你刚刚访问过的“发信地址”或“邮件标签”标签页，你可以很容易找到 _发信地址_ 或 _邮件标签_。
3. 填写阿里云 DM 连接器设置：
   - 将第 1 步获得的 access key 对填写到 `accessKeyId` 和 `accessKeySecret` 字段中。
   - 将第 2 步找到的“发信地址”和“邮件标签”分别填写到 `accountName` 和 `fromAlias` 字段中。所有模板将共享这个签名名。（`fromAlias` 可以留空，它是可选项。）
   - 你可以为不同场景添加多个 DM 连接器模板。以下是添加单个模板的示例：
     - 填写 `subject` 字段，作为发送邮件的标题。
     - 用任意字符串内容填写 `content` 字段。不要忘记保留 `{{code}}` 占位符用于随机验证码。
     - 根据不同用例，将 `usageType` 字段填写为 `Register`、`SignIn`、`ForgotPassword` 或 `Generic`。(`usageType` 是 Logto 属性，用于识别正确的用例。) 为了支持完整的用户流程，要求包含 `Register`、`SignIn`、`ForgotPassword` 和 `Generic` 类型的模板。

### 测试阿里云 DM 连接器 \{#test-aliyun-dm-connector}

你可以输入一个邮箱地址并点击“发送”，在“保存并完成”之前测试设置是否可用。

就是这样。别忘了<MainSiteUrl href="/connectors/email-connectors/#enable-email-sign-up-or-sign-in">在登录体验中启用连接器</MainSiteUrl>。

### 配置类型 \{#config-types}

| 名称            | 类型          |
| --------------- | ------------- |
| accessKeyId     | string        |
| accessKeySecret | string        |
| accountName     | string        |
| fromAlias       | string (可选) |
| templates       | Template[]    |

| 模板属性  | 类型        | 枚举值                                               |
| --------- | ----------- | ---------------------------------------------------- |
| subject   | string      | N/A                                                  |
| content   | string      | N/A                                                  |
| usageType | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |
