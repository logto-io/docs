## 在阿里云短信控制台设置短信服务 \{#set-up-a-short-message-service-in-aliyun-sms-console}

### 创建阿里云账号 \{#create-an-aliyun-account}

前往 [阿里云官网](https://cn.aliyun.com/)，如果你还没有阿里云账号，请注册一个。

### 开通并配置阿里云短信服务 \{#enable-and-configure-aliyun-short-message-service}

1. 使用你的阿里云账号在 [阿里云官网](https://cn.aliyun.com/) 登录，并进入 [短信服务控制台页面](https://www.aliyun.com/product/sms)。
2. 在短信服务页面左上角点击“免费开通”按钮，开始配置流程。
3. 阅读并同意“短信服务开通条款”，点击“开通服务”继续下一步。
4. 现在你已进入 [短信服务控制台页面](https://dysms.console.aliyun.com/overview)，根据你的使用场景，点击侧边栏的“国内消息”或“国际 / 港澳台消息”按钮。
5. 按照指引添加签名和模板，并提供审核所需的材料或信息。
   - 在填写签名申请时，记得选择“适用场景”为“验证码”，在申请模板审核时，“模板类型”也选择“验证码”，因为我们将使用这些签名和模板发送验证码。目前，我们不支持发送除验证码类短信以外的短信内容。
   - 在模板内容中，使用 `{{code}}` 作为你希望放置数字验证码的位置占位符。
6. 提交短信签名和模板申请后，需要等待其生效。此时可以返回 [短信服务控制台页面](https://dysms.console.aliyun.com/overview) 发送测试短信。如果你的签名和模板已生效，可以直接测试；如果尚未生效，阿里云也提供测试模板。
   - 在发送测试短信前，你可能需要先充值少量金额。
   - 你也可能需要先绑定测试手机号才能发送测试短信。更多详情可在 [短信服务控制台页面](https://dysms.console.aliyun.com/overview) 侧边栏的“快速学习”标签页查看。

## 编写连接器 JSON \{#compose-the-connector-json}

1. 在 [短信服务控制台页面](https://dysms.console.aliyun.com/overview) 右上角鼠标悬停在你的头像上，进入“AccessKey 管理”，点击“创建 AccessKey”。完成安全验证后，你将获得一对“AccessKey ID”和“AccessKey Secret”，请妥善保存。
2. 进入你刚才访问的“国内消息”或“国际 / 港澳台消息”标签页，可以很容易找到“签名名称”和“模板 CODE”。
   - 如果你想使用仅限测试的签名和模板，请进入“快速学习”标签页，在“签名与模板（仅供测试）”下方可以找到它们。
3. 填写阿里云短信连接器设置：
   - 将你在第 1 步获得的 access key 对填写到 `accessKeyId` 和 `accessKeySecret` 字段中。
   - 将第 2 步提到的“签名名称”填写到 `signName` 字段中，所有模板将共用此签名名称。
   - 你可以为不同场景添加多个短信连接器模板。以下是添加单个模板的示例：
     - 将“模板 CODE”填写到 `templateCode` 字段中，这样你就可以控制短信内容。
     - 根据不同场景，将 `usageType` 字段填写为 `Register`、`SignIn`、`ForgotPassword` 或 `Generic`。（`usageType` 是 Logto 用于识别具体使用场景的属性。）为了支持完整的用户流程，建议配置 `Register`、`SignIn`、`ForgotPassword` 和 `Generic` 类型的模板。

### 测试阿里云短信连接器 \{#test-aliyun-sms-connector}

你可以输入手机号并点击“发送”，在“保存并完成”之前测试设置是否可用。

就是这样。别忘了<MainSiteUrl href="/connectors/sms-connectors/#enable-phone-number-sign-up-or-sign-in">在登录体验中启用连接器</MainSiteUrl>。

### 配置类型 \{#config-types}

| 名称            | 类型       |
| --------------- | ---------- |
| accessKeyId     | string     |
| accessKeySecret | string     |
| signName        | string     |
| templates       | Template[] |

| 模板属性     | 类型        | 枚举值                                               |
| ------------ | ----------- | ---------------------------------------------------- |
| templateCode | string      | N/A                                                  |
| usageType    | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |
