---
slug: /integrations/aliyun-sms
sidebar_label: Mensagem Curta Aliyun
sidebar_custom_props:
  description: Aliyun fornece serviços de computação em nuvem para negócios online.
  logoFilename: 'aliyun.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# Configurar verificação SMS com Aliyun Short Message Service

O conector oficial do Logto para o serviço de mensagem curta da Aliyun.

<GuideTip />

## Introdução \{#get-started}

Aliyun é um dos principais provedores de serviços em nuvem na Ásia, oferecendo diversos serviços em nuvem, incluindo SMS (serviço de mensagem curta). O Aliyun SMS Connector é um plugin fornecido pela equipe Logto para chamar o serviço SMS da Aliyun, com o qual os usuários finais do Logto podem se registrar e fazer login em sua conta Logto via código de verificação por SMS.

## Configurar um serviço de mensagem curta no Console SMS da Aliyun \{#set-up-a-short-message-service-in-aliyun-sms-console}

### Criar uma conta Aliyun \{#create-an-aliyun-account}

Acesse o [site da Aliyun](https://cn.aliyun.com/) e registre sua conta Aliyun caso ainda não tenha uma.

### Ativar e configurar o Aliyun Short Message Service \{#enable-and-configure-aliyun-short-message-service}

1. Faça login com sua conta Aliyun no [site da Aliyun](https://cn.aliyun.com/) e acesse a [página do console do serviço SMS](https://www.aliyun.com/product/sms).
2. Clique no botão "Abrir gratuitamente" (免费开通) no canto superior esquerdo da página do serviço SMS e inicie o processo de configuração.
3. Leia e concorde com o "Acordo de ativação do serviço SMS" (短信服务开通条款) e clique em "Assinar serviço" (开通服务) para prosseguir.
4. Agora você está na [página do console do serviço SMS](https://dysms.console.aliyun.com/overview), acesse o botão "China Continental" (国内消息) ou "Fora da China Continental" (国际/港澳台消息) na barra lateral conforme seu caso de uso.
5. Adicione assinatura e modelo seguindo as diretrizes e forneça os materiais ou informações necessários para análise.
   - Lembre-se de selecionar "Mensagem de Código de Verificação" (验证码) como "Cenário" (适用场景) ao preencher a solicitação de assinatura e também "Mensagem de Código de Verificação" (验证码) para "Tipo" (模板类型) ao solicitar a análise do modelo, pois usaremos essas assinaturas e modelos para enviar o código de verificação. Atualmente, não suportamos o envio de mensagens SMS que não sejam relacionadas a códigos de verificação.
   - Além disso, use `{{code}}` como placeholder onde deseja inserir o código de verificação digital no conteúdo do modelo.
6. Após enviar sua solicitação de assinatura e modelo SMS, aguarde até que entrem em vigor. Neste ponto, podemos voltar à [página do console do serviço SMS](https://dysms.console.aliyun.com/overview) e enviar um SMS de teste. Se suas assinaturas e modelos estiverem prontos para uso, você pode testá-los diretamente; caso ainda não estejam ativos, a Aliyun também fornece modelos de teste.
   - Pode ser necessário recarregar um pequeno valor antes de enviar mensagens de teste.
   - Também pode ser solicitado que você vincule um número de telefone de teste antes de enviar mensagens de teste. Para mais detalhes, acesse a aba "Aprendizado Rápido" (快速学习) na barra lateral da [página do console do serviço SMS](https://dysms.console.aliyun.com/overview).

## Compor o JSON do conector \{#compose-the-connector-json}

1. Na [página do console do serviço SMS](https://dysms.console.aliyun.com/overview), passe o mouse sobre seu avatar no canto superior direito e acesse "Gerenciamento de AccessKey" (AccessKey 管理), e clique em "Criar AccessKey" (创建 AccessKey). Você receberá um par "AccessKey ID" e "AccessKey Secret" após concluir a verificação de segurança. Guarde-os adequadamente.
2. Vá para a aba "China Continental" (国内消息) ou "Fora da China Continental" (国际/港澳台消息) que você acabou de visitar, onde poderá encontrar facilmente "Assinatura" (签名名称) e "Código do Modelo" (模板 CODE).
   - Se quiser usar a assinatura e o modelo apenas para teste, acesse a aba "Aprendizado Rápido" (快速学习), onde encontrará abaixo de "Assinatura & Modelos (Apenas para Teste)".
3. Preencha as configurações do Aliyun SMS Connector:
   - Preencha os campos `accessKeyId` e `accessKeySecret` com o par de chaves de acesso obtido no passo 1.
   - Preencha o campo `signName` com a "Assinatura" (签名名称) mencionada no passo 2. Todos os modelos compartilharão este nome de assinatura.
   - Você pode adicionar vários modelos de conector SMS para diferentes casos. Aqui está um exemplo de adição de um único modelo:
     - Preencha o campo `templateCode`, que é como você pode controlar o contexto do SMS, com o "Código do Modelo" (模板 CODE) do passo 2.
     - Preencha o campo `usageType` com `Register`, `SignIn`, `ForgotPassword` ou `Generic` para diferentes casos de uso. (`usageType` é uma propriedade do Logto para identificar o caso de uso apropriado.) Para habilitar todos os fluxos de usuário, são necessários modelos com usageType `Register`, `SignIn`, `ForgotPassword` e `Generic`.
4. Configurar "Verificação Estrita do Código de Região do Telefone":
   - Ative se precisar enviar SMS para números de telefone do exterior (regiões fora da China continental, como EUA, HK, etc.). Quando ativado, o conector assume que todos os números de telefone incluem códigos de região válidos (por exemplo, +1, +852) para determinar se pertencem à China continental.
   - **Atenção**: Se seus usuários existentes possuem números de telefone sem código de região, ativar isso pode afetar o processo de login deles. Ative apenas se necessário para envio de SMS internacional.

### Testar o conector Aliyun SMS \{#test-aliyun-sms-connector}

Você pode digitar um número de telefone e clicar em "Enviar" para verificar se as configurações funcionam antes de "Salvar e Concluir".

É isso. Não se esqueça de <MainSiteUrl href="/connectors/sms-connectors/#enable-phone-number-sign-up-or-sign-in">Ativar o conector na experiência de login</MainSiteUrl>.

### Tipos de configuração \{#config-types}

| Nome            | Tipo       |
| --------------- | ---------- |
| accessKeyId     | string     |
| accessKeySecret | string     |
| signName        | string     |
| templates       | Template[] |

| Propriedades do Template | Tipo        | Valores enum                                            |
| ------------------------ | ----------- | ------------------------------------------------------- |
| templateCode             | string      | N/A                                                     |
| usageType                | enum string | 'Register' \| 'SignIn' \| 'ForgotPassword' \| 'Generic' |

## Referências \{#references}

<Url href="https://dysms.console.aliyun.com/quickstart">Aliyun SMS - Introdução Rápida</Url>
