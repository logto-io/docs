Escopos (Scopes) definem as permissões que seu aplicativo solicita dos usuários e controlam quais dados seu aplicativo pode acessar das contas Microsoft Entra ID deles. Solicitar permissões do Microsoft Graph requer configuração em ambos os lados:

**No centro de administração do Microsoft Entra:**

1. Navegue até **Microsoft Entra ID > Registros de aplicativos (App registrations)** e selecione seu aplicativo.
2. Vá para **Permissões de API (API permissions) > Adicionar uma permissão (Add a permission) > Microsoft Graph > Permissões delegadas (Delegated permissions)**.
3. Selecione apenas as permissões que seu aplicativo requer:
   - Permissões OpenID:
     - `openid` (Obrigatório) - Fazer login dos usuários
     - `profile` (Obrigatório) - Visualizar perfil básico dos usuários
     - `email` (Obrigatório) - Visualizar endereço de email dos usuários
     - `offline_access` (Opcional) - Necessário apenas se você ativar [Armazenar tokens para acesso persistente à API](#step-4-store-tokens-to-access-microsoft-apis-optional) no conector Logto e precisar obter tokens de atualização para acesso prolongado às APIs do Microsoft Graph.
   - Acesso à API (Opcional): Adicione quaisquer permissões adicionais necessárias para seu aplicativo. Permissões comuns do Microsoft Graph incluem `Mail.Read`, `Calendars.Read`, `Files.Read`, etc. Navegue pela [referência de permissões do Microsoft Graph](https://docs.microsoft.com/en-us/graph/permissions-reference) para encontrar permissões disponíveis.
4. Clique em **Adicionar permissões (Add permissions)** para confirmar a seleção.
5. Se seu aplicativo exigir consentimento de administrador para certas permissões, clique em **Conceder consentimento de administrador para [Sua Organização] (Grant admin consent for [Your Organization])**.

<center>
  <img
    src="/img/assets/entra_id_oidc_add_api_permissions.webp"
    alt="Adicionar permissões de API da Microsoft"
  />
</center>

**No conector Logto Microsoft Entra ID:**

1. O Logto inclui automaticamente os escopos `openid`, `profile` e `email` para recuperar informações básicas de identidade do usuário. Você pode deixar o campo `Scopes` em branco se precisar apenas das informações básicas do usuário.
2. Adicione `offline_access` ao campo `Scopes` se planeja armazenar tokens para acesso persistente à API. Esse escopo habilita tokens de atualização para acesso prolongado à API.
3. Adicione escopos adicionais (separados por espaços) no campo `Scopes` para solicitar mais dados do Microsoft Graph. Use nomes de escopos padrão, por exemplo: `User.Read Mail.Read Calendars.Read`

:::tip

Se seu aplicativo solicitar esses escopos para acessar a API do Microsoft Graph e realizar ações, certifique-se de ativar **Armazenar tokens para acesso persistente à API** no conector Logto Microsoft Entra ID. Veja a próxima seção para detalhes.

:::
