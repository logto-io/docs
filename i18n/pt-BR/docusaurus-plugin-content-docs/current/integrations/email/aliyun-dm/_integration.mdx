## Configurar um serviço de email no Console DirectMail da Aliyun \{#set-up-an-email-service-in-aliyun-directmail-console}

### Criar uma conta Aliyun \{#create-an-aliyun-account}

Acesse o [Aliyun](https://aliyun.com/) e crie sua conta Aliyun caso ainda não tenha uma.

### Ativar e configurar o Aliyun Direct Mail \{#enable-and-configure-aliyun-direct-mail}

Vá para a [página do console do serviço DM](https://www.aliyun.com/product/directmail) e faça login. Ative o serviço Direct Mail clicando no botão "Apply to enable" (申请开通) no canto superior esquerdo da página e inicie o processo de configuração.

A partir da [página do console de administração do DM](https://dm.console.aliyun.com/), você deve:

1. Acessar "Email Domains" (发信域名) na barra lateral e adicionar um "New Domain" (新建域名) seguindo as instruções.
2. Personalizar "Sender Addresses" (发信地址) e "Email Tags" (邮件标签) respectivamente.

Após concluir a configuração, existem duas maneiras diferentes de testar:

- Acesse a [página de visão geral do DirectMail](https://dm.console.aliyun.com/), encontre "Operation Guide" (操作引导) na parte inferior da página e clique em "Send Emails" (发送邮件). Você encontrará todos os diferentes tipos de métodos de teste.
- Siga o caminho "Send Emails" (发送邮件) -> "Email Tasks" (发送邮件) na barra lateral para criar uma tarefa de teste.

## Compor o JSON do conector \{#compose-the-connector-json}

1. A partir da [página do console de administração do DM](https://dm.console.aliyun.com/), passe o mouse sobre seu avatar no canto superior direito e vá para "AccessKey Management" (AccessKey 管理), e clique em "Create AccessKey" (创建 AccessKey). Você receberá um par "AccessKey ID" e "AccessKey Secret" após concluir a verificação de segurança. Por favor, mantenha-os em segurança.
2. Vá para a aba "Sender Addresses" (发信地址) ou "Email Tags" (邮件标签) que você acabou de visitar na [página do console de administração do DM](https://dm.console.aliyun.com/), você pode encontrar facilmente o _Sender Address_ ou _Email Tag_.
3. Preencha as configurações do Aliyun DM Connector:
   - Preencha os campos `accessKeyId` e `accessKeySecret` com o par de chaves de acesso obtido no passo 1.
   - Preencha os campos `accountName` e `fromAlias` com o "Sender Address" e "Email Tag" encontrados no passo 2. Todos os templates compartilharão esse nome de assinatura. (Você pode deixar `fromAlias` em branco, pois é OPCIONAL.)
   - Você pode adicionar vários templates de conector DM para diferentes casos. Aqui está um exemplo de adição de um único template:
     - Preencha o campo `subject`, que será o título do email enviado.
     - Preencha o campo `content` com qualquer conteúdo do tipo string. Não se esqueça de deixar o placeholder `{{code}}` para o código de verificação aleatório.
     - Preencha o campo `usageType` com `Register`, `SignIn`, `ForgotPassword` ou `Generic` para diferentes casos de uso. (`usageType` é uma propriedade do Logto para identificar o caso de uso apropriado.) Para habilitar todos os fluxos de usuário, são necessários templates com usageType `Register`, `SignIn`, `ForgotPassword` e `Generic`.

### Testar o conector Aliyun DM \{#test-aliyun-dm-connector}

Você pode digitar um endereço de email e clicar em "Send" para verificar se as configurações funcionam antes de clicar em "Save and Done".

É isso. Não se esqueça de <MainSiteUrl href="/connectors/email-connectors/#enable-email-sign-up-or-sign-in">Ativar o conector na experiência de login</MainSiteUrl>.

### Tipos de configuração \{#config-types}

| Nome            | Tipo              |
| --------------- | ----------------- |
| accessKeyId     | string            |
| accessKeySecret | string            |
| accountName     | string            |
| fromAlias       | string (OPCIONAL) |
| templates       | Template[]        |

| Propriedades do Template | Tipo        | Valores enum                                         |
| ------------------------ | ----------- | ---------------------------------------------------- |
| subject                  | string      | N/A                                                  |
| content                  | string      | N/A                                                  |
| usageType                | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |
