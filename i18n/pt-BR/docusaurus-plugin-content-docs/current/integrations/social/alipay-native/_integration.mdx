## Registrar conta de desenvolvedor Alipay \{#register-alipay-developer-account}

[Registre uma conta de desenvolvedor Alipay](https://certifyweb.alipay.com/certify/reg/guide#/) se você ainda não tiver uma.

## Criar e configurar aplicativo Alipay \{#create-and-configure-alipay-app}

1. Faça login no [console do Alipay](https://open.alipay.com/) com a conta que você acabou de registrar.
2. Vá para a guia "Web & Mobile Apps" (网页&移动应用) no painel "My Application" (我的应用).
3. Clique no botão "Create an App" (立即创建) para começar a configurar seu aplicativo.
4. Nomeie seu aplicativo em "Application Name" (应用名称) seguindo as convenções de nomenclatura e faça upload do seu "Application Icon" (应用图标), certifique-se de escolher "mobile application" (移动应用) como "App type" (应用类型). Para construir um App iOS, é necessário um "Bundle ID" exclusivo. Além disso, "application signature" (应用签名) e "application package name" (应用包名) são necessários para apps Android.
5. Após terminar de criar o aplicativo, vá para a página Overview, onde você deve clicar em "add ability" (添加能力) para adicionar "Third-party application authorization" (第三方应用授权), "Get member information" (获取会员信息) e "App Alipay login" (App 支付宝登录) antes de habilitar o login Alipay.
6. Acesse o [Alipay Customer Center](https://b.alipay.com/index2.htm) e faça login com a conta de desenvolvedor Alipay. Clique em "Account Center" (账号中心) na barra superior e vá para "APPID binding" (APPID 绑定), cuja entrada pode ser encontrada na parte inferior da barra lateral. "Add binding" (添加绑定) digitando o APPID do aplicativo móvel que você acabou de criar no passo 4.
7. Clique no botão "Sign" de "App Alipay login" e conclua o processo de assinatura seguindo o guia. Após concluir esta etapa, você deverá ver as habilidades que acabou de adicionar no passo 5 funcionando.
8. Volte para a página do console da plataforma aberta Alipay, e você encontrará "Interface signing method" (接口加签方式（密钥/证书）) na seção "development information" (开发信息). Clique no botão "set up" (设置), e você estará em uma página para configurar o método de assinatura. "Public Key" (公钥) é o modo de assinatura preferido, e preencha o conteúdo do arquivo de chave pública que você gerou na caixa de texto.
9. Configure o "Authorization Redirect URI" (授权回调地址) clicando no botão "set up" (设置) na parte inferior da página do console Alipay. `${your_logto_origin}/callback/${connector_id}` é o URI de redirecionamento padrão usado no Logto core. O `connector_id` pode ser encontrado na barra superior da página de detalhes do conector no Logto Admin Console.
10. Após concluir todas essas etapas, volte para o canto superior direito da página do console Alipay e clique em "Submit for review" (提交审核). Uma vez que a revisão seja aprovada, você estará pronto para um fluxo de login Alipay suave.

:::note

Você pode usar _openssl_ para gerar pares de chaves em sua máquina local executando o seguinte trecho de código no terminal.

```bash
openssl genrsa -out private.pem 2048
openssl rsa -in private.pem -outform PEM -pubout -out public.pem
```

Ao preencher a chave pública no site de configuração do aplicativo Alipay, você precisa remover o cabeçalho e o rodapé do `public.pem`, excluir todos os caracteres de nova linha e colar o restante do conteúdo na caixa de texto para "public key".
:::

## Configurar as definições do conector Logto Alipay Native \{#set-up-the-logto-alipay-native-connector-settings}

1. No [workspace do console Alipay](https://open.alipay.com/dev/workspace), vá para o painel "My application" (我的应用) e clique na guia "Web & Mobile Apps" (网页&移动应用), onde você pode encontrar o APPID de todos os aplicativos.
2. No passo 7 da parte anterior, você já gerou um par de chaves incluindo uma chave privada e uma chave pública.
3. Preencha as configurações do conector Logto:
   - Preencha o campo `appId` com o APPID obtido no passo 1.
   - Preencha o campo `privateKey` com o conteúdo do arquivo de chave privada mencionado no passo 2. Por favor, CERTIFIQUE-SE de usar '\n' para substituir todos os caracteres de nova linha. Não é necessário remover o cabeçalho e o rodapé do arquivo de chave privada.
   - Preencha o campo `signType` com 'RSA2' devido ao modo de assinatura `Public key` que escolhemos no passo 7 de "Criar e configurar aplicativos Alipay".

### Tipos de configuração \{#config-types}

| Nome       | Tipo        | Valores enum   |
| ---------- | ----------- | -------------- |
| appId      | string      | N/A            |
| privateKey | string      | N/A            |
| signType   | enum string | 'RSA' / 'RSA2' |

## Habilitar login nativo Alipay no seu app \{#enable-alipay-native-sign-in-in-your-app}

### iOS \{#ios}

Assumimos que você já integrou o <MainSiteUrl href="/quick-starts/swift">Logto iOS SDK</MainSiteUrl> no seu app. Nesse caso, tudo é bem simples, e você nem precisa ler a documentação do SDK Alipay:

**1. Adicione `LogtoSocialPluginAlipay` ao seu projeto Xcode**

Adicione o framework:

<img src="/img/assets/add-framework.png" alt="Add framework" />

:::note

O plugin inclui o "minimalist SDK" (极简版 SDK) do Alipay. Você pode usar diretamente `import AFServiceSDK` após importar o plugin.

:::

**2. Adicione o plugin às opções de inicialização do seu `LogtoClient`**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginAlipay(callbackScheme: "your-scheme")]
)
```

Onde `callbackScheme` é um dos [custom URL Schemes](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) que pode navegar até seu app.

### Android \{#android}

Assumimos que você já integrou o <MainSiteUrl href="/quick-starts/android">Logto Android SDK</MainSiteUrl> no seu app. Nesse caso, tudo é bem simples, e você nem precisa ler a documentação do SDK Alipay:

**1. Baixe o "minimalist SDK" do Alipay e adicione ao seu projeto**

Baixe o "minimalist SDK" (极简版 SDK) do Alipay em [Logto 3rd-party Social SDKs](https://github.com/logto-io/social-sdks/blob/master/alipay/android/alipaySdk-15.7.9-20200727142846.aar) para a pasta `app/libs` do seu projeto:

```bash
project-path/app/libs/alipaySdk-15.7.9-20200727142846.aar
```

**2. Adicione o "minimalist SDK" do Alipay como dependência**

Abra seu arquivo `build.gradle`:

```bash
project-path/app/build.gradle
```

Adicione a dependência:

```kotlin
dependencies {
  // ...
  implementation(files("./libs/alipaySdk-15.7.9-20200727142846.aar"))  // kotlin-script
  // ou
  implementation files('./libs/alipaySdk-15.7.9-20200727142846.aar')  // groovy-script
}
```
