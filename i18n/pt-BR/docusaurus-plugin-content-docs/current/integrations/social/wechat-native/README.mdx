---
slug: /integrations/wechat-native
sidebar_label: WeChat (Native)
sidebar_custom_props:
  description: WeChat √© um aplicativo de mensagens instant√¢neas multiplataforma.
  logoFilename: 'wechat.svg'
---

import addFrameworkImage from '@site/docs/integrations/social/wechat-native/assets/add-framework.png';
import appTabsImage from '@site/docs/integrations/social/wechat-native/assets/app-tabs.png';
import createMobileAppImage from '@site/docs/integrations/social/wechat-native/assets/create-mobile-app.png';
import customUrlSchemeImage from '@site/docs/integrations/social/wechat-native/assets/custom-url-scheme.png';
import linkerFlagsImage from '@site/docs/integrations/social/wechat-native/assets/linker-flags.png';
import platformAndroidAppImage from '@site/docs/integrations/social/wechat-native/assets/platform-android-app.png';
import platformImage from '@site/docs/integrations/social/wechat-native/assets/platform.png';
import plistImage from '@site/docs/integrations/social/wechat-native/assets/plist.png';
import universalLinkImage from '@site/docs/integrations/social/wechat-native/assets/universal-link.png';

import GuideTip from '../../fragments/_guide-tip.mdx';

# Configurar login social com WeChat (Native)

O conector oficial do Logto para login social do WeChat em aplicativos nativos (iOS e Android).

<GuideTip />

## Introdu√ß√£o \{#get-started}

Se voc√™ n√£o conhece o conceito do conector ou n√£o sabe como adicionar este conector √† sua experi√™ncia de login, consulte o [tutorial do Logto](/connectors/social-connectors).

Em aplicativos nativos, voc√™ n√£o pode usar a web como m√©todo de login do WeChat: √© necess√°rio navegar para o aplicativo WeChat, e tamb√©m √© necess√°rio usar o SDK deles.

Sabemos que parece assustador, mas n√£o se preocupe. Vamos lidar com isso facilmente neste tutorial.

## Criar um aplicativo m√≥vel na WeChat Open Platform \{#create-a-mobile-app-in-the-wechat-open-platform}

:::tip

Voc√™ pode pular algumas se√ß√µes se j√° tiver terminado.

:::

### Criar uma conta \{#create-an-account}

Abra https://open.weixin.qq.com/, clique no bot√£o "Sign Up" no canto superior direito e conclua o processo de inscri√ß√£o.

### Criar um aplicativo m√≥vel \{#create-a-mobile-app}

Fa√ßa login com a conta que voc√™ acabou de criar. Na aba "Mobile Application" (ÁßªÂä®Â∫îÁî®), clique no grande bot√£o verde "Create a mobile app" (ÂàõÂª∫ÁßªÂä®Â∫îÁî®).

<img src={appTabsImage} alt="App tabs" />

Vamos preencher as informa√ß√µes necess√°rias no formul√°rio de inscri√ß√£o.

<img src={createMobileAppImage} alt="Create mobile app" />

#### Informa√ß√µes b√°sicas \{#basic-info}

A maioria delas √© bastante direta, e temos v√°rias dicas aqui:

- Se voc√™ s√≥ quer testar o login do WeChat e o aplicativo n√£o est√° na App Store, na se√ß√£o "App is available", escolha "No" para pular o "App download link".
- O "App operation flow chart" parece complicado. Pela nossa experi√™ncia, voc√™ precisa preparar um fluxograma simples e v√°rias capturas de tela do aplicativo para aumentar a possibilidade de aprova√ß√£o na revis√£o.

Clique em "Next step" para continuar.

#### Informa√ß√µes da plataforma \{#platform-info}

Voc√™ pode configurar uma ou ambas as plataformas iOS e Android para integrar o Logto com o login nativo do WeChat.

**Aplicativo iOS**

Marque "iOS app" (iOS Â∫îÁî®), depois marque o tipo de dispositivo alvo do seu aplicativo conforme necess√°rio.

<img src={platformImage} alt="App platform" />

Se voc√™ escolheu "No" para a disponibilidade na App Store, pode pular o preenchimento do "AppStore download address" aqui.

Preencha _Bundle ID_, _Test version Bundle ID_ e _Universal Links_ (na verdade, apenas um link √© necess√°rio üòÇ).

:::note

_Bundle ID_ e _Test version Bundle ID_ podem ter o mesmo valor.

:::

:::tip

O WeChat requer link universal para login nativo. Se voc√™ ainda n√£o configurou ou n√£o sabe o que √©, consulte o [documento oficial da Apple](https://developer.apple.com/ios/universal-links/).

:::

**Aplicativo Android**

Marque "Android app" (Android Â∫îÁî®).

<img src={platformAndroidAppImage} alt="Android app platform" />

Preencha _Application Signing Signature_ (Â∫îÁî®Á≠æÂêç) e _Application Package Name_ (Â∫îÁî®ÂåÖÂêç).

:::note

Voc√™ precisa assinar seu aplicativo para obter uma assinatura. Consulte [Assinar seu aplicativo](https://developer.android.com/studio/publish/app-signing) para mais informa√ß√µes.

:::

Ap√≥s concluir a assinatura, voc√™ pode executar a tarefa `signingReport` para obter a assinatura.

```bash
./gradlew your-android-project:signingReport
```

O valor `MD5` do relat√≥rio da variante de build correspondente ser√° a _Application Signing Signature_ (Â∫îÁî®Á≠æÂêç), mas lembre-se de remover todos os pontos e v√≠rgulas do valor e coloc√°-lo em min√∫sculas.

Ex.: `1A:2B:3C:4D` -> `1a2b3c4d`.

#### Aguardando o resultado da revis√£o \{#waiting-for-the-review-result}

Ap√≥s completar as informa√ß√µes da plataforma, clique em "Submit Review" para continuar. Normalmente, a revis√£o √© r√°pida, terminando em 1-2 dias.

Suspeitamos que o revisor seja alocado aleatoriamente em cada submiss√£o, j√° que o padr√£o √© flutuante. Voc√™ pode ser rejeitado na primeira vez, mas n√£o desista! Declare sua situa√ß√£o atual e pergunte ao revisor como modific√°-la.

## Habilitar login nativo do WeChat no seu aplicativo \{#enable-wechat-native-sign-in-in-your-app}

### iOS \{#ios}

Assumimos que voc√™ integrou o [Logto iOS SDK](/quick-starts/swift) no seu aplicativo. Nesse caso, as coisas s√£o bem simples, e voc√™ nem precisa ler o documento do SDK do WeChat:

**1. Configure o link universal e o esquema de URL no seu projeto Xcode**

No projeto Xcode -> aba Signing & Capabilities, adicione a capacidade "Associated Domains" e o link universal que voc√™ configurou antes.

<img src={universalLinkImage} alt="Universal link" />

Depois v√° para a aba "Info", adicione um [esquema de URL personalizado](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) com o WeChat App ID.

<img src={customUrlSchemeImage} alt="Custom URL scheme" />

Finalmente, abra seu `Info.plist`, adicione `weixinULAPI` e `weixin` em `LSApplicationQueriesSchemes`.

<img src={plistImage} alt="Plist" />

:::note

Sabemos que essas a√ß√µes n√£o s√£o muito razo√°veis, mas esta √© a solu√ß√£o m√≠nima vi√°vel que encontramos. Veja o [guia oficial m√°gico](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html) para mais informa√ß√µes.

:::

**2. Adicione `LogtoSocialPluginWechat` ao seu projeto Xcode**

Adicione o framework:

<img src={addFrameworkImage} alt="Add framework" />

E adicione `-ObjC` √†s suas Build Settings > Linking > Other Linker Flags:

<img src={linkerFlagsImage} alt="Linker flags" />

:::note

O plugin inclui o WeChat Open SDK 1.9.2. Voc√™ pode usar diretamente `import WechatOpenSDK` uma vez importado o plugin.

:::

**3. Adicione o plugin √†s op√ß√µes de inicializa√ß√£o do seu `LogtoClient`**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. Lide corretamente com `onOpenURL`**

:::note

A fun√ß√£o `LogtoClient.handle(url:)` lidar√° com todos os conectores nativos que voc√™ habilitou. Voc√™ s√≥ precisa cham√°-la uma vez.

:::

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// ou AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android \{#android}

Assumimos que voc√™ integrou o [Logto Android SDK](/quick-starts/android) no seu aplicativo. Nesse caso, as coisas s√£o bem simples, e voc√™ nem precisa ler o documento do SDK do WeChat:

**1. Adicione `Wechat Open SDK` ao seu projeto**

Certifique-se de que o reposit√≥rio `mavenCentral()` est√° nos reposit√≥rios do seu projeto Gradle:

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

Adicione o Wechat Open SDK √†s suas depend√™ncias:

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // ou
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. Introduza `WXEntryActivity` ao seu projeto**

Crie um pacote `wxapi` sob o root do seu pacote e adicione o `WXEntryActivity` no pacote `wxapi` (Tome `com.sample.app` como exemplo):

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

A posi√ß√£o final do `WXEntryActivity` no projeto deve ser assim (Tome Kotlin como exemplo):

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. Modifique o `AndroidManifest.xml`**

Adicione a seguinte linha ao seu `AndroidManifest.xml`:

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- linha a ser adicionada -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```

## Testar conector nativo do WeChat \{#test-wechat-native-connector}

√â isso. N√£o se esque√ßa de [Habilitar conector social na experi√™ncia de login](/connectors/social-connectors/#enable-social-sign-in).

Uma vez que o conector nativo do WeChat esteja habilitado, voc√™ pode construir e executar seu aplicativo para ver se funciona.

:::caution

O WeChat n√£o tem um plano para aqueles dispositivos sem o aplicativo WeChat instalado. O Logto ocultar√° este conector durante o login, se for o caso (o que √© a maneira recomendada pelo [guia de desenvolvimento oficial](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/WeChat_Login/Development_Guide.html)).

:::
