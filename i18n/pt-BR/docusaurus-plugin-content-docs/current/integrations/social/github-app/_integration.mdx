## Etapa 1: Crie um GitHub App \{#step-1-create-a-github-app}

Antes de usar o GitHub como um provedor de autenticação, você deve criar um GitHub App no GitHub para obter credenciais OAuth 2.0.

1. Acesse o [GitHub](https://github.com/) e faça login com sua conta, ou crie uma nova conta se necessário.
2. Navegue até [Settings > Developer settings > GitHub Apps](https://github.com/settings/apps).
3. Clique em **New GitHub App** para registrar um novo aplicativo:
   - **GitHub App name**: Insira um nome exclusivo para seu aplicativo. O nome não pode ter mais de 34 caracteres e deve ser único em todo o GitHub.
   - **Homepage URL**: Insira a URL da página inicial do seu aplicativo.
   - **Callback URL**: Copie o **Callback URI** do seu conector GitHub do Logto e cole aqui. Você pode adicionar várias URLs de callback se necessário. Após os usuários fazerem login com o GitHub, eles serão redirecionados para cá com um código de autorização que o Logto usa para concluir a autenticação.
   - **Expire user authorization tokens**: Mantenha esta opção **marcada** (recomendado). Isso habilita a expiração de tokens e tokens de atualização para maior segurança.
   - **Request user authorization (OAuth) during installation**: Opcionalmente marque esta opção para solicitar que os usuários autorizem seu aplicativo durante a instalação.
   - **Webhook**: Desmarque **Active** se você não precisar de eventos de webhook. Para casos de uso apenas de autenticação, webhooks normalmente não são necessários.
4. Em **Permissions**, configure as permissões que seu aplicativo precisa (veja a Etapa 2 abaixo para detalhes).
5. Em **Where can this GitHub App be installed?**, selecione **Any account** se quiser que usuários de qualquer conta do GitHub possam usar seu aplicativo para autenticação.
6. Clique em **Create GitHub App** para criar o GitHub App.

:::note
Diferente dos OAuth Apps, os GitHub Apps usam permissões granulares em vez de escopos amplos. Você configura as permissões no painel do GitHub durante a criação do aplicativo, e os usuários concedem acesso a repositórios específicos durante a autorização.

Para mais detalhes sobre como configurar GitHub Apps, veja [Registering a GitHub App](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/registering-a-github-app).
:::

## Etapa 2: Configure as permissões no GitHub \{#step-2-configure-permissions-in-github}

Os GitHub Apps usam permissões granulares em vez de escopos OAuth. Você deve configurar as permissões **no painel do GitHub** ao criar ou editar seu GitHub App. Essas permissões determinam quais dados seu aplicativo pode acessar.

### Entendendo as permissões do GitHub App \{#understanding-github-app-permissions}

As permissões são categorizadas em três tipos:

- **Permissões de repositório**: Acesso a recursos no nível do repositório (código, issues, pull requests, etc.)
- **Permissões de organização**: Acesso a recursos no nível da organização (membros, equipes, projetos, etc.)
- **Permissões de conta**: Acesso a dados da conta do usuário (email, perfil, seguidores, etc.)

Para cada permissão, você pode selecionar:

- **No access**: O aplicativo não pode acessar este recurso
- **Read-only**: O aplicativo pode ler, mas não modificar este recurso
- **Read & write**: O aplicativo pode ler e modificar este recurso

### Permissões recomendadas para autenticação \{#recommended-permissions-for-authentication}

Para a funcionalidade básica de "Entrar com o GitHub", configure estas permissões mínimas de **conta**:

| Permissão           | Nível de acesso | Finalidade                                                 |
| ------------------- | --------------- | ---------------------------------------------------------- |
| **Email addresses** | Read-only       | Obter o endereço de email do usuário para criação de conta |

:::tip
Os GitHub Apps têm acesso implícito para ler informações públicas do perfil ao agir em nome de um usuário. Não é necessário solicitar permissão explicitamente para dados básicos do perfil como nome de usuário, avatar e URL do perfil público.
:::

### Permissões adicionais para acesso à API \{#additional-permissions-for-api-access}

Se seu aplicativo precisar acessar APIs do GitHub além da autenticação, adicione as permissões correspondentes no painel do GitHub. Aqui estão alguns exemplos comuns:

| Tipo de permissão | Permissão     | Nível de acesso          | Caso de uso                                                         |
| ----------------- | ------------- | ------------------------ | ------------------------------------------------------------------- |
| **Repository**    | Contents      | Read-only / Read & write | Acessar arquivos e código do repositório                            |
| **Repository**    | Issues        | Read & write             | Criar e gerenciar issues                                            |
| **Repository**    | Pull requests | Read & write             | Criar e gerenciar pull requests                                     |
| **Repository**    | Metadata      | Read-only                | Acessar metadados do repositório (necessário para várias operações) |
| **Organization**  | Members       | Read-only                | Listar membros da organização                                       |
| **Account**       | Followers     | Read-only                | Acessar seguidores e seguidos do usuário                            |

Esta não é uma lista exaustiva — os GitHub Apps suportam muitas outras permissões granulares. Veja [Permissions required for GitHub Apps](https://docs.github.com/en/rest/overview/permissions-required-for-github-apps) para a lista completa.

:::tip[Diferencial chave em relação aos OAuth Apps]
Diferente dos OAuth Apps, onde você configura escopos no conector do Logto, as permissões do GitHub App são gerenciadas inteiramente no painel do GitHub. Você pode deixar o campo `Scope` vazio no seu conector GitHub do Logto — não é necessário porque os GitHub Apps não usam escopos OAuth tradicionais.

Basta configurar as permissões necessárias no GitHub, e os usuários serão solicitados a conceder acesso durante a autorização.
:::

## Etapa 3: Configure seu conector Logto \{#step-3-configure-your-logto-connector}

Após criar o GitHub App, você será redirecionado para a página de configurações dele, onde poderá obter as credenciais.

1. Na página de configurações do seu GitHub App, copie o **Client ID** e cole no campo `clientId` no Logto.
2. Em **Client secrets**, clique em **Generate a new client secret**. Copie o segredo gerado e cole no campo `clientSecret` no Logto.
3. Clique em **Save and Done** no Logto para conectar seu sistema de identidade ao GitHub.

:::warning
Mantenha seu Client secret seguro e nunca o exponha em código do lado do cliente. Os client secrets do GitHub não podem ser recuperados se perdidos — será necessário gerar um novo.
:::

:::note
O Client ID de um GitHub App é diferente do App ID. Certifique-se de usar o Client ID (exibido como "Client ID" na página de configurações), não o App ID.
:::

## Etapa 4: Configurações gerais \{#step-4-general-settings}

Aqui estão algumas configurações gerais que não bloqueiam a conexão com o GitHub, mas podem afetar a experiência de autenticação do usuário final.

### Sincronizar informações do perfil \{#sync-profile-information}

No conector do GitHub, você pode configurar como as informações do perfil são sincronizadas do user info do GitHub para o perfil do usuário no Logto, incluindo `name`, `avatar` e `email`. Escolha entre as seguintes opções:

- **Sincronizar apenas no cadastro**: As informações do perfil são buscadas uma vez quando o usuário faz login pela primeira vez.
- **Sempre sincronizar no login**: As informações do perfil são atualizadas toda vez que o usuário faz login.

### Armazenar tokens para acessar APIs do GitHub (Opcional) \{#store-tokens-to-access-github-apis-optional}

Se você deseja acessar APIs do GitHub e realizar ações com autorização do usuário (seja via login social ou vinculação de conta), ative o armazenamento de tokens no Logto:

1. Configure as permissões necessárias nas configurações do seu GitHub App (Etapa 2).
2. Ative **Store tokens for persistent API access** no conector GitHub do Logto. O Logto armazenará com segurança tanto o token de acesso quanto o token de atualização no Secret Vault.

:::note
Como os GitHub Apps sempre emitem tokens de atualização, o Logto armazena ambos os tokens automaticamente. O token de acesso expira após 8 horas, mas o Logto pode usar o token de atualização para obter novos tokens de acesso, garantindo acesso contínuo à API por até 6 meses.
:::

## Etapa 5: Teste sua integração (Opcional) \{#step-5-test-your-integration-optional}

Antes de ir para produção, teste a integração do seu GitHub App:

1. Use o conector em um tenant de desenvolvimento do Logto.
2. Verifique se os usuários conseguem fazer login com o GitHub.
3. Confira se os usuários são solicitados para as permissões corretas durante a autorização.
4. Se você ativou o armazenamento de tokens, verifique se os tokens de acesso (e tokens de atualização) estão sendo armazenados corretamente.
5. Teste chamadas à API usando os tokens armazenados para garantir que as permissões estão funcionando conforme esperado.

Os GitHub Apps funcionam com qualquer conta de usuário do GitHub imediatamente — não é necessário criar usuários de teste ou aprovação do aplicativo como em outras plataformas. No entanto, se seu aplicativo for instalado em uma organização, os proprietários da organização podem precisar aprovar a instalação.
