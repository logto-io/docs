---
id: custom-domain
title: Пользовательский домен
sidebar_position: 4
---

# Пользовательский домен

Ваш Logto арендатор поставляется с бесплатным доменом по умолчанию `{{tenant-id}}.app.logto`. Однако вы можете улучшить пользовательский опыт и узнаваемость бренда, используя пользовательский домен, например, `auth.example.com`.

Ваш пользовательский домен используется для нескольких функций:

- URL-адреса [страницы входа и регистрации](/end-user-flows/sign-up-and-sign-in)
- URL-адреса для привязки [Passkey](/end-user-flows/mfa/webauthn) (Изменение домена после привязки Passkey пользователями может заблокировать их аутентификацию).
- Callback URI для [социальных коннекторов](/connectors/social-connectors) или [коннекторов корпоративного SSO](/connectors/enterprise-connectors).
- [SDK endpoint](/integrate-logto/application-data-structure#openid-provider-configuration-endpoint) для интеграции Logto с вашим приложением.

:::note
Изменение домена после публикации вашего сервиса может вызвать проблемы, так как ваш код приложения и интеграции могут по-прежнему ссылаться на старый домен. Чтобы обеспечить плавный переход, **настройте ваш пользовательский домен в начале** при создании Production арендатора.
:::

## Настройка пользовательского домена в Console \{#configure-custom-domain-in-console}

Чтобы добавить новый пользовательский домен в Logto Console, выполните следующие шаги:

1. Перейдите в <CloudLink to="/tenant-settings/domains">Console > Settings > Domains</CloudLink>.
2. В разделе "Custom Domain" введите имя вашего домена и нажмите "add domain".

   ![Добавить домен](./assets/custom-domain-section.jpeg)

3. Скопируйте значение CNAME в таблице и перейдите к вашему DNS-провайдеру, чтобы добавить запись.

   ![Обработка пользовательского домена](./assets/custom-domain-processing.jpeg)

4. Дождитесь завершения процесса проверки и SSL.
   1. Мы будем автоматически проверять ваши записи каждые 10 секунд, пока пользовательский домен не будет добавлен. Убедитесь, что введенное имя домена или DNS-записи точны.
   2. Проверка обычно занимает несколько минут, но может занять до 24 часов в зависимости от DNS-провайдера. Вы можете покинуть страницу во время процесса.

## Устранение неполадок \{#troubleshooting}

<details>
<summary>

### Проблемы с SSL-сертификатом \{#ssl-certificate-issues}

</summary>

Если вы столкнулись с проблемами SSL-сертификата при настройке пользовательского домена, это может быть связано с записями CAA в вашей DNS-конфигурации. Записи CAA указывают, какие Центры сертификации (CAs) имеют право выдавать сертификаты для вашего домена.

Для устранения и решения проблем с SSL-сертификатом, связанных с записями CAA, обратитесь к [документации Cloudflare](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/) о записях CAA.

</details>

<details>
<summary>

### Ошибка "Имя хоста связано с удерживаемой зоной" \{#the-hostname-is-associated-with-a-held-zone-error}

</summary>

Если вы столкнулись с сообщением об ошибке "Имя хоста связано с удерживаемой зоной, пожалуйста, свяжитесь с владельцем, чтобы снять удержание" при добавлении пользовательского домена, это означает, что домен уже находится в зоне Cloudflare и установлен в статус "Zone Hold". См. эту [документацию Cloudflare](https://developers.cloudflare.com/fundamentals/setup/account/account-security/zone-holds/) для получения дополнительной информации.

Чтобы решить эту проблему, вам нужно снять удержание зоны. Следуйте приведенной выше ссылке для получения инструкций о том, как снять удержание зоны в Cloudflare.

</details>

## Использование пользовательского домена \{#use-custom-domain}

После настройки ваших параметров как ваше пользовательское доменное имя, так и доменное имя Logto по умолчанию будут доступны для вашего арендатора. Однако для активации вашего пользовательского доменного имени требуются определенные настройки.

:::note
В этой статье мы предполагаем, что ваш пользовательский домен — `auth.example.com`.

![Пользовательский домен добавлен](./assets/custom-domain-added.jpeg)
:::

### Обновление SDK endpoint для приложений \{#updating-the-sdk-endpoint-for-applications}

Измените ваш код инициализации для Logto SDK, изменив доменное имя endpoint.

```typescript
const client = new LogtoClient({
  ...,// другие параметры
  endpoint: 'https://auth.example.com',
});
```

### Изменение auth endpoints для других приложений \{#modifying-auth-endpoints-for-other-applications}

Если у вас есть приложения, которые не используют Logto SDK, необходимо обновить их auth endpoints.

Вы можете найти auth endpoints по известному URL:

```
https://auth.example.com/oidc/.well-known/openid-configuration
```

### Обновление callback URI социального коннектора \{#updating-the-social-connectors-callback-uri}

Callback URI социального коннектора будет обновлен автоматически, если ваши пользователи используют пользовательский домен. Вам нужно перейти в консоль разработчика социального провайдера, чтобы обновить callback URI.

Когда ваши пользователи используют пользовательский домен, callback URI социального коннектора будет использовать новый домен. Поэтому вам нужно перейти в консоль разработчика социального провайдера, чтобы вручную обновить callback URI.
