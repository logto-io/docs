---
sidebar_position: 5
---

# Структура данных коннектора

## Введение \{#introduction}

### Что такое коннектор? \{#what-is-a-connector}

_Коннекторы_ играют важную роль в Logto. С их помощью Logto позволяет конечным пользователям использовать регистрацию или вход без пароля, а также возможности входа с социальными аккаунтами. С ростом популярности веб-сайтов и приложений, вход без пароля и социальные входы позволяют пользователям избегать управления многочисленными аккаунтами и паролями.

Следуйте нашим [руководствам по коннекторам](/connectors), если вы хотите настроить существующий коннектор. Если вы не можете найти нужный коннектор, вы можете разработать его, следуя руководствам в разделе [разработка вашего коннектора](/logto-oss/develop-your-connector).

## Состав \{#compositions}

В данных коннектора много свойств.

Чтобы сделать загрузку и обновление данных более эффективными, мы храним часть данных коннектора, которые будут часто изменяться, в базе данных, а остальную часть локально.

- _Локальное хранилище_, также известное как [_ConnectorMetadata_](/connectors/connector-data-structure#connectors-remote-storage-connector-db), это объект, содержащий фиксированные свойства, такие как логотип, тип коннектора и так далее. (:face_with_monocle: Трудно понять эти свойства? Не волнуйтесь, подробное объяснение будет позже!)
- _Удаленное хранилище_ хранится в базе данных из-за относительно частых изменений этих данных.

## Локальное хранилище коннектора: _ConnectorMetadata_ \{#connectors-local-storage-_connectormetadata_}

### id \{#id}

_id_ — это _уникальный_ строковый ключ для идентификации коннектора в Logto.

Он назначается разработчиками каждого коннектора и будет загружен в базу данных.

### target (Имя провайдера идентификации) \{#target-identity-provider-name}

_target_ — это строка в нижнем регистре для различения источника социальных идентификаций социального коннектора.

Пользователи Logto могут рассматривать эту переменную как "Имя провайдера идентификации" для лучшего понимания.

Например, ваш _target_ должен быть _google_, если вы входите в Logto с помощью вашего аккаунта Google. Значение _target_ может быть произвольной непустой строкой, но мы рекомендуем вам сделать его простым, так как вы не можете его изменить. Мы НЕ допускаем существование нескольких коннекторов с одинаковым _target_ и платформой. С другой стороны, вы можете иметь социальные коннекторы для разных платформ с одинаковым _target_. Например, если пользователи хотят войти через _WeChat_ на своем телефоне, требуется нативное приложение _WeChat_ в соответствии с условиями использования _WeChat_; в то же время, также требуется веб-приложение _WeChat_ для входа в веб-приложения. Эти два приложения _WeChat_ используют одного и того же провайдера идентификации и должны иметь одинаковый target.

Мы заключили различные сценарии использования и рекомендации для пользователей, так как _target_ — это сложная концепция.

|                                         | Пример                                                                                           | Сценарий                                                                                                                      | Результат                                                                                                                                                                    | Рекомендуется?                                                                                                                                                                                                                                |
| --------------------------------------- | ------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Разные IdP и разные _targets_           | 1. Коннектор GitHub (target: `github`) <br /> 2. Коннектор Google (target: `google`)             | Приложение, поддерживающее вход как с аккаунтом GitHub, так и с аккаунтом Google.                                             | Наиболее распространенные случаи использования.                                                                                                                              | ✅                                                                                                                                                                                                                                            |
| Разные IdP и одинаковый _target_        | 1. Коннектор GitHub (target: `github`) <br /> 2. Коннектор Google (target: `github`)             | Н/Д                                                                                                                           | Возможно, пользователь войдет в аккаунт Logto, созданный с использованием аккаунта GitHub другого пользователя.                                                              | ❌                                                                                                                                                                                                                                            |
| Один и тот же IdP и разные _targets_    | 1. Коннектор GitHub (target: `github`) <br /> 2. OAuth коннектор GitHub (target: `github_oauth`) | Коннектор GitHub используется для Приложения A, в то время как OAuth коннектор GitHub был создан специально для Приложения B. | Вход в Logto с использованием этих двух разных коннекторов всегда будет создавать отдельные аккаунты Logto - даже если пользователь использует один и тот же аккаунт GitHub. | Разделение вашего пула пользователей — это единственный сценарий, когда вам нужно использовать оба коннектора. Однако, как правило, считается лучшей практикой создать два отдельных арендатора для решения этой задачи.                      |
| Один и тот же IdP и одинаковый _target_ | 1. Коннектор GitHub (target: `github`) <br /> 2. OAuth коннектор GitHub (target: `github`)       | Н/Д                                                                                                                           | Использование любого из этих двух коннекторов может привести к точно такому же результату.                                                                                   | Создание двух коннекторов, которые по сути делают одно и то же, может быть запутанным для конечных пользователей и не имеет особого смысла. Лучше использовать один коннектор, который соответствует вашему конкретному случаю использования. |

### type \{#type}

_type_ — это свойство, которое записывает тип коннектора.

Мы определяем коннекторы в три разных типа, в зависимости от их функциональности:

- _Social_: Коннекторы, которые могут получать доступ к информации о пользователе из произвольных сторонних социальных сетей с авторизацией конечных пользователей.
- _SMS_: Коннекторы, которые позволяют конечным пользователям получать текстовые сообщения на свои телефоны.
- _Email_: Коннекторы, которые могут помочь отправлять электронные письма конечным пользователям.

### platform \{#platform}

_platform_ используется для идентификации, для какой платформы создан коннектор.

_platform_ должен быть либо `null`, либо одним из следующих строковых значений:

- _Native_: Коннекторы, которые работают ТОЛЬКО для нативных мобильных приложений.
- _Web_: Коннекторы, которые работают ТОЛЬКО на настольных веб-приложениях.
- _Universal_: Коннекторы, которые могут работать как на мобильных веб-приложениях, так и на настольных веб-приложениях.

:::note
_platform_ для _email connectors_ и _SMS connectors_ всегда должен быть `null`.<br/>
ТОЛЬКО _social connectors_ могут иметь ненулевые значения _platform_.
:::

### name \{#name}

_name_ — это объект, ключами которого являются коды стран i18n, а значениями — отображаемое имя коннекторов.

### description \{#description}

_description_ также является объектом, ключами которого являются коды стран i18n, а значениями — краткие описания коннекторов.

:::note
Чтобы поддерживать отображение i18n на стороне клиента, мы храним свойства _name_ (а также _description_) как карту, которая использует коды стран в качестве ключей, а имя (или описание) на местном языке в качестве значения.
:::

### logo \{#logo}

_logo_ — это URL или относительный путь к логотипу коннектора.

### logoDark \{#logodark}

_logoDark_ — это _nullable_ URL или относительный путь к логотипу коннектора в темном режиме.

:::note
_logo_ всегда обязателен, а _logoDark_ является необязательным.

Мы отображаем _logo_ в светлом режиме и _logoDark_ в темном режиме, если он существует. В противном случае будет отображаться _logo_ в темном режиме.
:::

### isStandard \{#isstandard}

_isStandard_ — это НЕОБЯЗАТЕЛЬНЫЙ логический атрибут для идентификации, является ли социальный коннектор "стандартным" коннектором. Вы можете идентифицировать "стандартный" коннектор по его истинному атрибуту `isStandard`.

:::note
Logto поддерживает только "стандартные" социальные коннекторы. Это означает, что все Email или SMS коннекторы Logto НЕ являются "стандартными".

Logto называет коннекторы, построенные на открытых и стандартных протоколах (например, OAuth, OIDC, SAML и т.д.), "стандартными" коннекторами. Ожидается, что пользователи Logto будут создавать несколько экземпляров на каждом стандартном коннекторе в этом контексте. Например, если Logto уже предоставил стандартный коннектор OAuth, пользователи могут создать экземпляры "OAuth GitHub connector", "OAuth Google connector" и "OAuth Facebook connector". Все они основаны на стандартном коннекторе Logto OAuth.

Если вы знакомы с дизайном коннекторов Logto, в любой момент времени может существовать не более ОДНОГО Email или SMS коннектора, что означает, что Logto не нуждается в "стандартных" Email или SMS коннекторах на текущем этапе.
:::

### readme \{#readme}

_readme_ — это относительный путь к файлу README коннектора в формате markdown, содержимое которого будет отображаться в "Консоли администратора" во время настройки коннекторов.

### configTemplate \{#configtemplate}

_configTemplate_ — это относительный путь к примеру конфигурации коннектора.

## Удаленное хранилище коннектора: _Connector DB_ \{#connectors-remote-storage-_connector-db_}

### id \{#id-1}

_id_, который функционирует как первичный ключ базы данных коннектора, это случайно сгенерированный строковый ключ для идентификации коннектора в базе данных.

### connectorId \{#connectorid}

_connectorId_ — это строковый ключ и ЕДИНСТВЕННЫЙ мост для согласования _Connector DB_ и _ConnectorMetadata_. Для каждой пары данных базы данных коннектора и модуля кода коннектора _connectorId_ всегда равен [metadata._id_](#id) модуля кода.

### metadata \{#metadata}

_metadata_ — это подмножество [ConnectorMetadata](#connectors-local-storage-connectormetadata), которое содержит настраиваемые атрибуты, такие как [_logo_](#logo), [_logoDark_](#logodark), [_target_](#target-identity-provider-name) и [_name_](#name).

### syncProfile \{#syncprofile}

_syncProfile_ — это логическое значение, определяющее схему обновления профиля пользователя, по умолчанию FALSE.

Если _syncProfile_ равно FALSE, основная информация пользователя Logto (включая имя и аватар) будет обновляться только при первой регистрации пользователя в Logto через этот коннектор. В противном случае, каждый раз, когда пользователи входят в Logto через коннектор, профиль аккаунта Logto будет обновляться.

### config \{#config}

_config_ может быть произвольным непустым объектом.

Это место, где коннектор хранит свою конфигурацию. Каждый коннектор имеет разные свойства в _config_ и обязан быть действительным (коннекторы имеют разные стандарты для "действительности") перед сохранением в базу данных. ТОЛЬКО те _config_, которые прошли проверку на действительность, могут быть обновлены в базе данных, в противном случае будет выброшена ошибка.

Разработчики обязаны реализовать защиту _config_ при разработке своих собственных коннекторов, см. [разработка вашего коннектора](/logto-oss/develop-your-connector) для получения более подробной информации.

Хотите взглянуть на примеры _config_? Перейдите к [коннекторам](/connectors) или на страницу настроек каждого коннектора.

:::note
В текущей версии Logto может существовать только один _Email/SMS_ коннектор одновременно, все остальные коннекторы с тем же типом автоматически удаляются.

Правило, уникальный рабочий Email или SMS коннектор, не применяется к _Social_ коннекторам.<br/>
Другими словами, вы можете добавить несколько _Social_ коннекторов.
:::

### createdAt \{#createdat}

_createdAt_ — это автоматически генерируемая строка временной метки для отслеживания времени создания коннектора в базе данных.
