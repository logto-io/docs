---
sidebar_position: 2
---

# Настройка ролей

## Настройка через Logto Console \{#configure-via-logto-console}

### Определение типа роли \{#define-role-type}

В Logto существуют два типа ролей в зависимости от сущности, к которой они могут быть применены: "Роль пользователя" или "Роль приложения машина-машина".

1. **Роль пользователя**: Роль пользователя — это тип роли, который можно назначать только пользователям. Она может включать разрешения из ваших собственных ресурсов API.
2. **Роль машина-машина**: Роль M2M — это тип роли, который можно назначать только приложениям машина-машина. Она может включать как ваши собственные разрешения API, так и разрешения Logto Management API. Роль машина-машина обычно используется для защиты вашей аутентификации машина-машина, например, для доступа к Logto Management API или вашим собственным ресурсам API.

После создания роли вы не можете изменить ее тип.

### Создание и определение новой роли \{#create-and-define-a-new-role}

Роль — это группа разрешений. Перейдите в <CloudLink to="/roles">Console > Roles</CloudLink>, и вы увидите список определенных вами ролей.

1. Имейте в виду, что хотя технически возможно создать роль _без_ назначенных разрешений или пользователей, не рекомендуется создавать слишком много пустых ролей. Это нарушит гармонию управления ролями и сделает систему RBAC неэффективной.
2. Разрешения сгруппированы по API в селекторе, что позволяет добавлять их оптом или выбирать по отдельности.

:::note

Управление доступом на основе ролей (RBAC) используется во всей инфраструктуре Logto, как на уровне системы / пользователя, так и на уровне организации. Эта глава сосредоточена на RBAC на уровне системы / пользователя. Если вам нужно реализовать RBAC на уровне организации, обратитесь к [шаблону организации](/authorization/organization-template).

:::

### Просмотр или обновление роли \{#view-or-update-a-role}

Вы также можете редактировать имя и описание роли, а также проверять и управлять разрешениями и пользователями, назначенными роли, в любое время.

:::warning

Удаление роли приведет к удалению всех связанных с ней разрешений для затронутых пользователей и удалению связи между ролями, пользователями или приложениями и разрешениями.

:::

### Управление пользователями или приложениями машина-машина в ролях \{#manage-users-or-machine-to-machine-apps-in-roles}

В зависимости от выбранного типа роли вы сможете назначать или удалять пользователей или приложения машина-машина на странице деталей роли.

Нажмите на вкладку "Users" или "Machine-to-machine apps", чтобы просмотреть пользователей или приложения, назначенные роли. Чтобы продолжить добавление пользователя(ей) или приложения(ий) к роли, нажмите кнопку "Assign users" или "Assign applications" в правом верхнем углу.

### Управление разрешениями в ролях \{#manage-permissions-in-roles}

Если вам нужно изменить возможности роли, вы можете легко сделать это, назначив или удалив разрешения.

:::note

Если разрешение удалено, пользователи или приложения с этой ролью потеряют доступ, предоставленный этим разрешением.

:::

### Управление ролями, назначенными приложению машина-машина или пользователю \{#manage-roles-assigned-to-a-machine-to-machine-app-or-user}

Вы можете найти вкладку "Roles" на странице деталей пользователя или приложения. Нажмите на вкладку, чтобы просмотреть и управлять ролями, назначенными пользователю или приложениям машина-машина.

Если конфигурации в Logto Cloud вам недостаточно, вы можете использовать Management API для выполнения этой задачи программно.

## Настройка через Logto Management API \{#configure-via-logto-management-api}

Управляйте с помощью Logto Management API. Сделайте вызов к соответствующей конечной точке. Ознакомьтесь с этой [справкой](https://openapi.logto.io/operation/operation-listresourcescopes).

| метод  | путь                                                                                                                   | описание                                                                                               |
| ------ | ---------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| GET    | [/api/roles](https://openapi.logto.io/operation/operation-listroles)                                                   | Получить роли с фильтрами и пагинацией.                                                                |
| POST   | [/api/roles](https://openapi.logto.io/operation/operation-createrole)                                                  | Создать новую роль с заданными данными.                                                                |
| GET    | [/api/roles/\{Id\}](https://openapi.logto.io/operation/operation-getrole)                                              | Получить детали роли по ID.                                                                            |
| DELETE | [/api/roles/\{Id\}](https://openapi.logto.io/operation/operation-deleterole)                                           | Удалить роль с заданным ID.                                                                            |
| PATCH  | [/api/roles/\{Id\}](https://openapi.logto.io/operation/operation-updaterole)                                           | Обновить детали роли. Этот метод выполняет частичное обновление.                                       |
| GET    | [/api/roles/\{Id\}/users](https://openapi.logto.io/operation/operation-listroleusers)                                  | Получить пользователей, которым назначена роль, с пагинацией.                                          |
| POST   | [/api/roles/\{Id\}/users](https://openapi.logto.io/operation/operation-createroleuser)                                 | Назначить роль списку пользователей. Роль должна иметь тип `User`.                                     |
| DELETE | [/api/roles/\{Id\}/users/\{userId\}](https://openapi.logto.io/operation/operation-deleteroleuser)                      | Удалить роль у пользователя с заданным ID.                                                             |
| GET    | [/api/roles/\{Id\}/applications](https://openapi.logto.io/operation/operation-listroleapplications)                    | Получить приложения, которым назначена роль, с пагинацией.                                             |
| POST   | [/api/roles/\{Id\}/applications](https://openapi.logto.io/operation/operation-createroleapplication)                   | Назначить роль списку приложений. Роль должна иметь тип `Application`.                                 |
| DELETE | [/api/roles/\{Id\}/applications/\{applicationId\}](https://openapi.logto.io/operation/operation-deleteroleapplication) | Удалить роль у приложения с заданным ID.                                                               |
| GET    | [/api/roles/\{Id\}/scopes](https://openapi.logto.io/operation/operation-listrolescopes)                                | Получить области ресурсов API (разрешения), связанные с ролью.                                         |
| POST   | [/api/roles/\{Id\}/scopes](https://openapi.logto.io/operation/operation-createrolescope)                               | Связать список областей ресурсов API (разрешений) с ролью. Исходные связанные области будут сохранены. |
| DELETE | [/api/roles/\{Id\}/scopes/\{scopeId\}](https://openapi.logto.io/operation/operation-deleterolescope)                   | Отвязать область ресурса API (разрешение) от роли с заданным ID.                                       |

## Роли по умолчанию \{#default-roles}

Роли по умолчанию — это автоматически назначаемые роли при создании пользователей, как при самостоятельной регистрации, так и при создании через Management API. Вы можете включить этот переключатель, перейдя на вкладку "General" на странице деталей в разделе <CloudLink to="/roles">Console > Roles</CloudLink>.
