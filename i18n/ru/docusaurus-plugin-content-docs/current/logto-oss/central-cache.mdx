---
sidebar_position: 5
---

# Центральный кэш

Logto поддерживает использование Redis®[^1] в качестве центрального кэша для общеизвестных данных. Используя центральный кэш, Logto может значительно ускорить работу конечного пользователя, уменьшая количество запросов к базе данных, необходимых для генерации ответа.

[^1]: Redis является зарегистрированной торговой маркой Redis Ltd. Все права на нее принадлежат Redis Ltd. Любое использование компанией Silverhand осуществляется исключительно в справочных целях и не указывает на какое-либо спонсорство, одобрение или аффилиацию между Redis и Silverhand.

Как правило, кэш может быть общедоступным, так как он предназначен только для общеизвестных данных. В настоящее время Logto не хранит данные, требующие аутентификации или авторизации.

:::note
Чтобы обеспечить наилучшие практики безопасности, мы все же рекомендуем ограничить доступ к кэшу.
:::

## Настройка подключения \{#configure-the-connection}

Чтобы включить кэш, вам потребуется экземпляр Redis 6.0, который работает. Для того чтобы Logto мог подключиться и использовать кэш, просто установите переменную окружения `REDIS_URL` на строку подключения Redis, которая должна начинаться с протокола ["redis"](https://www.iana.org/assignments/uri-schemes/prov/redis) (`redis://`) для небезопасных подключений или протокола ["redis"](https://www.iana.org/assignments/uri-schemes/prov/rediss) (`redis://`) для подключения через TLS.

Например:

```bash
REDIS_URL=redis://your-redis-username:your-password@your.redis.url.com:6380
```

Обратите внимание, что большинство частей строки подключения можно опустить, как показано в примере ниже, который составляет строку подключения без имени пользователя и порта, используя протокол "redis":

```bash
REDIS_URL=redis://:your-password@your.redis.url.com
```

Если пароль содержит специальные символы, его необходимо закодировать в формате URI:

```bash
# Если пароль "foo="
REDIS_URL=redis://:foo%3D@your.redis.url.com
```

В случаях, когда используются все значения по умолчанию, вы можете установить переменную в истинное значение для удобства:

```bash
REDIS_URL=1 # или "true", "yes"
```

:::note
Строка [StackExchange.Redis](https://stackexchange.github.io/StackExchange.Redis/Configuration.html) не поддерживается.
:::

## Проверка работы кэша \{#check-if-the-cache-is-working}

Чтобы проверить, правильно ли подключен кэш, вы должны увидеть следующее сообщение при запуске Logto:

```
[CACHE] Connected to Redis
```

Кроме того, когда запрос попадает в кэш (например, при многократном доступе к `GET /api/.well-known/phrases`), в консоли появится следующее сообщение:

```
[CACHE] Well-known cache hit for ...
```
