---
id: secure-webhooks
title: Безопасные вебхуки
sidebar_label: Безопасные вебхуки
sidebar_position: 5
---

# Безопасные вебхуки

Когда ваш сервер готов принимать запросы вебхуков, вы можете убедиться, что он может обрабатывать запросы безопасно. Logto генерирует подпись для каждого payload запроса вебхука, что позволяет вам проверить, что запрос исходит от Logto.

## Получение ключа подписи \{#get-the-signing-key}

Вам нужно получить ключ подписи на странице деталей вебхука в <CloudLink to="/webhooks"> Logto Console > Webhooks</CloudLink>, чтобы проверить подпись.

## Проверка подписи \{#verify-the-signature}

Извлеките подпись из заголовка `logto-signature-sha-256` запроса вебхука.

После этого вы должны сгенерировать подпись, используя ваш ключ подписи и тело запроса вебхука, и убедиться, что результат соответствует подписи от Logto.

:::note
Используйте необработанное тело запроса вебхука для генерации подписи; избегайте использования обработанного тела, так как серверы могут предварительно обрабатывать его перед тем, как он достигнет вашего обработчика конечной точки вебхука.
:::

Logto использует HMAC hex digest для вычисления подписи.

Вот пример того, как проверить подпись в Node.js:

```tsx
import { createHmac } from 'node:crypto';

export const verify = (signingKey: string, rawBody: Buffer[], expectedSignature: string) => {
  const hmac = createHmac('sha256', signingKey);
  hmac.update(rawBody);
  const signature = hmac.digest('hex');
  return signature === expectedSignature;
};
```
