---
id: configure-webhooks
title: Настройка Webhook
sidebar_label: Настройка Webhook
sidebar_position: 2
---

# Настройка webhook

Настройте webhook в Logto Console для достижения бесшовной интеграции и получения уведомлений о событиях в реальном времени для вашего приложения. Наслаждайтесь легкой настройкой, повышенной безопасностью и удобными опциями мониторинга состояния.

## Создание webhook \{#create-a-webhook}

Сначала создайте конечную точку webhook, которая будет вызываться Logto Agent. Эта конечная точка должна быть реализована на вашем сервере и способна принимать HTTP-запросы.

Чтобы создать новый webhook в Logto Console, выполните следующие шаги:

1. **Создать webhook**: Перейдите в <CloudLink to="/webhooks">Console > Webhooks</CloudLink> и нажмите кнопку "Create webhook".
2. **Имя**: Укажите имя для webhook. Это для вашего собственного использования, чтобы определить сценарий использования.
3. **Endpoint URL**: Введите `Endpoint URL`, который является URL вашего сервера, который будет получать POST-запросы webhook, когда произойдет событие. По соображениям безопасности URL должен быть общедоступным через HTTPS и не должен быть локальным URL.

   :::note
   Ваш сервер должен отвечать на запросы webhook Logto с HTTP 200 ("OK") ответом сразу после получения запроса, чтобы уведомить, что запрос был получен.

   Ожидание завершения обработки логики соответствующего события Webhook перед ответом может привести к тайм-ауту Webhook.

   Не возвращайте никакой ответ, кроме 200, на webhook Logto. Если при обработке события возникает ошибка, обработайте ее на своем сервере.
   :::

4. **Событие**: В появившемся модальном окне выберите желаемые [события](/developers/webhooks/webhooks-events), которые будут вызывать этот webhook. Рекомендуется выбирать меньшее количество событий, которые соответствуют вашим требованиям, чтобы избежать перегрузки сервера. Вы можете изменить выбранные события в любое время после создания webhook.

   ![Создать webhook](../assets/create-webhook-page.png)

5. **Отключить / Активировать**: По умолчанию webhook активируется сразу после создания. Если вы хотите временно приостановить webhook, вы можете отключить или активировать его снова, используя меню "Три точки", расположенное в правом верхнем углу заголовка после его создания.

## Защита webhook \{#secure-webhook}

Как только ваш сервер готов принимать запросы webhook, вы можете убедиться, что он может обрабатывать запросы безопасно. Logto генерирует подпись для каждого payload запроса webhook, что позволяет вам проверить, что запрос исходит от Logto.

После создания нового webhook у вас есть варианты для повышения его безопасности:

- **Ключ подписи**: Logto генерирует уникальную хэш-подпись, известную как Ключ подписи, для каждого webhook. Вы можете включить этот ключ в заголовок запроса в вашей реализации конечной точки. Проверка ключа подписи гарантирует, что payload webhook исходит от Logto и не был изменен неавторизованными источниками. Прочитайте [защиту ваших webhook](/developers/webhooks/secure-webhooks/), чтобы узнать больше о коде.
- **Пользовательский заголовок**: У вас есть возможность включить пользовательские заголовки в payload webhook, чтобы предоставить дополнительный контекст или метаданные. Эта функция позволяет добавлять соответствующую информацию, которая может помочь в эффективной обработке данных webhook.

Используя Ключ подписи и учитывая включение Пользовательских заголовков, вы можете повысить безопасность ваших webhook и обеспечить целостность и подлинность полученных payload.

## Тестирование webhook \{#test-webhook}

Чтобы протестировать соединение между Logto и вашими сервисами, просто нажмите кнопку "Send test payload". Logto отправит образец payload для каждого выбранного события на ваш Endpoint URL. Эти тестовые запросы содержат анонимные данные и не записываются в историю последних запросов.

Этот тест гарантирует, что ваш webhook правильно настроен для получения и обработки payload от Logto. Он позволяет вам проверить интеграцию перед развертыванием webhook в рабочей среде.

## Мониторинг состояния webhook \{#monitor-webhook-health-status}

Logto предоставляет удобные инструменты для мониторинга состояния ваших webhook и детального изучения любых потенциальных проблем:

- **Состояние здоровья**
  Список webhook в Logto отображает состояние здоровья каждого webhook, включая процент успешных запросов и общее количество запросов, сделанных за последние 24 часа. Эта информация дает вам общее представление о производительности webhook.
- **Независимые журналы запросов**
  В разделе "Recent Requests" каждого webhook вы можете получить доступ к журналам запросов за последние 24 часа. Каждый запрос записывается отдельно, что позволяет вам просматривать детали каждого запроса и исследовать любые потенциальные ошибки или аномалии.
- **Автоматическая повторная попытка**
  В случае неудачной доставки (когда статус ответа webhook больше или равен 500), Logto автоматически повторяет доставку до трех раз. Будьте уверены, что множественные повторные попытки одного и того же запроса создадут только одну запись в журнале, избегая ненужного дублирования.

Используя эти функции мониторинга, вы можете эффективно отслеживать состояние ваших webhook, изучать журналы запросов и обеспечивать надежность и производительность ваших интеграций webhook.
