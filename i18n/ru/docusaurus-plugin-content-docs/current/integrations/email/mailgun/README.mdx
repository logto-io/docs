---
slug: /integrations/mailgun
sidebar_label: Mailgun
sidebar_custom_props:
  description: Mailgun — это сервис доставки электронной почты для отправки, получения и отслеживания писем.
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# Настройка проверки электронной почты через Mailgun

Официальный коннектор Logto для сервиса электронной почты Mailgun.

<GuideTip />

## Предварительные требования \{#prerequisites}

- Аккаунт [Mailgun](https://www.mailgun.com/)
- Ключ API из вашего аккаунта Mailgun, который требует разрешения на отправку сообщений (писем). Подробнее см. в статье [Где я могу найти свой API-ключ и учетные данные SMTP?](https://help.mailgun.com/hc/en-us/articles/203380100-Where-Can-I-Find-My-API-Key-and-SMTP-Credentials-).

## Базовая конфигурация \{#basic-configuration}

- Заполните поле `endpoint`, если вы используете другой API-эндпоинт Mailgun, например, для региона ЕС это должно быть `https://api.eu.mailgun.net`. Значение по умолчанию — `https://api.mailgun.net`.
- Заполните поле `domain` доменом, который вы зарегистрировали в своем аккаунте Mailgun. Это значение можно найти в разделе **Domains** на панели управления Mailgun. Домен должен быть в формате `example.com`, без префикса `https://` или `http://`.
- Заполните поле `apiKey` ключом API, который вы сгенерировали в своем аккаунте Mailgun.
- Заполните поле `from` адресом электронной почты, с которого вы хотите отправлять письма. Этот адрес электронной почты должен быть зарегистрирован в вашем аккаунте Mailgun. Адрес электронной почты должен быть в формате `Имя Отправителя \<sender@example.com>`.

## Доставки \{#deliveries}

### Объект конфигурации \{#config-object}

Раздел "Deliveries" позволяет настроить содержание писем, которые будут отправляться в различных сценариях. Это JSON-отображение ключ-значение, где ключ — это тип использования, а значение — объект, содержащий конфигурацию содержимого для отправляемого письма.

```json
{
  "<usage-type>": {
    // ...
  }
}
```

### Типы использования \{#usage-types}

Поддерживаются следующие типы использования:

- `Register`: Письмо, отправляемое при регистрации пользователя.
- `SignIn`: Письмо, отправляемое при входе пользователя.
- `ForgotPassword`: Письмо, отправляемое при сбросе пароля пользователем.
- `Generic`: Письмо, отправляемое при выполнении пользователем общего действия, например, тестирования коннектора электронной почты.

:::note
Если тип использования не указан в конфигурации доставок, будет отправлено общее письмо. Если общее письмо не указано, коннектор вернет ошибку.
:::

### Конфигурация содержимого \{#content-config}

Коннектор поддерживает как прямое HTML-содержимое, так и шаблон Mailgun. Вы можете использовать один из них для каждого типа использования.

В теме и содержимом вы можете использовать плейсхолдер `{{code}}` для вставки кода проверки.

Чтобы использовать прямое HTML-содержимое, заполните следующие поля:

- `subject`: Тема отправляемого письма.
- `replyTo`: Адрес электронной почты, который будет использоваться как адрес для ответа.
- `html`: (Обязательно) HTML-содержимое отправляемого письма.
- `text`: Версия письма в виде простого текста.

Чтобы использовать шаблон Mailgun, заполните следующие поля:

- `subject`: Тема отправляемого письма.
- `replyTo`: Адрес электронной почты, который будет использоваться как адрес для ответа.
- `template`: (Обязательно) Имя используемого шаблона Mailgun.
- `variables`: Переменные, которые будут переданы в шаблон Mailgun. Должны быть в формате JSON-отображения ключ-значение, так как они будут преобразованы в строку перед отправкой в Mailgun. Обратите внимание, что нет необходимости включать переменную `code`, так как она будет автоматически добавлена коннектором.

### Пример \{#example}

Ниже приведен пример конфигурации доставок:

```json
{
  "Register": {
    "subject": "{{code}} is your verification code",
    "replyTo": "Foo <foo@bar.com>",
    "html": "<h1>Welcome to Logto</h1><p>Your verification code is {{code}}.</p>",
    "text": "Welcome to Logto. Your verification code is {{code}}."
  },
  "SignIn": {
    "subject": "Welcome back to Logto",
    "replyTo": "Foo <foo@bar.com>",
    "template": "logto-sign-in",
    "variables": {
      "bar": "baz"
    }
  }
}
```

## Тестирование коннектора электронной почты Mailgun \{#test-mailgun-email-connector}

Вы можете ввести адрес электронной почты и нажать "Отправить", чтобы проверить, работают ли настройки, перед тем как нажать "Сохранить и завершить".

Вот и все. Не забудьте [включить коннектор в опыте входа](/connectors/email-connectors/#enable-email-sign-up-or-sign-in).
