## Регистрация аккаунта SendGrid \{#register-sendgrid-account}

Создайте новый аккаунт на [веб-сайте SendGrid](https://app.sendgrid.com/). Вы можете пропустить этот шаг, если у вас уже есть аккаунт.

## Подтверждение отправителей \{#verify-senders}

Перейдите на [страницу консоли SendGrid](https://app.sendgrid.com/) и войдите в систему с вашим аккаунтом SendGrid.

Отправители указывают адреса, с которых будет отправлено наше письмо с кодом подтверждения. Чтобы отправлять электронные письма через почтовый сервер SendGrid, вам нужно подтвердить как минимум одного отправителя.

Начиная с [страницы консоли SendGrid](https://app.sendgrid.com/), перейдите в "Settings" -> "Sender Authentication" в боковой панели.

Аутентификация домена рекомендуется, но не обязательна. Вы можете нажать "Get started" в карточке "Authenticate Your Domain" и следовать предстоящему руководству, чтобы связать и подтвердить отправителя в SendGrid.

Нажав кнопку "Verify a Single Sender" в панели, вы сосредоточитесь на форме, требующей некоторой важной информации для создания отправителя. Следуйте руководству, заполните все эти поля и нажмите кнопку "Create".

После создания одного отправителя на адрес электронной почты вашего отправителя должно быть отправлено письмо с ссылкой для подтверждения. Перейдите в свой почтовый ящик, найдите письмо с подтверждением и завершите проверку одного отправителя, нажав на ссылку, указанную в письме. Теперь вы можете отправлять электронные письма через коннектор SendGrid, используя отправителя, которого вы только что подтвердили.

## Создание API ключей \{#create-api-keys}

Начнем с [страницы консоли SendGrid](https://app.sendgrid.com/), перейдите в "Settings" -> "API Keys" в боковой панели.

Нажмите "Create API Key" в правом верхнем углу страницы API Keys. Введите имя API ключа и настройте "API Key Permission" в соответствии с вашим случаем использования. Глобальный `Full Access` или `Restricted Access` с полным доступом к Mail Send требуется перед отправкой писем с этим API ключом.

API ключ будет представлен вам на экране, как только вы завершите процесс _Create API Key_. Вы должны сохранить этот API ключ в безопасном месте, так как это единственный шанс, когда вы можете его увидеть.

## Настройка вашего коннектора \{#configure-your-connector}

Заполните поле `apiKey` с API ключом, созданным в разделе "Создание API ключей".

Заполните поля `fromEmail` и `fromName` с _From Address_ и _Nickname_ отправителей. Вы можете найти детали отправителя на ["странице управления отправителями"](https://mc.sendgrid.com/senders). `fromName` является НЕОБЯЗАТЕЛЬНЫМ, поэтому вы можете пропустить его заполнение.

Вы можете добавить несколько шаблонов почтового коннектора SendGrid для различных случаев. Вот пример добавления одного шаблона:

- Заполните поле `subject`, которое будет работать как заголовок писем.
- Заполните поле `content` произвольным строковым содержимым. Не забудьте оставить `{{code}}` как заполнитель для случайного кода подтверждения.
- Заполните поле `usageType` одним из значений: `Register`, `SignIn`, `ForgotPassword`, `Generic` для различных случаев использования.
- Заполните поле `type` одним из значений: `text/plain` или `text/html` для различных типов содержимого.

Для включения полных пользовательских потоков требуются шаблоны с `usageType` `Register`, `SignIn`, `ForgotPassword` и `Generic`.

Вот пример JSON шаблона коннектора SendGrid.

```jsonc
[
  {
    "subject": "<register-template-subject>",
    "content": "<Logto: Ваш код подтверждения {{code}}. (шаблон регистрации)>",
    "usageType": "Register",
    "type": "text/plain",
  },
  {
    "subject": "<sign-in-template-subject>",
    "content": "<Logto: Ваш код подтверждения {{code}}. (шаблон входа)>",
    "usageType": "SignIn",
    "type": "text/plain",
  },
  {
    "subject": "<forgot-password-template-subject>",
    "content": "<Logto: Ваш код подтверждения {{code}}. (шаблон восстановления пароля)>",
    "usageType": "ForgotPassword",
    "type": "text/plain",
  },
  {
    "subject": "<generic-template-subject>",
    "content": "<Logto: Ваш код подтверждения {{code}}. (общий шаблон)>",
    "usageType": "Generic",
    "type": "text/plain",
  },
]
```

### Тестирование почтового коннектора SendGrid \{#test-sendgrid-email-connector}

Вы можете ввести адрес электронной почты и нажать "Send", чтобы проверить, работают ли настройки, перед тем как нажать "Save and Done".

Вот и все. Не забудьте [включить коннектор в опыте входа](/connectors/email-connectors/#enable-email-sign-up-or-sign-in)

### Типы конфигурации \{#config-types}

| Имя       | Тип                    |
| --------- | ---------------------- |
| apiKey    | string                 |
| fromEmail | string                 |
| fromName  | string (НЕОБЯЗАТЕЛЬНО) |
| templates | Template[]             |

| Свойства шаблона | Тип         | Значения перечисления                                   |
| ---------------- | ----------- | ------------------------------------------------------- |
| subject          | string      | N/A                                                     |
| content          | string      | N/A                                                     |
| usageType        | enum string | 'Register' \| 'SignIn' \| 'ForgotPassword' \| 'Generic' |
| type             | enum string | 'text/plain' \| 'text/html'                             |
