## Создание вашего OIDC приложения \{#create-your-oidc-app}

Когда вы открываете эту страницу, мы предполагаем, что вы уже знаете, к какому социальному провайдеру идентификации вы хотите подключиться. Первое, что нужно сделать, это подтвердить, что провайдер идентификации поддерживает протокол OIDC, который является необходимым условием для настройки действительного коннектора. Затем следуйте инструкциям провайдера идентификации, чтобы зарегистрировать и создать соответствующее приложение для OIDC авторизации.

## Настройка вашего коннектора \{#configure-your-connector}

Мы поддерживаем ТОЛЬКО тип предоставления "Authorization Code" из соображений безопасности, и он идеально подходит для сценария Logto.

`clientId` и `clientSecret` можно найти на странице деталей вашего OIDC приложения.

_clientId_: Идентификатор клиента — это уникальный идентификатор, который идентифицирует клиентское приложение при регистрации на сервере авторизации. Этот идентификатор используется сервером авторизации для проверки личности клиентского приложения и для ассоциации любых авторизованных токенов доступа с этим конкретным клиентским приложением.

_clientSecret_: Секрет клиента — это конфиденциальный ключ, который выдается клиентскому приложению сервером авторизации при регистрации. Клиентское приложение использует этот секретный ключ для аутентификации на сервере авторизации при запросе токенов доступа. Секрет клиента считается конфиденциальной информацией и должен оставаться в безопасности в любое время.

_tokenEndpointAuthMethod_: Метод аутентификации на конечной точке токена используется клиентским приложением для аутентификации на сервере авторизации при запросе токенов доступа. Чтобы узнать поддерживаемые методы, обратитесь к полю `token_endpoint_auth_methods_supported`, доступному на конечной точке обнаружения OpenID Connect провайдера услуг OAuth 2.0, или обратитесь к соответствующей документации, предоставленной провайдером услуг OAuth 2.0.

_clientSecretJwtSigningAlgorithm (необязательно)_: Требуется только тогда, когда `tokenEndpointAuthMethod` — это `client_secret_jwt`. Алгоритм подписи JWT с секретом клиента используется клиентским приложением для подписи JWT, который отправляется на сервер авторизации во время запроса токена.

_scope_: Параметр области действия используется для указания набора ресурсов и разрешений, к которым клиентское приложение запрашивает доступ. Параметр области действия обычно определяется как список значений, разделенных пробелами, которые представляют собой конкретные разрешения. Например, значение области действия "read write" может указывать, что клиентское приложение запрашивает доступ на чтение и запись к данным пользователя.

Вы должны найти `authorizationEndpoint`, `tokenEndpoint`, `jwksUri` и `issuer` как информацию о конфигурации OpenID провайдера. Они должны быть доступны в документации социального поставщика.

_authenticationEndpoint_: Эта конечная точка используется для инициирования процесса аутентификации. Процесс аутентификации обычно включает вход пользователя и предоставление разрешения клиентскому приложению на доступ к его ресурсам.

_tokenEndpoint_: Эта конечная точка используется клиентским приложением для получения ID токена, который может быть использован для доступа к запрашиваемым ресурсам. Клиентское приложение обычно отправляет запрос на конечную точку токена с типом предоставления и кодом авторизации для получения ID токена.

_jwksUri_: Это URL-адрес конечной точки, где можно получить набор JSON Web Key Set (JWKS) социального провайдера идентификации (сокращенно IdP). JWKS — это набор криптографических ключей, которые IdP использует для подписи и проверки JSON Web Tokens (JWT), которые выдаются во время процесса аутентификации. `jwksUri` используется доверяющей стороной (RP) для получения открытых ключей, используемых IdP для подписи JWT, чтобы RP могла проверить подлинность и целостность JWT, полученных от IdP.

_issuer_: Это уникальный идентификатор IdP, который используется RP для проверки JWT, полученных от IdP. Он включен в JWT как `iss` [утверждение](https://www.rfc-editor.org/rfc/rfc7519#section-4) (ID токен всегда является JWT). Значение эмитента должно соответствовать URL-адресу сервера авторизации IdP и должно быть URI, которому доверяет RP. Когда RP получает JWT, он проверяет утверждение `iss`, чтобы убедиться, что оно было выдано доверенным IdP, и что JWT предназначен для использования с RP.

Вместе `jwksUri` и `issuer` обеспечивают безопасный механизм для RP для проверки личности конечного пользователя во время процесса аутентификации. Используя открытые ключи, полученные из `jwksUri`, RP может проверить подлинность и целостность JWT, выданных IdP. Значение эмитента гарантирует, что RP принимает только JWT, которые были выданы доверенным IdP, и что JWT предназначены для использования с RP.

Поскольку запрос аутентификации всегда требуется, предоставляется `authRequestOptionalConfig` для обертки всех необязательных конфигураций, вы можете найти подробности на [OIDC Authentication Request](https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest). Вы также можете заметить, что `nonce` отсутствует в этой конфигурации. Поскольку `nonce` должен быть идентичным для каждого запроса, мы помещаем генерацию `nonce` в реализацию кода. Так что не беспокойтесь об этом! Ранее упомянутые `jwksUri` и `issuer` также включены в `idTokenVerificationConfig`.

Возможно, вам интересно, почему стандартный OIDC протокол поддерживает как неявные, так и гибридные потоки, но коннектор Logto поддерживает только поток авторизации. Было определено, что неявные и гибридные потоки менее безопасны, чем поток авторизации. Из-за акцента Logto на безопасность, он поддерживает только поток авторизации для обеспечения наивысшего уровня безопасности для своих пользователей, несмотря на его немного менее удобный характер.

`responseType` и `grantType` могут быть ТОЛЬКО ФИКСИРОВАННЫМИ значениями с потоком "Authorization Code", поэтому мы делаем их необязательными, и значения по умолчанию будут автоматически заполнены.

:::note

Для всех типов потоков мы предоставили НЕОБЯЗАТЕЛЬНЫЙ ключ `customConfig` для размещения ваших настроек параметров.
Каждый социальный провайдер идентификации может иметь свои собственные варианты стандартного протокола OIDC. Если ваш желаемый социальный провайдер идентификации строго придерживается стандартного протокола OIDC, то вам не нужно беспокоиться о `customConfig`.

:::

## Типы конфигураций \{#config-types}

| Имя                       | Тип                       | Обязательно |
| ------------------------- | ------------------------- | ----------- |
| scope                     | string                    | Да          |
| clientId                  | string                    | Да          |
| clientSecret              | string                    | Да          |
| authorizationEndpoint     | string                    | Да          |
| tokenEndpoint             | string                    | Да          |
| idTokenVerificationConfig | IdTokenVerificationConfig | Да          |
| authRequestOptionalConfig | AuthRequestOptionalConfig | Нет         |
| customConfig              | Record\<string, string>   | Нет         |

| Свойства AuthRequestOptionalConfig | Тип    | Обязательно |
| ---------------------------------- | ------ | ----------- |
| responseType                       | string | Нет         |
| tokenEndpoint                      | string | Нет         |
| responseMode                       | string | Нет         |
| display                            | string | Нет         |
| prompt                             | string | Нет         |
| maxAge                             | string | Нет         |
| uiLocales                          | string | Нет         |
| idTokenHint                        | string | Нет         |
| loginHint                          | string | Нет         |
| acrValues                          | string | Нет         |

| Свойства IdTokenVerificationConfig | Тип                                | Обязательно |
| ---------------------------------- | ---------------------------------- | ----------- |
| jwksUri                            | string                             | Да          |
| issuer                             | string \| string[]                 | Нет         |
| audience                           | string \| string[]                 | Нет         |
| algorithms                         | string[]                           | Нет         |
| clockTolerance                     | string \| number                   | Нет         |
| crit                               | Record\<string, string \| boolean> | Нет         |
| currentDate                        | Date                               | Нет         |
| maxTokenAge                        | string \| number                   | Нет         |
| subject                            | string                             | Нет         |
| typ                                | string                             | Нет         |

Смотрите [здесь](https://github.com/panva/jose/blob/main/docs/jwt/verify/interfaces/JWTVerifyOptions.md) для получения более подробной информации о `IdTokenVerificationConfig`.
