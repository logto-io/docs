---
slug: /integrations/alipay-web
sidebar_label: Alipay (Web)
sidebar_custom_props:
  description: Alipay — это сторонняя платформа для мобильных и онлайн-платежей.
  logoFilename: 'alipay.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# Настройка социального входа через Alipay (Web)

Официальный коннектор Logto для социального входа через Alipay в веб-приложениях.

<GuideTip />

## Начало работы \{#get-started}

Коннектор Alipay Web предназначен для настольных веб-приложений. Он использует аутентификационный процесс OAuth 2.0 Alipay и позволяет пользователям Alipay входить в другие приложения, используя публичные профили пользователей Alipay, без необходимости проходить сложный процесс регистрации.

## Регистрация учетной записи разработчика Alipay \{#register-alipay-developer-account}

[Зарегистрируйте учетную запись разработчика Alipay](https://certifyweb.alipay.com/certify/reg/guide#/) если у вас ее нет.

## Создание и настройка приложения Alipay \{#create-and-configure-alipay-app}

1. Войдите в [консоль Alipay](https://open.alipay.com/) с учетной записью, которую вы только что зарегистрировали.
2. Перейдите на вкладку "Web & Mobile Apps" (网页&移动应用) в панели "My Application" (我的应用).
3. Нажмите кнопку "Create an App" (立即创建), чтобы начать настройку вашего приложения.
4. Назовите ваше приложение в поле "Application Name" (应用名称) в соответствии с правилами именования и загрузите "Application Icon" (应用图标), убедитесь, что вы выбрали "web application" (网页应用) как "App type" (应用类型).
5. После завершения создания приложения перейдите на страницу Обзора, где следует нажать "add ability" (添加能力), чтобы добавить "Third-party application authorization" (第三方应用授权), "Get member information" (获取会员信息) и "App Alipay login" (App 支付宝登录) перед включением входа через Alipay.
6. Перейдите в [Центр обслуживания клиентов Alipay](https://b.alipay.com/index2.htm) и войдите с учетной записью разработчика Alipay. Нажмите "Account Center" (账号中心) на верхней панели и перейдите в "APPID binding" (APPID 绑定), вход в который можно найти внизу боковой панели. "Add binding" (添加绑定), введя APPID веб-приложения, которое вы только что создали на шаге 4.
7. Нажмите кнопку "Sign" для "App Alipay login" и завершите процесс подписания, следуя инструкциям. После завершения этого шага вы должны увидеть, что возможности, которые вы только что добавили на шаге 5, начинают работать.
8. Вернитесь на страницу консоли открытой платформы Alipay, и вы найдете "Interface signing method" (接口加签方式（密钥/证书）) в разделе "development information" (开发信息). Нажмите кнопку "set up" (设置), и вы окажетесь на странице настройки метода подписания. "Public Key" (公钥) является предпочтительным режимом подписания, и заполните содержимое из файла открытого ключа в текстовом поле ввода.
9. Настройте "Authorization Redirect URI" (授权回调地址), нажав кнопку "set up" (设置) внизу страницы консоли Alipay. `${your_logto_origin}/callback/${connector_id}` — это URI перенаправления по умолчанию, используемый в Logto core. `connector_id` можно найти на верхней панели страницы деталей коннектора в Logto Admin Console.
10. После завершения всех этих шагов вернитесь в правый верхний угол страницы консоли Alipay и нажмите "Submit for review" (提交审核). Как только проверка будет одобрена, вы готовы к плавному процессу входа через Alipay.

:::note
Вы можете использовать _openssl_ для генерации пар ключей на вашем локальном компьютере, выполнив следующий код в терминале.

```bash
openssl genrsa -out private.pem 2048
openssl rsa -in private.pem -outform PEM -pubout -out public.pem
```

При заполнении открытого ключа на сайте настройки приложения Alipay вам нужно удалить заголовок и нижний колонтитул `public.pem`, удалить все символы новой строки и вставить остальное содержимое в текстовое поле ввода для "public key".

:::

## Настройка параметров коннектора Logto Alipay Web \{#set-up-the-logto-alipay-web-connector-settings}

1. В [рабочем пространстве консоли Alipay](https://open.alipay.com/dev/workspace) перейдите в панель "My application" (我的应用) и нажмите вкладку "Web & Mobile Apps" (网页&移动应用), вы найдете APPID всех приложений.
2. На шаге 7 предыдущей части вы уже сгенерировали пару ключей, включая закрытый и открытый ключи.
3. Заполните настройки коннектора Logto:
   - Заполните поле `appId` с APPID, который вы получили на шаге 1.
   - Заполните поле `privateKey` содержимым из файла закрытого ключа, упомянутого на шаге 2. Пожалуйста, УБЕДИТЕСЬ, что вы используете '\n' для замены всех символов новой строки и не удаляйте заголовок и нижний колонтитул в файле закрытого ключа.
   - Заполните поле `signType` значением 'RSA2' из-за режима подписания `Public key`, который мы выбрали на шаге 7 "Создание и настройка приложений Alipay".
   - Заполните поле `charset` значением 'gbk' или 'utf8'. Вы можете оставить это поле пустым, так как оно НЕОБЯЗАТЕЛЬНО. Значение по умолчанию установлено как 'utf8'.
   - Заполните поле `scope` значением 'auth_base' или 'auth_user'. Вы можете оставить это поле пустым, так как оно НЕОБЯЗАТЕЛЬНО. Значение по умолчанию установлено как 'auth_user'. Вы можете ознакомиться с [различиями](https://opendocs.alipay.com/fw/api/105942) между различными значениями.

### Типы конфигурации \{#config-types}

| Имя        | Тип                    | Значения перечисления        |
| ---------- | ---------------------- | ---------------------------- |
| appId      | string                 | N/A                          |
| privateKey | string                 | N/A                          |
| signType   | enum string            | 'RSA' \| 'RSA2'              |
| charset    | enum string (OPTIONAL) | 'gbk' \| 'utf8' \| undefined |
| scope      | enum string (OPTIONAL) | 'auth_user' \| 'auth_base'   |

## Тестирование веб-коннектора Alipay \{#test-alipay-web-connector}

Вот и все. Не забудьте [включить социальный коннектор в опыте входа](/connectors/social-connectors/#enable-social-sign-in).

Как только веб-коннектор Alipay будет включен, вы можете создать и запустить ваше веб-приложение, чтобы проверить, работает ли оно.

## Ссылки \{#references}

<Url href="https://opendocs.alipay.com/support/01rau6">
  Документация Alipay - Подготовка доступа - Как создать приложение
</Url>

<Url href="https://opendocs.alipay.com/open/200/105310">
  Документация Alipay - Веб и мобильные приложения - Создание приложения
</Url>
