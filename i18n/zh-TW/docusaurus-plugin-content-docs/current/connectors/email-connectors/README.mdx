---
id: email-connectors
title: 電子郵件連接器 (Email connectors)
sidebar_label: 電子郵件連接器 (Email connectors)
sidebar_position: 1
---

# 電子郵件連接器 (Email connectors)

電子郵件連接器 (Email connector) 可將你的電子郵件發送服務整合至 Logto，實現透過電子郵件進行安全的使用者驗證 (Authentication)。設定完成後，你可以發送 [一次性密碼 (OTP, One-Time Passwords)](https://auth.wiki/otp) 用於使用者 [註冊](/end-user-flows/sign-up-and-sign-in/sign-up)、[登入](/end-user-flows/sign-up-and-sign-in/sign-in)、[重設密碼](/end-user-flows/sign-up-and-sign-in/reset-password)、[帳號連結](/end-user-flows/sign-up-and-sign-in/social-sign-in#account-linking)、[成員邀請](/end-user-flows/organization-experience/invite-organization-members) 及 [高風險操作驗證](/end-user-flows/security-verification)。

## 選擇你的電子郵件連接器 (Email connector) \{#choose-your-email-connector}

Logto 提供三種電子郵件連接器選項：

### 免費 Logto 電子郵件服務（僅限 Cloud）\{#free-logto-email-service-cloud-only}

這個內建電子郵件服務選項非常適合快速開始，無論是 [測試](/logto-cloud/tenant-settings#development) 或 [正式環境](/logto-cloud/tenant-settings#production) 都能使用。它免除第三方整合需求，並提供免費且可靠的郵件發送服務。你只需自訂基本品牌設定，即可套用預設設計的郵件模板。

Logto 電子郵件服務連接器 (Logto Email Service connector) 現已支援品牌化自訂，包括 Logo、公司資訊與寄件人名稱。

然而，雖然方便，仍有部分限制需注意——你無法自訂寄件人電子郵件地址、網域或郵件內容細節。

```mdx-code-block
import DocCardList from '@theme/DocCardList';
import LogtoEmailService from '@site/docs/connectors/assets/icons/logto-email-service.svg';
import AwsDm from '@site/docs/connectors/assets/icons/aws-direct-mail.svg';
import SendGrid from '@site/docs/connectors/assets/icons/sendgrid.svg';
import Mailgun from '@site/docs/connectors/assets/icons/mailgun.svg';
import Postmark from '@site/docs/connectors/assets/icons/postmark.svg';
import AliyunDm from '@site/docs/connectors/assets/icons/aliyun-direct-mail.svg';
import Smtp from '@site/docs/connectors/assets/icons/smtp.svg';
import Http from '@site/docs/connectors/assets/icons/http.svg';

<DocCardList
  items={[
    {
      type: 'link',
      label: 'Logto Email Service',
      href: '/connectors/email-connectors/built-in-email-service',
      description: 'Logto Email Service 的官方連接器。',
      customProps: {
        icon: <LogtoEmailService />,
      }
    },
  ]}
/>
```

### 主流電子郵件服務供應商 \{#popular-email-providers}

透過 Logto 的逐步指引，連接你偏好的電子郵件服務供應商（ESP）。

這些選項允許你完整 [自訂郵件模板](/connectors/email-connectors/email-templates)、寄件人名稱、加入變數等，以最佳化你的品牌體驗。

我們現成支援以下電子郵件服務供應商：

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'AWS Direct Mail',
      href: '/integrations/aws-ses',
      description: 'AWS 直郵服務的 Logto 官方連接器。',
      customProps: {
        icon: <AwsDm />,
      }
    },
    {
      type: 'link',
      label: 'Mailgun',
      href: '/integrations/mailgun',
      description: 'Mailgun 電子郵件服務的 Logto 官方連接器。',
      customProps: {
        icon: <Mailgun />,
      }
    },
    {
      type: 'link',
      label: 'SendGrid Email',
      href: '/integrations/sendgrid-email',
      description: 'SendGrid 電子郵件服務的 Logto 官方連接器。',
      customProps: {
        icon: <SendGrid />,
      }
    },
    {
      type: 'link',
      label: 'Aliyun Direct Mail',
      href: '/integrations/aliyun-dm',
      description: '阿里雲直郵服務的 Logto 官方連接器。',
      customProps: {
        icon: <AliyunDm />,
      }
    },
    {
      type: 'link',
      label: 'Postmark Mail',
      href: '/integrations/postmark',
      description: 'Postmark 電子郵件服務的 Logto 連接器。',
      customProps: {
        icon: <Postmark />,
      }
    },
  ]}
/>
```

### 自訂你的電子郵件連接器 (Email connector) \{#customize-your-email-connector}

若上述方案皆不符需求，你也可以選擇透過簡單郵件傳輸協定（SMTP, Simple Mail Transfer Protocol）連接你想要的電子郵件服務。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'SMTP',
      href: '/integrations/smtp',
      description: 'SMTP 的 Logto 官方連接器。',
      customProps: {
        icon: <Smtp />,
      }
    },
  ]}
/>
```

如果你已有自有電子郵件服務且無法使用 SMTP 連線，我們也提供「HTTP 電子郵件連接器 (HTTP email connector)」。

當需要發送郵件時，Logto 會向你設定的 `endpoint` 發送 API 請求，以完成依賴郵件的驗證流程。請注意，為避免驗證流程錯誤，設定的 endpoint 在收到 WebHook 後需回傳 200 回應，告知 Logto 已收到發送郵件的通知。在這種情況下，你需自行監控郵件服務以確保郵件成功送達。

```mdx-code-block
<DocCardList
  items={[
    {
      type: 'link',
      label: 'HTTP email connector',
      href: '/integrations/http-email',
      description: 'HTTP 電子郵件的 Logto 官方連接器。',
      customProps: {
        icon: <Http />,
      }
    },
  ]}
/>
```

若我們的標準連接器無法滿足你的特殊需求，歡迎 [聯絡我們](https://feedback.logto.io/roadmap)。若你是 OSS 使用者且需求緊急，也可 [自行實作連接器 (OSS)](/logto-oss/develop-your-connector/implement-connectors#build-a-passwordless-connector)。我們也歡迎 [貢獻](/logto-oss/contribution)；你的努力可能幫助到有相同需求的社群成員。

## 設定步驟 \{#configure-steps}

請依下列步驟新增電子郵件連接器 (Email connector)：

1. 前往 <CloudLink to="/connectors/passwordless">Console > Connectors > Email and SMS connectors</CloudLink>。
2. 點擊「Set up」按鈕並選擇你想要的電子郵件服務供應商以新增連接器。
3. 依照 README 文件逐步設定你選擇的服務供應商。
4. 點擊「Save and Done」完成設定。

:::note

為確保重要郵件（如驗證碼）能可靠送達使用者收件匣並避免進入垃圾郵件，請注意以下兩點：

- **設定郵件驗證（SPF、DKIM、DMARC）**
  電子郵件服務商（如 Gmail、Outlook 等）會利用這些協議驗證你不是垃圾郵件發送者。若未設定，郵件可能進垃圾信或被拒收。
  - SPF（寄件人政策框架）：列出允許為你網域發信的伺服器 / IP。
  - DKIM（網域金鑰識別郵件）：為郵件加上數位簽章，證明內容未被竄改。
  - DMARC（基於網域的郵件驗證）：告知收件方如何處理 SPF / DKIM 驗證失敗的郵件。
- **分離驗證 (Authentication) 與行銷郵件**
  行銷郵件常被投訴或產生高退信率，若驗證郵件與行銷郵件共用同一網域 / IP，將影響驗證郵件的送達率。
  - 使用專屬網域：驗證郵件用 `@auth.yourdomain.com`，行銷郵件用 `@marketing.yourdomain.com`。
  - 專屬 IP：為驗證郵件申請獨立 IP，並逐步暖機。
  - 寄件人地址一致：確保寄件人網域與 SPF / DKIM / DMARC 記錄一致。

:::

## 更換電子郵件連接器 (Email connector) \{#change-email-connector}

你可能會注意到僅能新增一個電子郵件連接器 (Email connector)。

當你已有電子郵件連接器時，只能選擇「更換電子郵件連接器」。在 Console 執行此操作時，儲存後會立即生效，因此請務必在儲存前測試你的設定。

為確保服務穩定，Cloud 用戶可建立 [開發租戶 (dev tenant)](/logto-cloud/tenant-settings#development) 作為開發環境。於開發環境測試設定後，再將設定「遷移」至 [正式環境 (production)](/logto-cloud/tenant-settings#production) 並儲存。

## 啟用電子郵件於終端使用者流程 \{#enable-email-address-for-end-user-flows}

新增並設定電子郵件連接器後，你可以啟用基於電子郵件的驗證 (Authentication) 流程：

- [**設定註冊方式**](/end-user-flows/sign-up-and-sign-in/sign-up)：前往 <CloudLink to="/sign-in-experience/sign-up-and-sign-in">Sign-in experience > Sign-up and sign-in</CloudLink>，於註冊區段新增「Email address」或「Email address or phone number」作為識別子。注意：註冊時必須進行電子郵件驗證。
- [**設定登入方式**](/end-user-flows/sign-up-and-sign-in/sign-in)：於登入區段新增「Email address」作為登入方式，可選擇密碼或郵件驗證碼進行驗證 (Authentication)。點擊「Add another」可新增其他選項。
- [**設定忘記密碼**](/end-user-flows/sign-up-and-sign-in/reset-password)：若啟用密碼登入，登入區段會出現「Forgot password」設定，啟用「Email verification code」即可讓使用者透過郵件重設密碼。
- [**設定電子郵件作為 MFA**](/end-user-flows/mfa/email-mfa)：前往 <CloudLink to="/mfa">Sign-in experience > Multi-factor auth</CloudLink>，啟用「Email verification code」作為第二驗證因素以提升安全性。
- [**設定帳號管理**](/end-user-flows/account-settings/by-account-api#update-or-link-new-email)：透過 [Account API](/end-user-flows/account-settings/by-account-api) 自訂帳號中心，讓使用者管理其電子郵件地址。

:::warning
由於我們的設定會立即生效，刪除現有電子郵件連接器 (Email connector) 可能影響終端使用者正常登入與註冊流程。

例如，若登入識別子包含「email + 驗證碼」組合，刪除現有電子郵件連接器後，使用者將無法收到郵件驗證碼，登入流程將發生錯誤。

請操作連接器時務必注意潛在風險。
:::

## 常見問題 \{#faqs}

<details>
<summary>

### 如何自訂郵件寄件人名稱？\{#how-to-customize-the-email-sender-name}

</summary>

我們仍持續開發更多連接器。如需更多選項，歡迎在 Discord 告訴我們你的需求，並於 [GitHub](https://github.com/logto-io/logto/issues) 提交功能請求。如需進一步協助，也可 [透過電子郵件聯絡我們](mailto:contact@logto.io)。

對於貢獻者，我們提供易於擴充的連接器開發方式，讓你可依據自身情境 [自訂開發連接器](/logto-oss/develop-your-connector)。歡迎隨時向 Logto 提交 pull request，讓更多社群成員受益。

</details>

<details>
<summary>

### 如何限制 Logto 電子郵件連接器的郵件請求 IP？\{#how-can-i-restrict-ip-addresses-for-email-requests-in-logto-email-connectors}

</summary>

一種解法是使用 Logto HTTP 電子郵件連接器 (HTTP email connector)。

你可在伺服器上實作一個 API endpoint，呼叫相關郵件服務，並透過 Logto [HTTP 電子郵件連接器](/integrations/http-email) 觸發該 API endpoint。如此一來，你可完全控管 API endpoint 的 IP，並將對應 IP 加入郵件服務供應商的白名單設定。

</details>
