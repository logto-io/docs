### 選用：處理使用者權限變更 \{#optional-handle-user-permission-change}

使用者權限隨時可能變動。由於 Logto 會針對角色型存取控制 (RBAC, Role-based Access Control) 發行 JWT，權限更新只會反映在新發行的權杖中，現有的 JWT 不會被修改。

:::info 權限範圍子集規則 (Scope subset rule)
存取權杖 (Access token) 僅能包含原始 OAuth 授權流程中請求的權限範圍 (Scopes)。
即使使用者獲得新權限，後續發行的權杖也只能包含原本請求範圍的子集。
若要存取初始請求未涵蓋的新權限範圍，客戶端必須重新執行授權流程。
:::

#### 權限縮減 (Downscoped permissions) \{#downscoped-permissions}

當使用者失去權限時：

- 新發行的權杖會立即反映縮減後的權限範圍 (Scopes)。
- 現有的 JWT 會保留舊的權限範圍，直到過期為止。
- 你的 API 應始終驗證權限範圍，並依賴短效權杖有效期。

若你需要更快的反應，可自行實作通知機制，提示客戶端刷新權杖。

#### 權限擴增 (Enlarged permissions) \{#enlarged-permissions}

{props.type === "global" && <p>針對全域 API 資源 (Global API resources)，當使用者獲得新權限時，擴增的權限不會透過刷新顯示。客戶端必須重新執行 OAuth 授權流程，才能取得包含新權限範圍的權杖。如果使用者已有 Logto 活躍工作階段，此流程可靜默進行。</p>}

{props.type === "organization" && <p>針對組織權杖 (Organization tokens)，當使用者獲得新權限時，擴增的權限會在下次發行（刷新或權杖請求）時顯示。仍需取得新權杖，但除非新權限範圍超出原始請求集，否則不需完整重新驗證。</p>}

#### 建議事項 \{#recommendations}

- 每次 API 呼叫都要驗證權限範圍 (Scopes)。
- 保持權杖有效期短。
- 若需即時權限變更傳遞，可加上選用通知機制。
