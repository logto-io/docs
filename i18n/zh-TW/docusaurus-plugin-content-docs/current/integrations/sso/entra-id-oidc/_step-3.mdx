Scopes（權限範圍）定義你的應用程式向使用者請求的權限，並控制你的應用程式能從他們的 Microsoft Entra ID 帳戶存取哪些資料。請求 Microsoft Graph 權限需在兩端進行設定：

**在 Microsoft Entra 管理中心：**

1. 前往 **Microsoft Entra ID > App registrations** 並選擇你的應用程式。
2. 進入 **API permissions > Add a permission > Microsoft Graph > Delegated permissions**。
3. 僅選擇你的應用程式所需的權限：
   - OpenID 權限範圍：
     - `openid`（必填）- 登入使用者
     - `profile`（必填）- 檢視使用者基本資料
     - `email`（必填）- 檢視使用者電子郵件地址
     - `offline_access`（選填）- 僅當你在 Logto 連接器中啟用[儲存權杖以持續存取 API](#step-4-store-tokens-to-access-microsoft-apis-optional)並需要取得重新整理權杖以長時間存取 Microsoft Graph API 時才需勾選。
   - API 存取（選填）：新增應用程式所需的其他權限。常見的 Microsoft Graph 權限包含 `Mail.Read`、`Calendars.Read`、`Files.Read` 等。可瀏覽 [Microsoft Graph 權限參考文件](https://docs.microsoft.com/en-us/graph/permissions-reference) 以查詢可用權限。
4. 點擊 **Add permissions** 以確認選擇。
5. 若應用程式某些權限需管理員同意，請點擊 **Grant admin consent for [你的組織]**。

<center>
  <img src="/img/assets/entra_id_oidc_add_api_permissions.webp" alt="新增 Microsoft API 權限" />
</center>

**在 Logto Microsoft Entra ID 連接器：**

1. Logto 會自動包含 `openid`、`profile` 與 `email` 權限範圍以取得基本使用者身分資訊。若僅需基本資訊，可將 `Scopes` 欄位留空。
2. 若計畫儲存權杖以持續存取 API，請在 `Scopes` 欄位加入 `offline_access`。此權限範圍可啟用長效 API 存取所需的重新整理權杖。
3. 若需從 Microsoft Graph 請求更多資料，請在 `Scopes` 欄位（以空格分隔）加入其他權限範圍。例如：`User.Read Mail.Read Calendars.Read`

:::tip

若你的應用程式請求這些權限範圍以存取 Microsoft Graph API 並執行操作，請務必在 Logto Microsoft Entra ID 連接器中啟用 **儲存權杖以持續存取 API**。詳情請見下一節。

:::
