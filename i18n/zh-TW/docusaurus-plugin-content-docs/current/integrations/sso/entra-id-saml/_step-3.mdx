import azureAdDefaultAttributeMappingImage from '@site/docs/integrations/sso/entra-id-saml/assets/azure_ad_default_attribute_mapping.webp';
import azureAdLogtoAttributeMappingImage from '@site/docs/integrations/sso/entra-id-saml/assets/azure_ad_logto_attribute_mapping.webp';

Logto 提供靈活的方式將從身分提供者 (IdP) 返回的使用者屬性映射到 Logto 中的使用者屬性。Logto 預設會從 IdP 同步以下使用者屬性：

- id：使用者的唯一識別符。Logto 將從 SAML 回應中讀取 `nameID` 宣告作為使用者 SSO 身分 id。
- email：使用者的電子郵件地址。Logto 預設會從 SAML 回應中讀取 `email` 宣告作為使用者的主要電子郵件。
- name：使用者的名稱。

你可以在 Azure AD 或 Logto 端管理使用者屬性映射邏輯。

1. 在 Logto 端將 AzureAD 使用者屬性映射到 Logto 使用者屬性。

   訪問 Azure AD SSO 應用程式的 `Attributes & Claims` 部分。

   複製以下屬性名稱（帶有命名空間前綴）並將其粘貼到 Logto 中的對應欄位。

   - `http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress`
   - `http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name`（建議：將此屬性值映射更新為 `user.displayname` 以提升使用者體驗）

<img src={azureAdDefaultAttributeMappingImage} alt="Azure AD 預設屬性映射" />

1. 在 AzureAD 端將 AzureAD 使用者屬性映射到 Logto 使用者屬性。

   訪問 Azure AD SSO 應用程式的 `Attributes & Claims` 部分。

   點擊 `Edit`，並根據 Logto 使用者屬性設定更新 `Additional claims` 欄位：

   - 根據 Logto 使用者屬性設定更新宣告名稱值。
   - 移除命名空間前綴。
   - 點擊 `Save` 繼續。

   最終應達到以下設定：

<img src={azureAdLogtoAttributeMappingImage} alt="Azure AD_Logto 屬性映射" />

你也可以在 Azure AD 端指定其他使用者屬性。Logto 將在使用者的 `sso_identity` 欄位下保留從 IdP 返回的原始使用者屬性記錄。
