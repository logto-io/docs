## åœ¨å¾®ä¿¡é–‹æ”¾å¹³å°å»ºç«‹è¡Œå‹•æ‡‰ç”¨ç¨‹å¼ \{#create-a-mobile-app-in-the-wechat-open-platform}

:::tip

å¦‚æœä½ å·²ç¶“å®Œæˆéƒ¨åˆ†æ­¥é©Ÿï¼Œå¯ä»¥è·³éç›¸é—œç« ç¯€ã€‚

:::

### å»ºç«‹å¸³è™Ÿ \{#create-an-account}

å‰å¾€ https://open.weixin.qq.com/ï¼Œé»æ“Šå³ä¸Šè§’çš„ã€Œè¨»å†Šã€æŒ‰éˆ•ï¼Œå®Œæˆè¨»å†Šæµç¨‹ã€‚

### å»ºç«‹è¡Œå‹•æ‡‰ç”¨ç¨‹å¼ \{#create-a-mobile-app}

ä½¿ç”¨å‰›å‰›å»ºç«‹çš„å¸³è™Ÿç™»å…¥ã€‚åœ¨ã€Œç§»å‹•æ‡‰ç”¨ã€åˆ†é ï¼Œé»æ“Šç¶ è‰²å¤§æŒ‰éˆ•ã€Œå‰µå»ºç§»å‹•æ‡‰ç”¨ã€ã€‚

<img src="/img/assets/app-tabs.png" alt="App tabs" />

æ¥ä¸‹ä¾†å¡«å¯«æ‡‰ç”¨ç¨‹å¼ç”³è«‹è¡¨ä¸­çš„å¿…è¦è³‡è¨Šã€‚

<img src="/img/assets/create-mobile-app.png" alt="Create mobile app" />

#### åŸºæœ¬è³‡è¨Š \{#basic-info}

å¤§éƒ¨åˆ†æ¬„ä½éƒ½å¾ˆç›´è§€ï¼Œé€™è£¡æœ‰å¹¾å€‹å°æç¤ºï¼š

- å¦‚æœä½ åªæ˜¯æƒ³æ¸¬è©¦å¾®ä¿¡ç™»å…¥ï¼Œä¸” App å°šæœªä¸Šæ¶ App Storeï¼Œè«‹åœ¨ã€ŒApp æ˜¯å¦å·²ä¸Šæ¶ã€é¸æ“‡ã€Œå¦ã€ï¼Œå³å¯ç•¥éã€ŒApp ä¸‹è¼‰é€£çµã€ã€‚
- ã€ŒApp é‹ç‡Ÿæµç¨‹åœ–ã€çœ‹èµ·ä¾†æœ‰é»æ£˜æ‰‹ã€‚æ ¹æ“šç¶“é©—ï¼Œä½ éœ€è¦æº–å‚™ä¸€å€‹ç°¡å–®çš„æµç¨‹åœ–å’Œå¹¾å¼µ App æˆªåœ–ï¼Œä»¥æé«˜å¯©æ ¸é€šéçš„æ©Ÿç‡ã€‚

é»æ“Šã€Œä¸‹ä¸€æ­¥ã€ç¹¼çºŒã€‚

#### å¹³å°è³‡è¨Š \{#platform-info}

ä½ å¯ä»¥è¨­å®š iOS å’Œ / æˆ– Android å¹³å°ï¼Œå°‡ Logto èˆ‡å¾®ä¿¡åŸç”Ÿç™»å…¥æ•´åˆã€‚

**iOS æ‡‰ç”¨ç¨‹å¼**

å‹¾é¸ã€ŒiOS æ‡‰ç”¨ã€ï¼ˆiOS åº”ç”¨ï¼‰ï¼Œç„¶å¾Œæ ¹æ“šä½ çš„ App å‹¾é¸ç›®æ¨™è£ç½®é¡å‹ã€‚

<img src="/img/assets/platform.png" alt="App platform" />

å¦‚æœä½ åœ¨ App Store ä¸Šæ¶ç‹€æ…‹é¸æ“‡ã€Œå¦ã€ï¼Œé€™è£¡å¯ä»¥ç•¥éã€ŒAppStore ä¸‹è¼‰åœ°å€ã€ã€‚

å¡«å¯« _Bundle ID_ã€_æ¸¬è©¦ç‰ˆ Bundle ID_ å’Œ _Universal Links_ï¼ˆå…¶å¯¦åªéœ€è¦å¡«ä¸€å€‹é€£çµ ğŸ˜‚ï¼‰ã€‚

:::note

_Bundle ID_ å’Œ _æ¸¬è©¦ç‰ˆ Bundle ID_ å¯ä»¥å¡«ç›¸åŒçš„å€¼ã€‚

:::

:::tip

å¾®ä¿¡è¦æ±‚åŸç”Ÿç™»å…¥å¿…é ˆè¨­ç½® universal linkã€‚å¦‚æœä½ é‚„æ²’è¨­å¥½æˆ–ä¸çŸ¥é“æ€éº¼è¨­ï¼Œè«‹åƒè€ƒ [Apple å®˜æ–¹æ–‡ä»¶](https://developer.apple.com/ios/universal-links/)ã€‚

:::

**Android æ‡‰ç”¨ç¨‹å¼**

å‹¾é¸ã€ŒAndroid æ‡‰ç”¨ã€ï¼ˆAndroid åº”ç”¨ï¼‰ã€‚

<img src="/img/assets/platform-android-app.png" alt="Android app platform" />

å¡«å¯« _æ‡‰ç”¨ç°½å_ï¼ˆåº”ç”¨ç­¾åï¼‰å’Œ _æ‡‰ç”¨åŒ…å_ï¼ˆåº”ç”¨åŒ…åï¼‰ã€‚

:::note

ä½ éœ€è¦ç°½ç½²ä½ çš„ App æ‰èƒ½å–å¾—ç°½åã€‚è©³æƒ…è«‹åƒè€ƒ [ç°½ç½²ä½ çš„ App](https://developer.android.com/studio/publish/app-signing)ã€‚

:::

å®Œæˆç°½ç½²å¾Œï¼Œå¯ä»¥åŸ·è¡Œ `signingReport` ä»»å‹™ä¾†å–å¾—ç°½åã€‚

```bash
./gradlew your-android-project:signingReport
```

å°æ‡‰ build variant å ±å‘Šä¸­çš„ `MD5` å€¼å³ç‚º _æ‡‰ç”¨ç°½å_ï¼ˆåº”ç”¨ç­¾åï¼‰ï¼Œä½†è¨˜å¾—ç§»é™¤æ‰€æœ‰åˆ†è™Ÿä¸¦è½‰ç‚ºå°å¯«ã€‚

ä¾‹å¦‚ï¼š`1A:2B:3C:4D` -> `1a2b3c4d`ã€‚

#### ç­‰å¾…å¯©æ ¸çµæœ \{#waiting-for-the-review-result}

å®Œæˆå¹³å°è³‡è¨Šå¾Œï¼Œé»æ“Šã€Œæäº¤å¯©æ ¸ã€ç¹¼çºŒã€‚é€šå¸¸å¯©æ ¸é€Ÿåº¦å¾ˆå¿«ï¼Œ1-2 å¤©å…§æœƒæœ‰çµæœã€‚

æˆ‘å€‘æ¨æ¸¬æ¯æ¬¡é€å¯©åˆ†é…çš„å¯©æ ¸å“¡æ˜¯éš¨æ©Ÿçš„ï¼Œå› æ­¤æ¨™æº–æœƒæœ‰æµ®å‹•ã€‚ä½ å¯èƒ½ç¬¬ä¸€æ¬¡æœƒè¢«æ‹’çµ•ï¼Œä½†åˆ¥ç°å¿ƒï¼èªªæ˜ä½ çš„ç¾æ³ä¸¦è©¢å•å¯©æ ¸å“¡å¦‚ä½•ä¿®æ”¹å³å¯ã€‚

## åœ¨ä½ çš„ App å•Ÿç”¨å¾®ä¿¡åŸç”Ÿç™»å…¥ \{#enable-wechat-native-sign-in-in-your-app}

### iOS \{#ios}

å‡è¨­ä½ å·²åœ¨ App ä¸­æ•´åˆ [Logto iOS SDK](/quick-starts/swift)ã€‚é€™ç¨®æƒ…æ³ä¸‹æ“ä½œéå¸¸ç°¡å–®ï¼Œç”šè‡³ä¸ç”¨çœ‹å¾®ä¿¡ SDK æ–‡ä»¶ï¼š

**1. åœ¨ Xcode å°ˆæ¡ˆä¸­è¨­å®š universal link èˆ‡ URL scheme**

åœ¨ Xcode å°ˆæ¡ˆ -> Signing & Capabilities åˆ†é ï¼Œæ–°å¢ã€ŒAssociated Domainsã€åŠŸèƒ½ï¼Œä¸¦å¡«å…¥ä½ å…ˆå‰è¨­å®šçš„ universal linkã€‚

<img src="/img/assets/universal-link.png" alt="Universal link" />

æ¥è‘—åˆ°ã€ŒInfoã€åˆ†é ï¼Œæ–°å¢ä¸€å€‹ [è‡ªè¨‚ URL scheme](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app)ï¼Œå…§å®¹ç‚ºå¾®ä¿¡ App IDã€‚

<img src="/img/assets/custom-url-scheme.png" alt="Custom URL scheme" />

æœ€å¾Œæ‰“é–‹ä½ çš„ `Info.plist`ï¼Œåœ¨ `LSApplicationQueriesSchemes` ä¸‹æ–°å¢ `weixinULAPI` å’Œ `weixin`ã€‚

<img src="/img/assets/plist.png" alt="Plist" />

:::note

æˆ‘å€‘çŸ¥é“é€™äº›è¨­å®šçœ‹èµ·ä¾†ä¸å¤ªåˆç†ï¼Œä½†é€™æ˜¯æˆ‘å€‘æ‰¾åˆ°çš„æœ€å°å¯è¡Œè§£ã€‚è©³æƒ…è«‹åƒè€ƒ [ç¥å¥‡çš„å®˜æ–¹æŒ‡å—](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html)ã€‚

:::

**2. å°‡ `LogtoSocialPluginWechat` åŠ å…¥ Xcode å°ˆæ¡ˆ**

æ–°å¢ frameworkï¼š

<img src="/img/assets/add-framework.png" alt="Add framework" />

ä¸¦åœ¨ Build Settings > Linking > Other Linker Flags åŠ å…¥ `-ObjC`ï¼š

<img src="/img/assets/linker-flags.png" alt="Linker flags" />

:::note

æ­¤æ’ä»¶å·²å…§å« WeChat Open SDK 1.9.2ã€‚åŒ¯å…¥æ’ä»¶å¾Œå¯ç›´æ¥ä½¿ç”¨ `import WechatOpenSDK`ã€‚

:::

**3. åœ¨ `LogtoClient` åˆå§‹åŒ–é¸é …ä¸­åŠ å…¥æ’ä»¶**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. æ­£ç¢ºè™•ç† `onOpenURL`**

:::note

`LogtoClient.handle(url:)` æœƒè™•ç†ä½ å•Ÿç”¨çš„æ‰€æœ‰åŸç”Ÿé€£æ¥å™¨ã€‚ä½ åªéœ€å‘¼å«ä¸€æ¬¡å³å¯ã€‚

:::

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// æˆ– AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android \{#android}

å‡è¨­ä½ å·²åœ¨ App ä¸­æ•´åˆ [Logto Android SDK](/quick-starts/android)ã€‚é€™ç¨®æƒ…æ³ä¸‹æ“ä½œéå¸¸ç°¡å–®ï¼Œç”šè‡³ä¸ç”¨çœ‹å¾®ä¿¡ SDK æ–‡ä»¶ï¼š

**1. å°‡ `Wechat Open SDK` åŠ å…¥å°ˆæ¡ˆ**

ç¢ºä¿ä½ çš„ Gradle å°ˆæ¡ˆ repositories ä¸­æœ‰ `mavenCentral()`ï¼š

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

å°‡ Wechat Open SDK åŠ å…¥ dependenciesï¼š

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // æˆ–
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. åœ¨å°ˆæ¡ˆä¸­æ–°å¢ `WXEntryActivity`**

åœ¨ä½ çš„ package root ä¸‹å»ºç«‹ `wxapi` å¥—ä»¶ï¼Œä¸¦åœ¨ `wxapi` å¥—ä»¶ä¸‹æ–°å¢ `WXEntryActivity`ï¼ˆä»¥ `com.sample.app` ç‚ºä¾‹ï¼‰ï¼š

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

`WXEntryActivity` åœ¨å°ˆæ¡ˆä¸­çš„æœ€çµ‚ä½ç½®æ‡‰å¦‚ä¸‹ï¼ˆä»¥ Kotlin ç‚ºä¾‹ï¼‰ï¼š

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. ä¿®æ”¹ `AndroidManifest.xml`**

åœ¨ä½ çš„ `AndroidManifest.xml` ä¸­åŠ å…¥ä¸‹åˆ—å…§å®¹ï¼š

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- è¦æ–°å¢çš„è¡Œ -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```
