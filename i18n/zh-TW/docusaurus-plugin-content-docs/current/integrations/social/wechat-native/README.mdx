---
slug: /integrations/wechat-native
sidebar_label: WeChat (Native)
sidebar_custom_props:
  description: WeChat æ˜¯ä¸€æ¬¾è·¨å¹³å°å³æ™‚é€šè¨Šæ‡‰ç”¨ç¨‹å¼ã€‚
  logoFilename: 'wechat.svg'
---

import addFrameworkImage from '@site/docs/integrations/social/wechat-native/assets/add-framework.png';
import appTabsImage from '@site/docs/integrations/social/wechat-native/assets/app-tabs.png';
import createMobileAppImage from '@site/docs/integrations/social/wechat-native/assets/create-mobile-app.png';
import customUrlSchemeImage from '@site/docs/integrations/social/wechat-native/assets/custom-url-scheme.png';
import linkerFlagsImage from '@site/docs/integrations/social/wechat-native/assets/linker-flags.png';
import platformAndroidAppImage from '@site/docs/integrations/social/wechat-native/assets/platform-android-app.png';
import platformImage from '@site/docs/integrations/social/wechat-native/assets/platform.png';
import plistImage from '@site/docs/integrations/social/wechat-native/assets/plist.png';
import universalLinkImage from '@site/docs/integrations/social/wechat-native/assets/universal-link.png';

import GuideTip from '../../fragments/_guide-tip.mdx';

# è¨­å®š WeChat ç¤¾äº¤ç™»å…¥ (Native)

Logto å®˜æ–¹æä¾›çš„ WeChat ç¤¾äº¤ç™»å…¥é€£æ¥å™¨ï¼Œç”¨æ–¼åŸç”Ÿæ‡‰ç”¨ç¨‹å¼ï¼ˆiOS å’Œ Androidï¼‰ã€‚

<GuideTip />

## é–‹å§‹ä½¿ç”¨ \{#get-started}

å¦‚æœä½ ä¸ç­è§£é€£æ¥å™¨çš„æ¦‚å¿µæˆ–ä¸çŸ¥é“å¦‚ä½•å°‡æ­¤é€£æ¥å™¨æ–°å¢åˆ°ä½ çš„ç™»å…¥é«”é©—ä¸­ï¼Œè«‹åƒé–± [Logto æ•™å­¸](/connectors/social-connectors)ã€‚

åœ¨åŸç”Ÿæ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œä½ ç„¡æ³•ä½¿ç”¨ç¶²é ä½œç‚º WeChat çš„ç™»å…¥æ–¹æ³•ï¼šéœ€è¦å°èˆªåˆ° WeChat æ‡‰ç”¨ç¨‹å¼ï¼Œä¸¦ä¸”éœ€è¦ä½¿ç”¨å…¶ SDKã€‚

æˆ‘å€‘çŸ¥é“é€™è½èµ·ä¾†æœ‰é»å¯æ€•ï¼Œä½†åˆ¥æ“”å¿ƒã€‚æˆ‘å€‘å°‡åœ¨æœ¬æ•™å­¸ä¸­è¼•é¬†è™•ç†ã€‚

## åœ¨ WeChat é–‹æ”¾å¹³å°å‰µå»ºç§»å‹•æ‡‰ç”¨ç¨‹å¼ \{#create-a-mobile-app-in-the-wechat-open-platform}

:::tip

å¦‚æœä½ å·²ç¶“å®ŒæˆæŸäº›éƒ¨åˆ†ï¼Œå¯ä»¥è·³éã€‚

:::

### å‰µå»ºå¸³æˆ¶ \{#create-an-account}

æ‰“é–‹ https://open.weixin.qq.com/ï¼Œé»æ“Šå³ä¸Šè§’çš„ã€Œè¨»å†Šã€æŒ‰éˆ•ï¼Œç„¶å¾Œå®Œæˆè¨»å†Šæµç¨‹ã€‚

### å‰µå»ºç§»å‹•æ‡‰ç”¨ç¨‹å¼ \{#create-a-mobile-app}

ä½¿ç”¨ä½ å‰›å‰µå»ºçš„å¸³æˆ¶ç™»å…¥ã€‚åœ¨ã€Œç§»å‹•æ‡‰ç”¨ã€(ç§»åŠ¨åº”ç”¨) æ¨™ç±¤ä¸­ï¼Œé»æ“Šå¤§ç¶ è‰²æŒ‰éˆ•ã€Œå‰µå»ºç§»å‹•æ‡‰ç”¨ã€(åˆ›å»ºç§»åŠ¨åº”ç”¨)ã€‚

<img src={appTabsImage} alt="App tabs" />

è®“æˆ‘å€‘åœ¨æ‡‰ç”¨ç¨‹å¼è¡¨å–®ä¸­å¡«å¯«æ‰€éœ€è³‡è¨Šã€‚

<img src={createMobileAppImage} alt="Create mobile app" />

#### åŸºæœ¬è³‡è¨Š \{#basic-info}

å¤§å¤šæ•¸éƒ½ç›¸ç•¶ç°¡å–®ï¼Œæˆ‘å€‘é€™è£¡æœ‰å¹¾å€‹æç¤ºï¼š

- å¦‚æœä½ åªæ˜¯æƒ³æ¸¬è©¦ WeChat ç™»å…¥ä¸”æ‡‰ç”¨ç¨‹å¼ä¸åœ¨ App Store ä¸Šï¼Œåœ¨ã€Œæ‡‰ç”¨ç¨‹å¼æ˜¯å¦ä¸Šæ¶ã€éƒ¨åˆ†é¸æ“‡ã€Œå¦ã€ä»¥è·³éã€Œæ‡‰ç”¨ç¨‹å¼ä¸‹è¼‰é€£çµã€ã€‚
- ã€Œæ‡‰ç”¨æ“ä½œæµç¨‹åœ–ã€çœ‹èµ·ä¾†æœ‰é»æ£˜æ‰‹ã€‚æ ¹æ“šæˆ‘å€‘çš„ç¶“é©—ï¼Œä½ éœ€è¦æº–å‚™ä¸€å€‹ç°¡å–®çš„æµç¨‹åœ–å’Œå¹¾å€‹æ‡‰ç”¨ç¨‹å¼æˆªåœ–ï¼Œä»¥æé«˜é€šéå¯©æ ¸çš„å¯èƒ½æ€§ã€‚

é»æ“Šã€Œä¸‹ä¸€æ­¥ã€ç¹¼çºŒã€‚

#### å¹³å°è³‡è¨Š \{#platform-info}

ä½ å¯ä»¥é…ç½® iOS å’Œ Android å¹³å°ä¹‹ä¸€æˆ–å…©è€…ï¼Œä»¥å°‡ Logto èˆ‡ WeChat åŸç”Ÿç™»å…¥æ•´åˆã€‚

**iOS æ‡‰ç”¨ç¨‹å¼**

å‹¾é¸ã€ŒiOS æ‡‰ç”¨ç¨‹å¼ã€(iOS åº”ç”¨)ï¼Œç„¶å¾Œæ ¹æ“šä½ çš„æ‡‰ç”¨ç¨‹å¼å‹¾é¸ç›®æ¨™è¨­å‚™é¡å‹ã€‚

<img src={platformImage} alt="App platform" />

å¦‚æœä½ é¸æ“‡äº†ã€Œå¦ã€ä½œç‚º App Store ä¸Šæ¶ç‹€æ…‹ï¼Œä½ å¯ä»¥è·³éå¡«å¯«ã€ŒAppStore ä¸‹è¼‰åœ°å€ã€ã€‚

å¡«å¯« _Bundle ID_ã€_æ¸¬è©¦ç‰ˆ Bundle ID_ å’Œ _Universal Links_ï¼ˆå¯¦éš›ä¸Šåªéœ€è¦ä¸€å€‹é€£çµ ğŸ˜‚ï¼‰ã€‚

:::note

_Bundle ID_ å’Œ _æ¸¬è©¦ç‰ˆ Bundle ID_ å¯ä»¥æ˜¯ç›¸åŒçš„å€¼ã€‚

:::

:::tip

WeChat è¦æ±‚ä½¿ç”¨ universal link é€²è¡ŒåŸç”Ÿç™»å…¥ã€‚å¦‚æœä½ å°šæœªè¨­ç½®æˆ–ä¸çŸ¥é“å®ƒï¼Œè«‹åƒé–± [Apple å®˜æ–¹æ–‡æª”](https://developer.apple.com/ios/universal-links/)ã€‚

:::

**Android æ‡‰ç”¨ç¨‹å¼**

å‹¾é¸ã€ŒAndroid æ‡‰ç”¨ç¨‹å¼ã€(Android åº”ç”¨)ã€‚

<img src={platformAndroidAppImage} alt="Android app platform" />

å¡«å¯« _æ‡‰ç”¨ç°½å_ (Application Signing Signature) å’Œ _æ‡‰ç”¨åŒ…å_ (Application Package Name)ã€‚

:::note

ä½ éœ€è¦ç°½ç½²ä½ çš„æ‡‰ç”¨ç¨‹å¼ä»¥ç²å–ç°½åã€‚æ›´å¤šè³‡è¨Šè«‹åƒé–± [ç°½ç½²ä½ çš„æ‡‰ç”¨ç¨‹å¼](https://developer.android.com/studio/publish/app-signing)ã€‚

:::

å®Œæˆç°½ç½²å¾Œï¼Œä½ å¯ä»¥åŸ·è¡Œ `signingReport` ä»»å‹™ä»¥ç²å–ç°½åã€‚

```bash
./gradlew your-android-project:signingReport
```

ç›¸æ‡‰æ§‹å»ºè®Šé«”å ±å‘Šçš„ `MD5` å€¼å°‡æ˜¯ _æ‡‰ç”¨ç°½å_ (Application Signing Signature)ï¼Œä½†è¨˜å¾—ç§»é™¤æ‰€æœ‰åˆ†è™Ÿä¸¦å°‡å…¶è½‰ç‚ºå°å¯«ã€‚

ä¾‹å¦‚ï¼š`1A:2B:3C:4D` -> `1a2b3c4d`ã€‚

#### ç­‰å¾…å¯©æ ¸çµæœ \{#waiting-for-the-review-result}

å®Œæˆå¹³å°è³‡è¨Šå¾Œï¼Œé»æ“Šã€Œæäº¤å¯©æ ¸ã€ç¹¼çºŒã€‚é€šå¸¸ï¼Œå¯©æ ¸é€Ÿåº¦å¾ˆå¿«ï¼Œæœƒåœ¨ 1-2 å¤©å…§çµæŸã€‚

æˆ‘å€‘æ‡·ç–‘æ¯æ¬¡æäº¤çš„å¯©æ ¸å“¡æ˜¯éš¨æ©Ÿåˆ†é…çš„ï¼Œå› ç‚ºæ¨™æº–æ˜¯æµ®å‹•çš„ã€‚ä½ å¯èƒ½ç¬¬ä¸€æ¬¡è¢«æ‹’çµ•ï¼Œä½†ä¸è¦æ”¾æ£„ï¼èªªæ˜ä½ çš„ç¾ç‹€ä¸¦è©¢å•å¯©æ ¸å“¡å¦‚ä½•ä¿®æ”¹ã€‚

## åœ¨ä½ çš„æ‡‰ç”¨ç¨‹å¼ä¸­å•Ÿç”¨ WeChat åŸç”Ÿç™»å…¥ \{#enable-wechat-native-sign-in-in-your-app}

### iOS \{#ios}

æˆ‘å€‘å‡è¨­ä½ å·²åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­æ•´åˆ [Logto iOS SDK](/quick-starts/swift)ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œäº‹æƒ…ç›¸ç•¶ç°¡å–®ï¼Œä½ ç”šè‡³ä¸éœ€è¦é–±è®€ WeChat SDK æ–‡æª”ï¼š

**1. åœ¨ä½ çš„ Xcode å°ˆæ¡ˆä¸­é…ç½® universal link å’Œ URL scheme**

åœ¨ Xcode å°ˆæ¡ˆ -> ç°½ç½²èˆ‡èƒ½åŠ›æ¨™ç±¤ä¸­ï¼Œæ–°å¢ã€Œé—œè¯åŸŸã€èƒ½åŠ›å’Œä½ ä¹‹å‰é…ç½®çš„ universal linkã€‚

<img src={universalLinkImage} alt="Universal link" />

ç„¶å¾Œé€²å…¥ã€Œè³‡è¨Šã€æ¨™ç±¤ï¼Œæ–°å¢ä¸€å€‹ [è‡ªè¨‚ URL scheme](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) èˆ‡ WeChat App IDã€‚

<img src={customUrlSchemeImage} alt="Custom URL scheme" />

æœ€å¾Œæ‰“é–‹ä½ çš„ `Info.plist`ï¼Œåœ¨ `LSApplicationQueriesSchemes` ä¸‹æ–°å¢ `weixinULAPI` å’Œ `weixin`ã€‚

<img src={plistImage} alt="Plist" />

:::note

æˆ‘å€‘çŸ¥é“é€™äº›æ“ä½œä¸æ˜¯å¾ˆåˆç†ï¼Œä½†é€™æ˜¯æˆ‘å€‘æ‰¾åˆ°çš„æœ€ä½å¯è¡Œè§£æ±ºæ–¹æ¡ˆã€‚æ›´å¤šè³‡è¨Šè«‹åƒé–± [ç¥å¥‡çš„å®˜æ–¹æŒ‡å—](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html)ã€‚

:::

**2. å°‡ `LogtoSocialPluginWechat` æ–°å¢åˆ°ä½ çš„ Xcode å°ˆæ¡ˆ**

æ–°å¢æ¡†æ¶ï¼š

<img src={addFrameworkImage} alt="Add framework" />

ä¸¦å°‡ `-ObjC` æ–°å¢åˆ°ä½ çš„ Build Settings > Linking > Other Linker Flagsï¼š

<img src={linkerFlagsImage} alt="Linker flags" />

:::note

è©²æ’ä»¶åŒ…å« WeChat Open SDK 1.9.2ã€‚åŒ¯å…¥æ’ä»¶å¾Œï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ `import WechatOpenSDK`ã€‚

:::

**3. å°‡æ’ä»¶æ–°å¢åˆ°ä½ çš„ `LogtoClient` åˆå§‹åŒ–é¸é …**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. æ­£ç¢ºè™•ç† `onOpenURL`**

:::note

å‡½æ•¸ `LogtoClient.handle(url:)` å°‡è™•ç†ä½ å•Ÿç”¨çš„æ‰€æœ‰åŸç”Ÿé€£æ¥å™¨ã€‚ä½ åªéœ€èª¿ç”¨ä¸€æ¬¡ã€‚

:::

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// æˆ– AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android \{#android}

æˆ‘å€‘å‡è¨­ä½ å·²åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­æ•´åˆ [Logto Android SDK](/quick-starts/android)ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œäº‹æƒ…ç›¸ç•¶ç°¡å–®ï¼Œä½ ç”šè‡³ä¸éœ€è¦é–±è®€ WeChat SDK æ–‡æª”ï¼š

**1. å°‡ `Wechat Open SDK` æ–°å¢åˆ°ä½ çš„å°ˆæ¡ˆ**

ç¢ºä¿ `mavenCentral()` å­˜å„²åº«åœ¨ä½ çš„ Gradle å°ˆæ¡ˆå­˜å„²åº«ä¸­ï¼š

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

å°‡ Wechat Open SDK æ–°å¢åˆ°ä½ çš„ä¾è³´é …ï¼š

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // æˆ–
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. å°‡ `WXEntryActivity` å¼•å…¥åˆ°ä½ çš„å°ˆæ¡ˆ**

åœ¨ä½ çš„åŒ…æ ¹ç›®éŒ„ä¸‹å‰µå»ºä¸€å€‹ `wxapi` åŒ…ï¼Œä¸¦åœ¨ `wxapi` åŒ…ä¸­æ–°å¢ `WXEntryActivity`ï¼ˆä»¥ `com.sample.app` ç‚ºä¾‹ï¼‰ï¼š

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

å°ˆæ¡ˆä¸­ `WXEntryActivity` çš„æœ€çµ‚ä½ç½®æ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼ˆä»¥ Kotlin ç‚ºä¾‹ï¼‰ï¼š

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. ä¿®æ”¹ `AndroidManifest.xml`**

å°‡ä»¥ä¸‹è¡Œæ–°å¢åˆ°ä½ çš„ `AndroidManifest.xml`ï¼š

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- è¦æ–°å¢çš„è¡Œ -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```

## æ¸¬è©¦ WeChat åŸç”Ÿé€£æ¥å™¨ \{#test-wechat-native-connector}

å°±æ˜¯é€™æ¨£ã€‚åˆ¥å¿˜äº†åœ¨ [ç™»å…¥é«”é©—ä¸­å•Ÿç”¨ç¤¾äº¤é€£æ¥å™¨](/connectors/social-connectors/#enable-social-sign-in)ã€‚

ä¸€æ—¦å•Ÿç”¨äº† WeChat åŸç”Ÿé€£æ¥å™¨ï¼Œä½ å¯ä»¥æ§‹å»ºä¸¦é‹è¡Œä½ çš„æ‡‰ç”¨ç¨‹å¼ä»¥æŸ¥çœ‹å…¶æ˜¯å¦æ­£å¸¸é‹ä½œã€‚

:::caution

WeChat æ²’æœ‰é‡å°æœªå®‰è£ WeChat æ‡‰ç”¨ç¨‹å¼çš„è¨­å‚™çš„è¨ˆåŠƒã€‚å¦‚æœæ˜¯é€™ç¨®æƒ…æ³ï¼ŒLogto å°‡åœ¨ç™»å…¥æ™‚éš±è—æ­¤é€£æ¥å™¨ï¼ˆé€™æ˜¯ [å®˜æ–¹é–‹ç™¼æŒ‡å—](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/WeChat_Login/Development_Guide.html) æ¨è–¦çš„æ–¹å¼ï¼‰ã€‚

:::
