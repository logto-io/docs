## 步驟 1：在 GitHub 建立 OAuth 應用程式 \{#step-1-create-an-oauth-app-on-github}

在你能將 GitHub 作為驗證 (Authentication) 提供者之前，必須先在 GitHub 上建立 OAuth 應用程式以取得 OAuth 2.0 憑證。

1. 前往 [GitHub](https://github.com/) 並使用你的帳號登入，或如有需要註冊新帳號。
2. 導航至 [Settings > Developer settings > OAuth apps](https://github.com/settings/developers)。
3. 點擊 **New OAuth App** 註冊新應用程式：
   - **Application name**：輸入你的應用程式描述性名稱。
   - **Homepage URL**：輸入你的應用程式首頁網址。
   - **Authorization callback URL**：從 Logto GitHub 連接器複製 **Callback URI** 並貼到此處。使用者以 GitHub 登入後，將被導向此處並帶有 Logto 用於完成驗證 (Authentication) 的授權碼。
   - **Application description**：（選填）新增應用程式簡短描述。
4. 點擊 **Register application** 以建立 OAuth 應用程式。

:::note
建議不要勾選 **Enable Device Flow**，因為使用者若在行動裝置上以 GitHub 登入，需在 GitHub 行動應用程式中確認首次登入動作。許多 GitHub 使用者並未在手機安裝 GitHub 行動應用程式，這可能會阻斷登入流程。僅當你預期終端使用者會透過 GitHub 行動應用程式確認登入流程時才啟用此選項。詳情請參閱 [device flow](https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps#device-flow)。

更多 GitHub OAuth 應用程式設定細節，請參閱 [Creating an OAuth App](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/creating-an-oauth-app)。
:::

## 步驟 2：設定你的 Logto 連接器 \{#step-2-configure-your-logto-connector}

在 GitHub 建立 OAuth 應用程式後，你會被導向詳細頁面，可在此複製 Client ID 並產生 Client secret。

1. 從 GitHub OAuth 應用程式複製 **Client ID**，貼到 Logto 的 `clientId` 欄位。
2. 在 GitHub 點擊 **Generate a new client secret** 產生新密鑰，然後複製並貼到 Logto 的 `clientSecret` 欄位。
3. 在 Logto 點擊 **Save and Done**，將你的身分系統與 GitHub 連接。

:::warning
請妥善保管你的 Client secret，切勿在前端程式碼中暴露。GitHub 的 client secret 若遺失無法找回，必須重新產生。
:::

## 步驟 3：設定權限範圍（Scopes，選填） \{#step-3-configure-scopes-optional}

權限範圍（Scopes）定義你的應用程式向使用者請求的權限，並控制可從其 GitHub 帳號存取哪些資料。

在 Logto 的 `Scopes` 欄位中可向 GitHub 請求額外權限。根據需求選擇下列其中一種方式：

### 選項 1：不需額外 API 權限範圍 \{#option-1-no-extra-api-scopes-needed}

- 保持 Logto GitHub 連接器的 `Scopes` 欄位為空。
- 預設會請求 `read:user` 權限範圍，確保 Logto 能正確取得基本使用者資訊（如電子郵件、名稱、大頭貼）。

### 選項 2：登入時請求額外權限範圍 \{#option-2-request-additional-scopes-at-sign-in}

- 瀏覽所有 [GitHub OAuth 應用程式可用權限範圍](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/scopes-for-oauth-apps)，僅新增應用程式所需的權限範圍。
- 在 **Scopes** 欄位輸入所有所需權限範圍，以空格分隔。
- 此處列出的權限範圍會覆蓋預設值，因此務必包含驗證 (Authentication) 權限範圍：`read:user`。
- 常見額外權限範圍包含：
  - `repo`：完全控制私人儲存庫
  - `public_repo`：存取公開儲存庫
  - `user:email`：存取使用者電子郵件地址
  - `notifications`：存取通知
- 請確保所有權限範圍拼寫正確且有效。錯誤或不支援的權限範圍會導致 GitHub 回傳「Invalid scope」錯誤。

### 選項 3：後續動態請求權限範圍 \{#option-3-request-incremental-scopes-later}

- 使用者登入後，可隨時透過重新啟動聯邦社交授權流程並更新使用者儲存的權杖組，動態請求額外權限範圍。
- 這些額外權限範圍無需填寫在 Logto GitHub 連接器的 `Scopes` 欄位，可透過 Logto 的 Social Verification API 實現。

依照上述步驟，Logto GitHub 連接器將只請求應用程式所需的權限，不多也不少。

:::tip
若你的應用程式請求這些權限範圍以存取 GitHub API 並執行操作，請務必在 Logto GitHub 連接器啟用 **Store tokens for persistent API access**。詳情請見下一節。
:::

## 步驟 4：一般設定 \{#step-4-general-settings}

以下為不會阻礙與 GitHub 連線，但可能影響終端使用者驗證 (Authentication) 體驗的一般設定。

### 同步個人檔案資訊 \{#sync-profile-information}

在 GitHub 連接器中，你可以設定同步個人檔案資訊（如使用者名稱與大頭貼）的政策。可選擇：

- **僅註冊時同步**：使用者首次登入時僅同步一次個人資訊。
- **每次登入時皆同步**：每次使用者登入時都會更新個人資訊。

### 儲存權杖以存取 GitHub API（選填） \{#store-tokens-to-access-github-apis-optional}

若你希望在取得使用者授權後（無論是社交登入或帳號連結）存取 GitHub API 並執行操作，Logto 需取得特定 API 權限範圍並儲存權杖。

1. 依照上述說明新增所需權限範圍。
2. 在 Logto GitHub 連接器啟用 **Store tokens for persistent API access**。Logto 會將 GitHub 存取權杖安全儲存在 Secret Vault。

:::note
當你如本教學所述使用 GitHub **OAuth App** 時，無法從 GitHub 取得重新整理權杖（Refresh token），因為其存取權杖（Access token）除非使用者手動撤銷，否則不會過期。因此，無需在 `Scopes` 欄位新增 `offline_access`，否則可能導致錯誤。

若你希望存取權杖會過期或使用重新整理權杖，請考慮改用 **GitHub App** 整合。瞭解 [GitHub App 與 OAuth App 的差異](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/differences-between-github-apps-and-oauth-apps)。
:::

## 步驟 5：測試你的整合（選填） \{#step-5-test-your-integration-optional}

在正式上線前，請測試你的 GitHub 整合：

1. 在 Logto 開發租戶中使用此連接器。
2. 驗證使用者能以 GitHub 登入。
3. 檢查請求的權限範圍是否正確。
4. 若有儲存權杖，請測試 API 呼叫。

GitHub OAuth 應用程式可立即與任何 GitHub 使用者帳號配合使用——不需像其他平台那樣申請測試使用者或應用程式審核。
