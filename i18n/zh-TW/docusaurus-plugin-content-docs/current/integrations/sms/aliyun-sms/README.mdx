---
slug: /integrations/aliyun-sms
sidebar_label: 阿里雲簡訊
sidebar_custom_props:
  description: 阿里雲為線上企業提供雲端運算服務。
  logoFilename: 'aliyun.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# 使用阿里雲簡訊服務設定簡訊驗證 (Set up SMS verification with Aliyun Short Message Service)

官方 Logto 連接器，支援阿里雲簡訊服務。

<GuideTip />

## 開始使用 \{#get-started}

阿里雲是亞洲主要的雲端服務供應商，提供多種雲端服務，包括簡訊（SMS, Short Message Service）。阿里雲簡訊連接器是 Logto 團隊提供的外掛，可呼叫阿里雲簡訊服務，讓 Logto 終端使用者能透過簡訊驗證碼註冊與登入 Logto 帳號。

## 在阿里雲簡訊主控台設定簡訊服務 \{#set-up-a-short-message-service-in-aliyun-sms-console}

### 建立阿里雲帳號 \{#create-an-aliyun-account}

前往 [阿里雲官網](https://cn.aliyun.com/)，若尚未註冊請先建立阿里雲帳號。

### 啟用並設定阿里雲簡訊服務 \{#enable-and-configure-aliyun-short-message-service}

1. 使用你的阿里雲帳號登入 [阿里雲官網](https://cn.aliyun.com/)，並進入 [簡訊服務主控台頁面](https://www.aliyun.com/product/sms)。
2. 點擊簡訊服務頁面左上角的「免費開通」按鈕，開始設定流程。
3. 閱讀並同意「簡訊服務開通條款」，點擊「開通服務」繼續。
4. 此時你已進入 [簡訊服務主控台頁面](https://dysms.console.aliyun.com/overview)，根據你的需求，從側邊欄選擇「國內消息」或「國際 / 港澳台消息」。
5. 依照指引新增簽名與範本，並提供審核所需的資料或資訊。
   - 申請簽名時，請記得將「適用場景」選為「驗證碼」；申請範本時，「模板類型」也選擇「驗證碼」，因為我們僅支援發送驗證碼相關的簡訊內容。
   - 範本內容中，請使用 `{{code}}` 作為數位驗證碼的佔位符。
6. 提交簡訊簽名與範本申請後，需等待生效。此時可回到 [簡訊服務主控台頁面](https://dysms.console.aliyun.com/overview) 發送測試簡訊。若簽名與範本已生效可直接測試，若尚未生效，阿里雲也提供測試範本。
   - 發送測試簡訊前，可能需先儲值小額金額。
   - 發送測試簡訊前，也可能需先綁定測試手機號碼。詳情請參閱 [簡訊服務主控台頁面](https://dysms.console.aliyun.com/overview) 側邊欄的「快速學習」分頁。

## 編寫連接器 JSON \{#compose-the-connector-json}

1. 在 [簡訊服務主控台頁面](https://dysms.console.aliyun.com/overview) 右上角滑鼠移至頭像，進入「AccessKey 管理」，點擊「創建 AccessKey」。安全驗證後會取得一組「AccessKey ID」與「AccessKey Secret」，請妥善保存。
2. 回到剛剛造訪的「國內消息」或「國際 / 港澳台消息」分頁，可輕鬆找到「簽名名稱」與「模板 CODE」。
   - 若要使用僅供測試的簽名與範本，請改至「快速學習」分頁，在「簽名與範本（僅供測試）」下方可找到。
3. 填寫阿里雲簡訊連接器設定：
   - `accessKeyId` 與 `accessKeySecret` 欄位填入步驟 1 取得的金鑰。
   - `signName` 欄位填入步驟 2 提到的「簽名名稱」，所有範本將共用此簽名。
   - 你可以為不同情境新增多個簡訊連接器範本。以下為新增單一範本的範例：
     - `templateCode` 欄位填入步驟 2 的「模板 CODE」，用以控制簡訊內容。
     - `usageType` 欄位根據不同用途填入 `Register`、`SignIn`、`ForgotPassword` 或 `Generic`。(`usageType` 為 Logto 屬性，用於識別用途。) 若要啟用完整使用者流程，需同時設定 `Register`、`SignIn`、`ForgotPassword` 與 `Generic` 的範本。
4. 設定「嚴格手機區碼檢查」：
   - 若需發送簡訊至海外手機號碼（非中國大陸地區，如美國、香港等），請啟用此功能。啟用後，連接器會假設所有手機號碼皆包含有效區碼（如 +1、+852），以判斷是否屬於中國大陸。
   - **注意**：若現有使用者的手機號碼未包含區碼，啟用此功能可能影響其登入流程。僅於需要發送海外簡訊時啟用。

### 測試阿里雲簡訊連接器 \{#test-aliyun-sms-connector}

你可以輸入手機號碼並點擊「發送」，在「儲存並完成」前測試設定是否可用。

就是這麼簡單。別忘了 <MainSiteUrl href="/connectors/sms-connectors/#enable-phone-number-sign-up-or-sign-in">在登入體驗中啟用連接器</MainSiteUrl>。

### 設定類型 \{#config-types}

| 名稱            | 類型       |
| --------------- | ---------- |
| accessKeyId     | string     |
| accessKeySecret | string     |
| signName        | string     |
| templates       | Template[] |

| 範本屬性     | 類型        | 列舉值                                               |
| ------------ | ----------- | ---------------------------------------------------- |
| templateCode | string      | N/A                                                  |
| usageType    | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |

## 參考資料 \{#references}

<Url href="https://dysms.console.aliyun.com/quickstart">阿里雲簡訊 - 快速入門</Url>
