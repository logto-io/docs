## 在阿里雲 DirectMail 控制台設定電子郵件服務 \{#set-up-an-email-service-in-aliyun-directmail-console}

### 建立阿里雲帳號 \{#create-an-aliyun-account}

前往 [阿里雲](https://aliyun.com/)，如果你還沒有帳號，請先建立阿里雲帳號。

### 啟用並設定阿里雲 Direct Mail \{#enable-and-configure-aliyun-direct-mail}

進入 [DM 服務控制台頁面](https://www.aliyun.com/product/directmail) 並登入。點擊頁面左上角的「申請開通」按鈕以啟用 Direct Mail 服務，然後開始設定流程。

從 [DM 管理控制台頁面](https://dm.console.aliyun.com/) 開始，你應該：

1. 從側邊欄進入「發信域名」，依照指示新增「新建域名」。
2. 分別自訂「發信地址」與「郵件標籤」。

完成設定後，有兩種方式可以進行測試：

- 前往 [DirectMail 概覽頁面](https://dm.console.aliyun.com/)，在頁面底部找到「操作引導」，點擊「發送郵件」。你會看到各種不同的測試方法。
- 按照側邊欄「發送郵件」->「郵件任務」的路徑建立測試任務。

## 編寫連接器 JSON \{#compose-the-connector-json}

1. 從 [DM 管理控制台頁面](https://dm.console.aliyun.com/)，將滑鼠移到右上角頭像，進入「AccessKey 管理」，點擊「創建 AccessKey」。完成安全驗證後，你會獲得一組「AccessKey ID」與「AccessKey Secret」，請妥善保存。
2. 回到剛才在 [DM 管理控制台頁面](https://dm.console.aliyun.com/) 造訪過的「發信地址」或「郵件標籤」分頁，你可以輕鬆找到 _發信地址_ 或 _郵件標籤_。
3. 填寫阿里雲 DM 連接器設定：
   - 將第 1 步取得的 access key 對應填入 `accessKeyId` 與 `accessKeySecret` 欄位。
   - 將第 2 步找到的「發信地址」與「郵件標籤」分別填入 `accountName` 與 `fromAlias` 欄位。所有範本將共用這個簽名名稱。（`fromAlias` 可留空，為選填。）
   - 你可以針對不同情境新增多個 DM 連接器範本。以下為新增單一範本的範例：
     - 填寫 `subject` 欄位，作為寄送郵件的標題。
     - 在 `content` 欄位填入任意字串內容。請記得保留 `{{code}}` 佔位符以插入隨機驗證碼。
     - `usageType` 欄位請依不同用途填入 `Register`、`SignIn`、`ForgotPassword` 或 `Generic`。(`usageType` 是 Logto 屬性，用於識別正確的使用情境。) 若要啟用完整使用者流程，需同時提供 `Register`、`SignIn`、`ForgotPassword` 與 `Generic` 的範本。

### 測試阿里雲 DM 連接器 \{#test-aliyun-dm-connector}

你可以輸入一個電子郵件地址並點擊「發送」，以確認設定是否可用，再點選「儲存並完成」。

就是這麼簡單。別忘了 <MainSiteUrl href="/connectors/email-connectors/#enable-email-sign-up-or-sign-in">在登入體驗中啟用連接器</MainSiteUrl>。

### 設定類型 \{#config-types}

| 名稱            | 類型           |
| --------------- | -------------- |
| accessKeyId     | string         |
| accessKeySecret | string         |
| accountName     | string         |
| fromAlias       | string（選填） |
| templates       | Template[]     |

| 範本屬性  | 類型        | 列舉值                                               |
| --------- | ----------- | ---------------------------------------------------- |
| subject   | string      | N/A                                                  |
| content   | string      | N/A                                                  |
| usageType | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |
