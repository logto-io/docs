---
sidebar_position: 4
---

# Token de acceso personal

Los tokens de acceso personal (PATs) proporcionan una forma segura para que los usuarios otorguen un [token de acceso (Access token)](https://auth.wiki/access-token) sin usar sus credenciales ni el inicio de sesión interactivo. Esto es útil para CI/CD, scripts o aplicaciones que necesitan acceder a recursos de forma programática.

## Gestión de tokens de acceso personal \{#managing-personal-access-tokens}

### Usando la Consola \{#using-console}

Puedes gestionar los tokens de acceso personal en la página de Detalles del usuario de <CloudLink to="/users">Consola > Gestión de usuarios</CloudLink>. En la tarjeta "Autenticación (Authentication)", puedes ver la lista de tokens de acceso personal y crear nuevos.

### Usando Management API \{#using-management-api}

Después de configurar la [Management API](/integrate-logto/interact-with-management-api/), puedes usar los [endpoints de la API](https://openapi.logto.io/operation/operation-listuserpersonalaccesstokens) para crear, listar y eliminar tokens de acceso personal.

## Usar PATs para otorgar tokens de acceso \{#use-pats-to-grant-access-tokens}

Después de crear un PAT, puedes usarlo para otorgar tokens de acceso a tu aplicación utilizando el endpoint de intercambio de tokens.

:::tip Equivalencia de flujo de tokens

Los tokens de acceso obtenidos usando PATs funcionan **idénticamente** a los tokens obtenidos a través del flujo estándar de `refresh_token`. Esto significa:

- **Contexto de organización**: Los tokens obtenidos por PAT admiten los mismos permisos y alcances de organización que los flujos de refresh token
- **Flujo de autorización**: Puedes usar los tokens de acceso intercambiados por PAT para [permisos de organización](/authorization/organization-permissions) y [recursos de API a nivel de organización](/authorization/organization-level-api-resources)
- **Validación de tokens**: Se aplica la misma lógica de validación: solo difiere el tipo de concesión inicial

Si trabajas con organizaciones, los patrones de acceso y permisos son los mismos independientemente de si usas PAT o refresh tokens.

:::

### Solicitud \{#request}

La aplicación realiza una [solicitud de intercambio de tokens](https://auth.wiki/authorization-code-flow#token-exchange-request) al [endpoint de token](/integrate-logto/application-data-structure#token-endpoint) del tenant con un tipo de concesión especial usando el método HTTP POST. Los siguientes parámetros se incluyen en el cuerpo de la solicitud HTTP usando el formato `application/x-www-form-urlencoded`.

1. `client_id`: OBLIGATORIO. El ID de cliente de la aplicación.
2. `grant_type`: OBLIGATORIO. El valor de este parámetro debe ser `urn:ietf:params:oauth:grant-type:token-exchange` e indica que se está realizando un intercambio de tokens.
3. `resource`: OPCIONAL. El indicador de recurso, igual que en otras solicitudes de token.
4. `scope`: OPCIONAL. Los alcances solicitados, igual que en otras solicitudes de token.
5. `subject_token`: OBLIGATORIO. El PAT del usuario.
6. `subject_token_type`: OBLIGATORIO. El tipo de token de seguridad proporcionado en el parámetro `subject_token`. El valor de este parámetro debe ser `urn:logto:token-type:personal_access_token`.

### Respuesta \{#response}

Si la solicitud de intercambio de tokens es exitosa, el endpoint de token del tenant devuelve un token de acceso que representa la identidad del usuario. La respuesta incluye los siguientes parámetros en el cuerpo de la respuesta HTTP usando el formato `application/json`.

1. `access_token`: OBLIGATORIO. El token de acceso del usuario, que es igual que en otras solicitudes de token como `authorization_code` o `refresh_token`.
2. `issued_token_type`: OBLIGATORIO. El tipo de token emitido. El valor de este parámetro debe ser `urn:ietf:params:oauth:token-type:access_token`.
3. `token_type`: OBLIGATORIO. El tipo de token. El valor de este parámetro debe ser `Bearer`.
4. `expires_in`: OBLIGATORIO. El tiempo de vida en segundos del token de acceso.
5. `scope`: OPCIONAL. Los alcances del token de acceso.

### Ejemplo de intercambio de tokens \{#example-token-exchange}

Para aplicaciones web tradicionales con secreto de aplicación:

```
POST /oidc/token HTTP/1.1
Host: tenant.logto.app
Content-Type: application/x-www-form-urlencoded
Authorization: Basic <base64(app-id:app-secret)>

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange
&resource=http://my-api.com
&scope=read
&subject_token=pat_W51arOqe7nynW75nWhvYogyc
&subject_token_type=urn%3Alogto%3Atoken-type%3Apersonal_access_token
```

Para aplicaciones de una sola página o nativas sin secreto de aplicación:

```
POST /oidc/token HTTP/1.1
Host: tenant.logto.app
Content-Type: application/x-www-form-urlencoded

client_id=your-app-id
&grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange
&resource=http://my-api.com
&scope=read
&subject_token=pat_W51arOqe7nynW75nWhvYogyc
&subject_token_type=urn%3Alogto%3Atoken-type%3Apersonal_access_token
```

```
HTTP/1.1 200 OK
Content-Type: application/json

{
  "access_token": "eyJhbGci...zg",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "read"
}
```

Luego, si decodificas el token de acceso con el [decodificador JWT](https://logto.io/jwt-decoder), obtendrás el siguiente ejemplo de payload de token de acceso:

```json
{
  "jti": "VovNyqJ5_tuYac89eTbpF",
  "sub": "rkxl1ops7gs1",
  "iat": 1756908403,
  "exp": 1756912003,
  "scope": "read",
  "client_id": "your-app-id",
  "iss": "https://tenant-id.logto.app/oidc",
  "aud": "http://my-api.com"
}
```

## Recursos relacionados \{#related-resources}

<Url href="https://blog.logto.io/api-authentication-with-personal-access-token">
  ¿Qué es un token de acceso personal? ¿Cuándo debo usar tokens de acceso personal?
</Url>

<Url href="https://blog.logto.io/pat-and-api-keys">
  Tokens de acceso personal, autenticación máquina a máquina y definición de API Keys y sus
  escenarios en el mundo real
</Url>
