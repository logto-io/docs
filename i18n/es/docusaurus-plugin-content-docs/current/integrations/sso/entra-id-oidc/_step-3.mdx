Los alcances (Scopes) definen los permisos que tu aplicación solicita a los usuarios y controlan a qué datos puede acceder tu aplicación desde sus cuentas de Microsoft Entra ID. Solicitar permisos de Microsoft Graph requiere configuración en ambos lados:

**En el centro de administración de Microsoft Entra:**

1. Navega a **Microsoft Entra ID > App registrations** y selecciona tu aplicación.
2. Ve a **API permissions > Add a permission > Microsoft Graph > Delegated permissions**.
3. Selecciona solo los permisos que tu aplicación requiere:
   - Permisos de OpenID:
     - `openid` (Obligatorio) - Iniciar sesión de los usuarios
     - `profile` (Obligatorio) - Ver el perfil básico de los usuarios
     - `email` (Obligatorio) - Ver la dirección de correo electrónico de los usuarios
     - `offline_access` (Opcional) - Solo es necesario si habilitas [Almacenar tokens para acceso persistente a la API](#step-4-store-tokens-to-access-microsoft-apis-optional) en el conector de Logto y necesitas obtener tokens de actualización para acceso prolongado a las API de Microsoft Graph.
   - Acceso a la API (Opcional): Agrega cualquier permiso adicional que tu aplicación necesite. Los permisos comunes de Microsoft Graph incluyen `Mail.Read`, `Calendars.Read`, `Files.Read`, etc. Consulta la [referencia de permisos de Microsoft Graph](https://docs.microsoft.com/en-us/graph/permissions-reference) para encontrar los permisos disponibles.
4. Haz clic en **Add permissions** para confirmar la selección.
5. Si tu aplicación requiere consentimiento de administrador para ciertos permisos, haz clic en **Grant admin consent for [Your Organization]**.

<center>
  <img
    src="/img/assets/entra_id_oidc_add_api_permissions.webp"
    alt="Agregar permisos de API de Microsoft"
  />
</center>

**En el conector de Microsoft Entra ID de Logto:**

1. Logto incluye automáticamente los alcances `openid`, `profile` y `email` para recuperar la información básica de identidad del usuario. Puedes dejar el campo `Scopes` en blanco si solo necesitas información básica del usuario.
2. Agrega `offline_access` al campo `Scopes` si planeas almacenar tokens para acceso persistente a la API. Este alcance habilita los tokens de actualización para acceso prolongado a la API.
3. Agrega alcances adicionales (separados por espacios) en el campo `Scopes` para solicitar más datos de Microsoft Graph. Usa los nombres estándar de los alcances, por ejemplo: `User.Read Mail.Read Calendars.Read`

:::tip

Si tu aplicación solicita estos alcances para acceder a la API de Microsoft Graph y realizar acciones, asegúrate de habilitar **Almacenar tokens para acceso persistente a la API** en el conector de Microsoft Entra ID de Logto. Consulta la siguiente sección para más detalles.

:::
