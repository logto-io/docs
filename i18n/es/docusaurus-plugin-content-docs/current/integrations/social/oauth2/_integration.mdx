## Crea tu aplicación OAuth \{#create-your-oauth-app}

Cuando abras esta página, asumimos que ya sabes a qué proveedor de identidad social deseas conectarte. Lo primero que debes hacer es confirmar que el proveedor de identidad admite el protocolo OAuth, lo cual es un requisito previo para configurar un conector válido. Luego, sigue las instrucciones del proveedor de identidad para registrar y crear la aplicación relevante para la autorización OAuth.

## Configura tu conector \{#configure-your-connector}

ÚNICAMENTE admitimos el tipo de concesión "Authorization Code" por motivos de seguridad y se adapta perfectamente al escenario de Logto.

`clientId` y `clientSecret` se pueden encontrar en la página de detalles de tu aplicación OAuth.

_clientId_: El client ID es un identificador único que identifica la aplicación cliente durante el registro con el servidor de autorización. Este ID es utilizado por el servidor de autorización para verificar la identidad de la aplicación cliente y asociar cualquier token de acceso autorizado con esa aplicación cliente específica.

_clientSecret_: El client secret es una clave confidencial que se emite a la aplicación cliente por el servidor de autorización durante el registro. La aplicación cliente utiliza esta clave secreta para autenticarse ante el servidor de autorización al solicitar tokens de acceso. El client secret se considera información confidencial y debe mantenerse seguro en todo momento.

_tokenEndpointAuthMethod_: El método de autenticación del endpoint de token es utilizado por la aplicación cliente para autenticarse ante el servidor de autorización al solicitar tokens de acceso. Para descubrir los métodos admitidos, consulta el campo `token_endpoint_auth_methods_supported` disponible en el endpoint de descubrimiento OpenID Connect del proveedor de servicios OAuth 2.0, o consulta la documentación relevante proporcionada por el proveedor de servicios OAuth 2.0.

_clientSecretJwtSigningAlgorithm (Opcional)_: Solo es necesario cuando `tokenEndpointAuthMethod` es `client_secret_jwt`. El algoritmo de firma JWT del client secret es utilizado por la aplicación cliente para firmar el JWT que se envía al servidor de autorización durante la solicitud de token.

_scope_: El parámetro scope se utiliza para especificar el conjunto de recursos y permisos a los que la aplicación cliente solicita acceso. El parámetro scope suele definirse como una lista de valores separados por espacios que representan permisos específicos. Por ejemplo, un valor de scope "read write" podría indicar que la aplicación cliente solicita acceso de lectura y escritura a los datos de un usuario.

Se espera que encuentres `authorizationEndpoint`, `tokenEndpoint` y `userInfoEndpoint` en la documentación del proveedor social.

_authenticationEndpoint_: Este endpoint se utiliza para iniciar el proceso de autenticación. El proceso de autenticación normalmente implica que el usuario inicie sesión y otorgue autorización para que la aplicación cliente acceda a sus recursos.

_tokenEndpoint_: Este endpoint es utilizado por la aplicación cliente para obtener un token de acceso que puede usarse para acceder a los recursos solicitados. La aplicación cliente normalmente envía una solicitud al endpoint de token con un tipo de concesión y un código de autorización para recibir un token de acceso.

_userInfoEndpoint_: Este endpoint es utilizado por la aplicación cliente para obtener información adicional sobre el usuario, como su nombre completo, dirección de correo electrónico o foto de perfil. El endpoint de información del usuario normalmente se accede después de que la aplicación cliente ha obtenido un token de acceso del endpoint de token.

Logto también proporciona un campo `profileMap` que los usuarios pueden personalizar para mapear los perfiles de los proveedores sociales, que usualmente no son estándar. Las claves son los nombres de los campos estándar del perfil de usuario de Logto y los valores correspondientes deben ser los nombres de los campos del perfil social. En la etapa actual, Logto solo considera 'id', 'name', 'avatar', 'email' y 'phone' del perfil social; solo 'id' es obligatorio y los demás son campos opcionales.

`responseType` y `grantType` SOLO pueden ser valores FIJOS con el tipo de concesión authorization code, por lo que los hacemos opcionales y los valores predeterminados se completarán automáticamente.

Por ejemplo, puedes encontrar la [respuesta del perfil de usuario de Google](https://developers.google.com/identity/openid-connect/openid-connect#an-id-tokens-payload) y, por lo tanto, su `profileMap` debería ser así:

```json
{
  "id": "sub",
  "avatar": "picture"
}
```

:::note

Proporcionamos una clave OPCIONAL `customConfig` para colocar tus parámetros personalizados.
Cada proveedor de identidad social puede tener su propia variante sobre el protocolo estándar OAuth. Si tu proveedor de identidad social deseado se adhiere estrictamente al protocolo estándar OAuth, entonces no necesitas preocuparte por `customConfig`.

:::

## Tipos de configuración \{#config-types}

| Nombre                    | Tipo                    | Requerido |
| ------------------------- | ----------------------- | --------- |
| authorizationEndpoint     | string                  | true      |
| userInfoEndpoint          | string                  | true      |
| clientId                  | string                  | true      |
| clientSecret              | string                  | true      |
| tokenEndpointResponseType | enum                    | false     |
| responseType              | string                  | false     |
| grantType                 | string                  | false     |
| tokenEndpoint             | string                  | false     |
| scope                     | string                  | false     |
| customConfig              | Record\<string, string> | false     |
| profileMap                | ProfileMap              | false     |

| Campos de ProfileMap | Tipo   | Requerido | Valor por defecto |
| -------------------- | ------ | --------- | ----------------- |
| id                   | string | false     | id                |
| name                 | string | false     | name              |
| avatar               | string | false     | avatar            |
| email                | string | false     | email             |
| phone                | string | false     | phone             |

## Configuraciones generales \{#general-settings}

Aquí tienes algunas configuraciones generales que no bloquearán la conexión con tu proveedor de identidad, pero pueden afectar la experiencia de autenticación del usuario final.

### Nombre y logo del botón social \{#social-button-name-and-logo}

Si deseas mostrar un botón social en tu página de inicio de sesión, puedes establecer el **nombre** y el **logo** (modo oscuro y modo claro) del proveedor de identidad social. Esto ayudará a los usuarios a reconocer la opción de inicio de sesión social.

### Nombre del proveedor de identidad \{#identity-provider-name}

Cada conector social tiene un nombre único de Proveedor de Identidad (IdP) para diferenciar las identidades de los usuarios. Mientras que los conectores comunes usan un nombre de IdP fijo, los conectores personalizados requieren un valor único. Aprende más sobre [nombres de IdP](https://docs.logto.io/connectors/connector-data-structure#target-identity-provider-name) para más detalles.

### Sincronizar información del perfil \{#sync-profile-information}

En el conector OAuth, puedes establecer la política para sincronizar la información del perfil, como nombres de usuario y avatares. Elige entre:

- **Solo sincronizar al registrarse**: La información del perfil se obtiene una vez cuando el usuario inicia sesión por primera vez.
- **Siempre sincronizar al iniciar sesión**: La información del perfil se actualiza cada vez que el usuario inicia sesión.

### Almacenar tokens para acceder a APIs de terceros (Opcional) \{#store-tokens-to-access-third-party-apis-optional}

Si deseas acceder a las APIs del Proveedor de Identidad y realizar acciones con la autorización del usuario (ya sea mediante inicio de sesión social o vinculación de cuentas), Logto necesita obtener alcances de API específicos y almacenar los tokens.

1. Añade los alcances requeridos en el campo **scope** siguiendo las instrucciones anteriores.
2. Habilita **Almacenar tokens para acceso persistente a la API** en el conector OAuth de Logto. Logto almacenará de forma segura los tokens de acceso en el Secret Vault.
3. Para proveedores de identidad OAuth/OIDC **estándar**, el alcance `offline_access` debe incluirse para obtener un token de actualización, evitando solicitudes repetidas de consentimiento del usuario.

:::warning
Mantén tu client secret seguro y nunca lo expongas en el código del lado del cliente. Si se ve comprometido, genera uno nuevo inmediatamente en la configuración de la aplicación de tu proveedor de identidad.
:::

## Utiliza el conector OAuth \{#utilize-the-oauth-connector}

Una vez que hayas creado un conector OAuth y lo hayas conectado a tu proveedor de identidad, puedes incorporarlo en tus flujos de usuario final. Elige las opciones que se adapten a tus necesidades:

### Habilitar el botón de inicio de sesión social \{#enable-social-sign-in-button}

1. En Logto Console, ve a <CloudLink to="/sign-in-experience/sign-up-and-sign-in">Experiencia de inicio de sesión > Registro e inicio de sesión</CloudLink>.
2. Añade el conector OAuth en la sección **Inicio de sesión social** para permitir que los usuarios se autentiquen con tu proveedor de identidad.

Aprende más sobre la [experiencia de inicio de sesión social](https://docs.logto.io/end-user-flows/sign-up-and-sign-in/social-sign-in).

### Vincular o desvincular una cuenta social \{#link-or-unlink-a-social-account}

Utiliza la Account API para construir un Centro de Cuenta personalizado en tu aplicación que permita a los usuarios autenticados vincular o desvincular sus cuentas sociales. [Sigue el tutorial de Account API](https://docs.logto.io/end-user-flows/account-settings/by-account-api#link-a-new-social-connection)

:::tip
Está permitido habilitar el conector OAuth solo para vinculación de cuentas y acceso a la API, sin habilitarlo para inicio de sesión social.
:::

### Acceder a APIs del proveedor de identidad y realizar acciones \{#access-identity-provider-apis-and-perform-actions}

Tu aplicación puede recuperar tokens de acceso almacenados desde el Secret Vault para llamar a las APIs de tu proveedor de identidad y automatizar tareas de backend. Las capacidades específicas dependen de tu proveedor de identidad y los alcances que hayas solicitado. Consulta la guía sobre cómo recuperar tokens almacenados para acceso a la API.

## Gestionar la identidad social del usuario \{#manage-user-s-social-identity}

Después de que un usuario vincule su cuenta social, los administradores pueden gestionar esa conexión en Logto Console:

1. Navega a <CloudLink to="/users">Logto console > Gestión de usuarios</CloudLink> y abre el perfil del usuario.
2. En **Conexiones sociales**, localiza el elemento del proveedor de identidad y haz clic en **Gestionar**.
3. En esta página, los administradores pueden gestionar la conexión social del usuario, ver toda la información del perfil otorgada y sincronizada desde su cuenta social, y comprobar el estado del token de acceso.

:::note
Algunas respuestas de token de acceso del Proveedor de Identidad no incluyen la información específica de los alcances, por lo que Logto no puede mostrar directamente la lista de permisos otorgados por el usuario. Sin embargo, siempre que el usuario haya consentido los alcances solicitados durante la autorización, tu aplicación tendrá los permisos correspondientes al acceder a la API OAuth.
:::
