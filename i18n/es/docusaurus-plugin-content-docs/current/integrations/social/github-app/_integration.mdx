## Paso 1: Crea una GitHub App \{#step-1-create-a-github-app}

Antes de que puedas usar GitHub como proveedor de autenticación, debes crear una GitHub App en GitHub para obtener credenciales de OAuth 2.0.

1. Ve a [GitHub](https://github.com/) e inicia sesión con tu cuenta, o crea una nueva si es necesario.
2. Navega a [Settings > Developer settings > GitHub Apps](https://github.com/settings/apps).
3. Haz clic en **New GitHub App** para registrar una nueva aplicación:
   - **GitHub App name**: Ingresa un nombre único para tu aplicación. El nombre no puede tener más de 34 caracteres y debe ser único en GitHub.
   - **Homepage URL**: Ingresa la URL de la página principal de tu aplicación.
   - **Callback URL**: Copia el **Callback URI** de tu conector de GitHub en Logto y pégalo aquí. Puedes añadir varias URLs de callback si es necesario. Después de que los usuarios inicien sesión con GitHub, serán redirigidos aquí con un código de autorización que Logto utiliza para completar la autenticación.
   - **Expire user authorization tokens**: Mantén esto **marcado** (recomendado). Esto habilita la expiración de tokens y tokens de actualización para mayor seguridad.
   - **Request user authorization (OAuth) during installation**: Opcionalmente marca esto para solicitar a los usuarios que autoricen tu aplicación durante la instalación.
   - **Webhook**: Desmarca **Active** si no necesitas eventos de webhook. Para casos de uso solo de autenticación, normalmente los webhooks no son necesarios.
4. En **Permissions**, configura los permisos que necesita tu aplicación (consulta el Paso 2 a continuación para más detalles).
5. En **Where can this GitHub App be installed?**, selecciona **Any account** si quieres que usuarios de cualquier cuenta de GitHub puedan usar tu aplicación para autenticación.
6. Haz clic en **Create GitHub App** para crear la GitHub App.

:::note
A diferencia de las OAuth Apps, las GitHub Apps usan permisos granulares en lugar de alcances amplios. Configuras los permisos en el panel de GitHub durante la creación de la aplicación, y los usuarios otorgan acceso a repositorios específicos durante la autorización.

Para más detalles sobre cómo configurar GitHub Apps, consulta [Registering a GitHub App](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/registering-a-github-app).
:::

## Paso 2: Configura los permisos en GitHub \{#step-2-configure-permissions-in-github}

Las GitHub Apps usan permisos granulares en lugar de alcances de OAuth. Debes configurar los permisos **en el panel de GitHub** al crear o editar tu GitHub App. Estos permisos determinan a qué datos puede acceder tu aplicación.

### Comprendiendo los permisos de GitHub App \{#understanding-github-app-permissions}

Los permisos se dividen en tres tipos:

- **Permisos de repositorio**: Acceso a recursos a nivel de repositorio (código, issues, pull requests, etc.)
- **Permisos de organización**: Acceso a recursos a nivel de organización (miembros, equipos, proyectos, etc.)
- **Permisos de cuenta**: Acceso a datos de la cuenta de usuario (correo electrónico, perfil, seguidores, etc.)

Para cada permiso, puedes seleccionar:

- **No access**: La aplicación no puede acceder a este recurso
- **Read-only**: La aplicación puede leer pero no modificar este recurso
- **Read & write**: La aplicación puede leer y modificar este recurso

### Permisos recomendados para autenticación \{#recommended-permissions-for-authentication}

Para la funcionalidad básica de "Iniciar sesión con GitHub", configura estos permisos mínimos de **cuenta**:

| Permiso             | Nivel de acceso | Propósito                                                      |
| ------------------- | --------------- | -------------------------------------------------------------- |
| **Email addresses** | Read-only       | Obtener el correo electrónico del usuario para crear la cuenta |

:::tip
Las GitHub Apps tienen acceso implícito para leer la información pública del perfil cuando actúan en nombre de un usuario. No necesitas solicitar explícitamente permiso para datos básicos del perfil como nombre de usuario, avatar y URL del perfil público.
:::

### Permisos adicionales para acceso a la API \{#additional-permissions-for-api-access}

Si tu aplicación necesita acceder a las APIs de GitHub más allá de la autenticación, añade los permisos correspondientes en el panel de GitHub. Aquí algunos ejemplos comunes:

| Tipo de permiso  | Permiso       | Nivel de acceso          | Caso de uso                                                             |
| ---------------- | ------------- | ------------------------ | ----------------------------------------------------------------------- |
| **Repository**   | Contents      | Read-only / Read & write | Acceder a archivos y código del repositorio                             |
| **Repository**   | Issues        | Read & write             | Crear y gestionar issues                                                |
| **Repository**   | Pull requests | Read & write             | Crear y gestionar pull requests                                         |
| **Repository**   | Metadata      | Read-only                | Acceder a metadatos del repositorio (requerido para muchas operaciones) |
| **Organization** | Members       | Read-only                | Listar miembros de la organización                                      |
| **Account**      | Followers     | Read-only                | Acceder a los seguidores y seguidos del usuario                         |

Esta no es una lista exhaustiva — las GitHub Apps admiten muchos más permisos granulares. Consulta [Permissions required for GitHub Apps](https://docs.github.com/en/rest/overview/permissions-required-for-github-apps) para la lista completa.

:::tip[Diferencia clave respecto a las OAuth Apps]
A diferencia de las OAuth Apps donde configuras los alcances en el conector de Logto, los permisos de las GitHub Apps se gestionan completamente en el panel de GitHub. Puedes dejar el campo `Scope` vacío en tu conector de GitHub en Logto — no es necesario porque las GitHub Apps no usan los alcances tradicionales de OAuth.

Simplemente configura los permisos que necesitas en GitHub, y los usuarios serán solicitados para otorgar acceso durante la autorización.
:::

## Paso 3: Configura tu conector de Logto \{#step-3-configure-your-logto-connector}

Después de crear la GitHub App, serás redirigido a la página de configuración donde podrás obtener las credenciales.

1. En la página de configuración de tu GitHub App, copia el **Client ID** y pégalo en el campo `clientId` en Logto.
2. En **Client secrets**, haz clic en **Generate a new client secret**. Copia el secreto generado y pégalo en el campo `clientSecret` en Logto.
3. Haz clic en **Save and Done** en Logto para conectar tu sistema de identidad con GitHub.

:::warning
Mantén tu Client secret seguro y nunca lo expongas en código del lado del cliente. Los client secrets de GitHub no se pueden recuperar si se pierden; tendrás que generar uno nuevo.
:::

:::note
El Client ID de una GitHub App es diferente del App ID. Asegúrate de usar el Client ID (mostrado como "Client ID" en la página de configuración), no el App ID.
:::

## Paso 4: Configuración general \{#step-4-general-settings}

Aquí tienes algunas configuraciones generales que no bloquearán la conexión con GitHub pero pueden afectar la experiencia de autenticación del usuario final.

### Sincronizar información del perfil \{#sync-profile-information}

En el conector de GitHub, puedes configurar cómo se sincroniza la información del perfil desde la información del usuario de GitHub al perfil de usuario de Logto, incluyendo `name`, `avatar` y `email`. Elige entre las siguientes opciones:

- **Solo sincronizar al registrarse**: La información del perfil se obtiene una vez cuando el usuario inicia sesión por primera vez.
- **Siempre sincronizar al iniciar sesión**: La información del perfil se actualiza cada vez que el usuario inicia sesión.

### Almacenar tokens para acceder a las APIs de GitHub (Opcional) \{#store-tokens-to-access-github-apis-optional}

Si deseas acceder a las APIs de GitHub y realizar acciones con la autorización del usuario (ya sea mediante inicio de sesión social o vinculación de cuentas), habilita el almacenamiento de tokens en Logto:

1. Configura los permisos requeridos en la configuración de tu GitHub App (Paso 2).
2. Habilita **Store tokens for persistent API access** en el conector de GitHub en Logto. Logto almacenará de forma segura tanto el token de acceso como el token de actualización en el Secret Vault.

:::note
Dado que las GitHub Apps siempre emiten tokens de actualización, Logto almacena ambos tokens automáticamente. El token de acceso expira después de 8 horas, pero Logto puede usar el token de actualización para obtener nuevos tokens de acceso, asegurando acceso ininterrumpido a la API por hasta 6 meses.
:::

## Paso 5: Prueba tu integración (Opcional) \{#step-5-test-your-integration-optional}

Antes de salir a producción, prueba la integración de tu GitHub App:

1. Usa el conector en un tenant de desarrollo de Logto.
2. Verifica que los usuarios puedan iniciar sesión con GitHub.
3. Comprueba que a los usuarios se les soliciten los permisos correctos durante la autorización.
4. Si habilitaste el almacenamiento de tokens, verifica que los tokens de acceso (y tokens de actualización) se almacenen correctamente.
5. Prueba llamadas a la API usando los tokens almacenados para asegurar que los permisos funcionen como se espera.

Las GitHub Apps funcionan con cualquier cuenta de usuario de GitHub de inmediato; no es necesario crear usuarios de prueba ni aprobar la aplicación como en otras plataformas. Sin embargo, si tu aplicación se instala en una organización, los propietarios de la organización pueden necesitar aprobar la instalación.
