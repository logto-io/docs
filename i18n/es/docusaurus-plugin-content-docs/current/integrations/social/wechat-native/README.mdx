---
slug: /integrations/wechat-native
sidebar_label: WeChat (Native)
sidebar_custom_props:
  description: WeChat es una aplicaci贸n de mensajer铆a instant谩nea multiplataforma.
  logoFilename: 'wechat.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# Configura el inicio de sesi贸n social con WeChat (Native)

El conector oficial de Logto para el inicio de sesi贸n social de WeChat en aplicaciones nativas (iOS y Android).

<GuideTip />

## Comenzar

Si no conoces el concepto del conector o no sabes c贸mo agregar este conector a tu experiencia de inicio de sesi贸n, consulta el [tutorial de Logto](/connectors/social-connectors).

En aplicaciones nativas, no puedes usar la web como m茅todo de inicio de sesi贸n de WeChat: se requiere la navegaci贸n a la aplicaci贸n de WeChat, y tambi茅n requiere usar su SDK.

Sabemos que suena aterrador, pero no te preocupes. Lo manejaremos f谩cilmente en este tutorial.

## Crea una aplicaci贸n m贸vil en la Plataforma Abierta de WeChat

>  **Consejo**
>
> Puedes omitir algunas secciones si ya las has completado.

### Crear una cuenta

Abre https://open.weixin.qq.com/, haz clic en el bot贸n "Sign Up" en la esquina superior derecha, luego completa el proceso de registro.

### Crear una aplicaci贸n m贸vil

Inicia sesi贸n con la cuenta que acabas de crear. En la pesta帽a "Aplicaci贸n M贸vil" (绉诲ㄥ), haz clic en el gran bot贸n verde "Crear una aplicaci贸n m贸vil" (寤虹Щㄥ).

![Pesta帽as de la aplicaci贸n](./assets/app-tabs.png)

Completemos la informaci贸n requerida en el formulario de solicitud.

![Crear una aplicaci贸n m贸vil](./assets/create-mobile-app.png)

#### Informaci贸n b谩sica

La mayor铆a son bastante sencillas, y aqu铆 tenemos varios consejos:

- Si solo deseas probar el inicio de sesi贸n de WeChat y la aplicaci贸n no est谩 en la App Store, en la secci贸n "App is available", elige "No" para omitir el "Enlace de descarga de la aplicaci贸n".
- El "Diagrama de flujo de operaci贸n de la aplicaci贸n" parece complicado. Seg煤n nuestra experiencia, necesitas preparar un diagrama de flujo simple y varias capturas de pantalla de la aplicaci贸n para mejorar la posibilidad de pasar la revisi贸n.

Haz clic en "Siguiente paso" para continuar.

#### Informaci贸n de la plataforma

Puedes configurar una o ambas plataformas iOS y Android para integrar Logto con el inicio de sesi贸n nativo de WeChat.

**Aplicaci贸n iOS**

Marca "Aplicaci贸n iOS" (iOS 搴), luego marca el tipo de dispositivo objetivo de tu aplicaci贸n seg煤n corresponda.

![Plataforma de la aplicaci贸n](./assets/platform.png)

Si elegiste "No" para la disponibilidad en la App Store, puedes omitir completar la "Direcci贸n de descarga de AppStore" aqu铆.

Completa _Bundle ID_, _Test version Bundle ID_ y _Universal Links_ (en realidad, solo se necesita un enlace ).

> 癸 **Nota**
>
> _Bundle ID_ y _Test version Bundle ID_ pueden tener el mismo valor.

>  **Consejo**
>
> WeChat requiere un enlace universal para el inicio de sesi贸n nativo. Si no lo has configurado o no lo conoces, consulta el [documento oficial de Apple](https://developer.apple.com/ios/universal-links/).

**Aplicaci贸n Android**

Marca "Aplicaci贸n Android" (Android 搴).

![Plataforma de la aplicaci贸n Android](./assets/platform-android-app.png)

Completa _Firma de la aplicaci贸n_ (搴ㄧ惧) y _Nombre del paquete de la aplicaci贸n_ (搴ㄥ).

> 癸 **Nota**
>
> Necesitas firmar tu aplicaci贸n para obtener una firma. Consulta [Firmar tu aplicaci贸n](https://developer.android.com/studio/publish/app-signing) para m谩s informaci贸n.

Despu茅s de terminar de firmar, puedes ejecutar la tarea `signingReport` para obtener la firma de la aplicaci贸n.

```bash
./gradlew your-android-project:signingReport
```

El valor `MD5` del informe de la variante de compilaci贸n correspondiente ser谩 la _Firma de la aplicaci贸n_ (搴ㄧ惧), pero recuerda eliminar todos los puntos y comas del valor y ponerlo en min煤sculas.

Por ejemplo, `1A:2B:3C:4D` -> `1a2b3c4d`.

#### Esperando el resultado de la revisi贸n

Despu茅s de completar la informaci贸n de la plataforma, haz clic en "Enviar revisi贸n" para continuar. Por lo general, la revisi贸n es r谩pida y termina en 1-2 d铆as.

Sospechamos que el revisor se asigna aleatoriamente en cada env铆o, ya que el est谩ndar es variable. Puede que te rechacen la primera vez, 隆pero no te rindas! Explica tu situaci贸n actual y pregunta al revisor c贸mo modificarla.

## Habilitar el inicio de sesi贸n nativo de WeChat en tu aplicaci贸n

### iOS

Asumimos que has integrado [Logto iOS SDK](/quick-starts/swift) en tu aplicaci贸n. En este caso, las cosas son bastante simples, y ni siquiera necesitas leer el documento del SDK de WeChat:

**1. Configura el enlace universal y el esquema de URL en tu proyecto Xcode**

En el proyecto Xcode -> pesta帽a Signing & Capabilities, agrega la capacidad "Associated Domains" y el enlace universal que configuraste antes.

![Enlace universal](./assets/universal-link.png)

Luego ve a la pesta帽a "Info", agrega un [esquema de URL personalizado](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) con el ID de la aplicaci贸n de WeChat.

![Esquema de URL personalizado](./assets/custom-url-scheme.png)

Finalmente, abre tu `Info.plist`, agrega `weixinULAPI` y `weixin` bajo `LSApplicationQueriesSchemes`.

![Plist](./assets/plist.png)

> う **Nota**
>
> Sabemos que estas acciones no son muy razonables, pero esta es la soluci贸n m铆nima viable que encontramos. Consulta la [gu铆a oficial m谩gica](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html) para m谩s informaci贸n.

**2. Agrega `LogtoSocialPluginWechat` a tu proyecto Xcode**

Agrega el framework:

![Agregar framework](./assets/add-framework.png)

Y agrega `-ObjC` a tus Build Settings > Linking > Other Linker Flags:

![Flags del linker](./assets/linker-flags.png)

> 癸 **Nota**
>
> El plugin incluye WeChat Open SDK 1.9.2. Puedes usar directamente `import WechatOpenSDK` una vez importado el plugin.

**3. Agrega el plugin a tus opciones de inicializaci贸n de `LogtoClient`**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. Maneja `onOpenURL` adecuadamente**

> 癸 **Nota**
>
> La funci贸n `LogtoClient.handle(url:)` manejar谩 todos los conectores nativos que hayas habilitado. Solo necesitas llamarla una vez.

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// o AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android

Asumimos que has integrado [Logto Android SDK](/quick-starts/android) en tu aplicaci贸n. En este caso, las cosas son bastante simples, y ni siquiera necesitas leer el documento del SDK de WeChat:

**1. Agrega `Wechat Open SDK` a tu proyecto**

Aseg煤rate de que el repositorio `mavenCentral()` est茅 en los repositorios de tu proyecto Gradle:

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

Agrega el Wechat Open SDK a tus dependencias:

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // o
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. Introduce `WXEntryActivity` a tu proyecto**

Crea un paquete `wxapi` bajo tu ra铆z de paquete y agrega el `WXEntryActivity` en el paquete `wxapi` (Toma `com.sample.app` como ejemplo):

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

La posici贸n final del `WXEntryActivity` bajo el proyecto deber铆a verse as铆 (Toma Kotlin como ejemplo):

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. Modifica el `AndroidManifest.xml`**

Agrega la siguiente l铆nea a tu `AndroidManifest.xml`:

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- l铆nea a agregar -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```

## Probar el conector nativo de WeChat

Eso es todo. No olvides [Habilitar el conector social en la experiencia de inicio de sesi贸n](/connectors/social-connectors/#enable-social-sign-in).

Una vez que el conector nativo de WeChat est茅 habilitado, puedes compilar y ejecutar tu aplicaci贸n para ver si funciona.

> 锔 **Precauci贸n**
>
> WeChat no tiene un plan para aquellos dispositivos sin la aplicaci贸n de WeChat instalada. Logto ocultar谩 este conector durante el inicio de sesi贸n si es as铆 (lo cual es la forma recomendada seg煤n la [gu铆a de desarrollo oficial](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/WeChat_Login/Development_Guide.html)).
