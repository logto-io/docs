---
slug: /integrations/wechat-native
sidebar_label: WeChat (Nativo)
sidebar_custom_props:
  description: WeChat es una aplicaci贸n de mensajer铆a instant谩nea multiplataforma.
  logoFilename: 'wechat.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# Configura el inicio de sesi贸n social con WeChat (Nativo)

El conector oficial de Logto para el inicio de sesi贸n social de WeChat en aplicaciones nativas (iOS y Android).

<GuideTip />

## Comenzar \{#get-started}

Si no conoces el concepto del conector o no sabes c贸mo agregar este conector a tu experiencia de inicio de sesi贸n, consulta el [tutorial de Logto](/connectors/social-connectors).

En aplicaciones nativas, no puedes usar la web como m茅todo de inicio de sesi贸n de WeChat: se requiere la navegaci贸n a la aplicaci贸n de WeChat, y tambi茅n requiere usar su SDK.

Sabemos que suena aterrador, pero no te preocupes. Lo manejaremos f谩cilmente en este tutorial.

## Crea una aplicaci贸n m贸vil en la Plataforma Abierta de WeChat \{#create-a-mobile-app-in-the-wechat-open-platform}

:::tip

Puedes omitir algunas secciones si ya las has completado.

:::

### Crear una cuenta \{#create-an-account}

Abre https://open.weixin.qq.com/, haz clic en el bot贸n "Sign Up" en la esquina superior derecha, luego completa el proceso de registro.

### Crear una aplicaci贸n m贸vil \{#create-a-mobile-app}

Inicia sesi贸n con la cuenta que acabas de crear. En la pesta帽a "Mobile Application" (绉诲ㄥ), haz clic en el gran bot贸n verde "Create a mobile app" (寤虹Щㄥ).

<img src="/img/assets/app-tabs.png" alt="Pesta帽as de la aplicaci贸n" />

Vamos a completar la informaci贸n requerida en el formulario de aplicaci贸n.

<img src="/img/assets/create-mobile-app.png" alt="Crear aplicaci贸n m贸vil" />

#### Informaci贸n b谩sica \{#basic-info}

La mayor铆a de ellas son bastante sencillas, y aqu铆 tenemos varios consejos:

- Si solo deseas probar el inicio de sesi贸n de WeChat y la aplicaci贸n no est谩 en la App Store, en la secci贸n "App is available", elige "No" para omitir el "App download link".
- El "App operation flow chart" parece complicado. Seg煤n nuestra experiencia, necesitas preparar un diagrama de flujo simple y varias capturas de pantalla de la aplicaci贸n para mejorar la posibilidad de pasar la revisi贸n.

Haz clic en "Next step" para continuar.

#### Informaci贸n de la plataforma \{#platform-info}

Puedes configurar una o ambas plataformas iOS y Android para integrar Logto con el inicio de sesi贸n nativo de WeChat.

**Aplicaci贸n iOS**

Marca "iOS app" (iOS 搴), luego marca el tipo de dispositivo objetivo de tu aplicaci贸n seg煤n corresponda.

<img src="/img/assets/platform.png" alt="Plataforma de la aplicaci贸n" />

Si elegiste "No" para la disponibilidad en la App Store, puedes omitir completar la "AppStore download address" aqu铆.

Completa _Bundle ID_, _Test version Bundle ID_ y _Universal Links_ (en realidad, solo se necesita un enlace ).

:::note

_Bundle ID_ y _Test version Bundle ID_ pueden tener el mismo valor.

:::

:::tip

WeChat requiere un enlace universal para el inicio de sesi贸n nativo. Si no lo has configurado o no lo conoces, consulta el [documento oficial de Apple](https://developer.apple.com/ios/universal-links/).

:::

**Aplicaci贸n Android**

Marca "Android app" (Android 搴).

<img src="/img/assets/platform-android-app.png" alt="Plataforma de la aplicaci贸n Android" />

Completa _Application Signing Signature_ (搴ㄧ惧) y _Application Package Name_ (搴ㄥ).

:::note

Necesitas firmar tu aplicaci贸n para obtener una firma. Consulta [Firmar tu aplicaci贸n](https://developer.android.com/studio/publish/app-signing) para m谩s informaci贸n.

:::

Despu茅s de terminar de firmar, puedes ejecutar la tarea `signingReport` para obtener la firma de la aplicaci贸n.

```bash
./gradlew your-android-project:signingReport
```

El valor `MD5` del informe de la variante de compilaci贸n correspondiente ser谩 la _Application Signing Signature_ (搴ㄧ惧), pero recuerda eliminar todos los puntos y comas del valor y ponerlo en min煤sculas.

Por ejemplo, `1A:2B:3C:4D` -> `1a2b3c4d`.

#### Esperando el resultado de la revisi贸n \{#waiting-for-the-review-result}

Despu茅s de completar la informaci贸n de la plataforma, haz clic en "Submit Review" para continuar. Por lo general, la revisi贸n es r谩pida y termina en 1-2 d铆as.

Sospechamos que el revisor se asigna aleatoriamente en cada env铆o, ya que el est谩ndar es variable. Puede que te rechacen la primera vez, 隆pero no te rindas! Explica tu situaci贸n actual y pregunta al revisor c贸mo modificarla.

## Habilitar el inicio de sesi贸n nativo de WeChat en tu aplicaci贸n \{#enable-wechat-native-sign-in-in-your-app}

### iOS \{#ios}

Asumimos que has integrado [Logto iOS SDK](/quick-starts/swift) en tu aplicaci贸n. En este caso, las cosas son bastante simples, y ni siquiera necesitas leer el documento del SDK de WeChat:

**1. Configura el enlace universal y el esquema de URL en tu proyecto Xcode**

En el proyecto Xcode -> pesta帽a Signing & Capabilities, agrega la capacidad "Associated Domains" y el enlace universal que configuraste antes.

<img src="/img/assets/universal-link.png" alt="Enlace universal" />

Luego ve a la pesta帽a "Info", agrega un [esquema de URL personalizado](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) con el WeChat App ID.

<img src="/img/assets/custom-url-scheme.png" alt="Esquema de URL personalizado" />

Finalmente, abre tu `Info.plist`, agrega `weixinULAPI` y `weixin` bajo `LSApplicationQueriesSchemes`.

<img src="/img/assets/plist.png" alt="Plist" />

:::note

Sabemos que estas acciones no son muy razonables, pero esta es la soluci贸n m铆nima viable que encontramos. Consulta la [gu铆a oficial m谩gica](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html) para m谩s informaci贸n.

:::

**2. Agrega `LogtoSocialPluginWechat` a tu proyecto Xcode**

Agrega el framework:

<img src="/img/assets/add-framework.png" alt="Agregar framework" />

Y agrega `-ObjC` a tus Build Settings > Linking > Other Linker Flags:

<img src="/img/assets/linker-flags.png" alt="Flags del linker" />

:::note

El plugin incluye WeChat Open SDK 1.9.2. Puedes usar directamente `import WechatOpenSDK` una vez importado el plugin.

:::

**3. Agrega el plugin a tus opciones de inicializaci贸n de `LogtoClient`**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. Maneja `onOpenURL` adecuadamente**

:::note

La funci贸n `LogtoClient.handle(url:)` manejar谩 todos los conectores nativos que hayas habilitado. Solo necesitas llamarla una vez.

:::

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// o AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android \{#android}

Asumimos que has integrado [Logto Android SDK](/quick-starts/android) en tu aplicaci贸n. En este caso, las cosas son bastante simples, y ni siquiera necesitas leer el documento del SDK de WeChat:

**1. Agrega `Wechat Open SDK` a tu proyecto**

Aseg煤rate de que el repositorio `mavenCentral()` est茅 en los repositorios de tu proyecto Gradle:

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

Agrega el Wechat Open SDK a tus dependencias:

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // o
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. Introduce `WXEntryActivity` a tu proyecto**

Crea un paquete `wxapi` bajo tu ra铆z de paquete y agrega el `WXEntryActivity` en el paquete `wxapi` (Toma `com.sample.app` como ejemplo):

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

La posici贸n final del `WXEntryActivity` bajo el proyecto deber铆a verse as铆 (Toma Kotlin como ejemplo):

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. Modifica el `AndroidManifest.xml`**

Agrega la siguiente l铆nea a tu `AndroidManifest.xml`:

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- l铆nea a ser agregada -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```

## Probar el conector nativo de WeChat \{#test-wechat-native-connector}

Eso es todo. No olvides [Habilitar el conector social en la experiencia de inicio de sesi贸n](/connectors/social-connectors/#enable-social-sign-in).

Una vez que el conector nativo de WeChat est茅 habilitado, puedes compilar y ejecutar tu aplicaci贸n para ver si funciona.

:::caution

WeChat no tiene un plan para aquellos dispositivos sin la aplicaci贸n de WeChat instalada. Logto ocultar谩 este conector durante el inicio de sesi贸n si es as铆 (lo cual es la forma recomendada seg煤n la [gu铆a de desarrollo oficial](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/WeChat_Login/Development_Guide.html)).

:::