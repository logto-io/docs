---
slug: /integrations/wechat-native
sidebar_label: WeChat (Native)
sidebar_custom_props:
  description: WeChat est une application de messagerie instantan√©e multiplateforme.
  logoFilename: 'wechat.svg'
---

import GuideTip from '../../fragments/_guide-tip.mdx';

# Configurer la connexion sociale avec WeChat (Native)

Le connecteur officiel Logto pour la connexion sociale WeChat dans les applications natives (iOS et Android).

<GuideTip />

## Commencer

Si vous ne connaissez pas le concept du connecteur ou ne savez pas comment ajouter ce connecteur √† votre Exp√©rience de connexion, veuillez consulter le [tutoriel Logto](/connectors/social-connectors).

Dans les applications natives, vous ne pouvez pas utiliser le web comme m√©thode de connexion de WeChat : la navigation vers l'application WeChat est requise, et cela n√©cessite √©galement l'utilisation de leur SDK.

Nous savons que cela peut sembler effrayant, mais ne vous inqui√©tez pas. Nous allons le g√©rer facilement dans ce tutoriel.

## Cr√©er une application mobile sur la plateforme ouverte WeChat

> üí° **Astuce**
>
> Vous pouvez ignorer certaines sections si vous avez d√©j√† termin√©.

### Cr√©er un compte

Ouvrez https://open.weixin.qq.com/, cliquez sur le bouton "Sign Up" dans le coin sup√©rieur droit, puis terminez le processus d'inscription.

### Cr√©er une application mobile

Connectez-vous avec le compte que vous venez de cr√©er. Dans l'onglet "Mobile Application" (ÁßªÂä®Â∫îÁî®), cliquez sur le grand bouton vert "Create a mobile app" (ÂàõÂª∫ÁßªÂä®Â∫îÁî®).

![Onglets d'application](./assets/app-tabs.png)

Remplissons les informations requises dans le formulaire de demande.

![Cr√©er une application mobile](./assets/create-mobile-app.png)

#### Informations de base

La plupart d'entre elles sont assez simples, et nous avons quelques conseils ici :

- Si vous souhaitez simplement tester la connexion WeChat et que l'application n'est pas sur l'App Store, dans la section "App is available", choisissez "No" pour ignorer le "App download link".
- Le "App operation flow chart" semble compliqu√©. D'apr√®s notre exp√©rience, vous devez pr√©parer un simple organigramme et plusieurs captures d'√©cran de l'application pour augmenter la possibilit√© de passer la r√©vision.

Cliquez sur "Next step" pour continuer.

#### Informations sur la plateforme

Vous pouvez configurer une ou les deux plateformes iOS et Android pour int√©grer Logto avec la connexion native WeChat.

**Application iOS**

Cochez "iOS app" (iOS Â∫îÁî®), puis cochez le type d'appareil cible de votre application en cons√©quence.

![Plateforme d'application](./assets/platform.png)

Si vous avez choisi "No" pour la disponibilit√© sur l'App Store, vous pouvez ignorer le remplissage de l'"AppStore download address" ici.

Remplissez _Bundle ID_, _Test version Bundle ID_, et _Universal Links_ (en fait, un seul lien est n√©cessaire üòÇ).

> ‚ÑπÔ∏è **Remarque**
>
> _Bundle ID_ et _Test version Bundle ID_ peuvent avoir la m√™me valeur.

> üí° **Astuce**
>
> WeChat n√©cessite un lien universel pour la connexion native. Si vous ne l'avez pas configur√© ou ne le connaissez pas, veuillez vous r√©f√©rer √† la [documentation officielle d'Apple](https://developer.apple.com/ios/universal-links/).

**Application Android**

Cochez "Android app" (Android Â∫îÁî®).

![Plateforme d'application Android](./assets/platform-android-app.png)

Remplissez _Application Signing Signature_ (Â∫îÁî®Á≠æÂêç) et _Application Package Name_ (Â∫îÁî®ÂåÖÂêç).

> ‚ÑπÔ∏è **Remarque**
>
> Vous devez signer votre application pour obtenir une signature. Consultez [Signer votre application](https://developer.android.com/studio/publish/app-signing) pour plus d'informations.

Apr√®s avoir termin√© la signature, vous pouvez ex√©cuter la t√¢che `signingReport` pour obtenir la signature de signature.

```bash
./gradlew your-android-project:signingReport
```

La valeur `MD5` du rapport de la variante de build correspondante sera la _Application Signing Signature_ (Â∫îÁî®Á≠æÂêç), mais n'oubliez pas de supprimer tous les points-virgules de la valeur et de la mettre en minuscules.

Par exemple, `1A:2B:3C:4D` -> `1a2b3c4d`.

#### En attente du r√©sultat de la r√©vision

Apr√®s avoir compl√©t√© les informations de la plateforme, cliquez sur "Submit Review" pour continuer. En g√©n√©ral, la r√©vision est rapide, elle se termine en 1 √† 2 jours.

Nous soup√ßonnons que le r√©viseur est attribu√© al√©atoirement √† chaque soumission, car la norme est fluctuante. Vous pouvez √™tre rejet√© la premi√®re fois, mais ne vous d√©couragez pas ! Indiquez votre situation actuelle et demandez au r√©viseur comment la modifier.

## Activer la connexion native WeChat dans votre application

### iOS

Nous supposons que vous avez int√©gr√© le [Logto iOS SDK](/quick-starts/swift) dans votre application. Dans ce cas, les choses sont assez simples, et vous n'avez m√™me pas besoin de lire la documentation du SDK WeChat :

**1. Configurez le lien universel et le sch√©ma d'URL dans votre projet Xcode**

Dans le projet Xcode -> onglet Signing & Capabilities, ajoutez la capacit√© "Associated Domains" et le lien universel que vous avez configur√© auparavant.

![Lien universel](./assets/universal-link.png)

Ensuite, allez dans l'onglet "Info", ajoutez un [sch√©ma d'URL personnalis√©](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) avec l'ID d'application WeChat.

![Sch√©ma d'URL personnalis√©](./assets/custom-url-scheme.png)

Enfin, ouvrez votre `Info.plist`, ajoutez `weixinULAPI` et `weixin` sous `LSApplicationQueriesSchemes`.

![Plist](./assets/plist.png)

> ü§¶ **Remarque**
>
> Nous savons que ces actions ne sont pas tr√®s raisonnables, mais c'est la solution minimale fonctionnelle que nous avons trouv√©e. Consultez le [guide officiel magique](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html) pour plus d'informations.

**2. Ajoutez `LogtoSocialPluginWechat` √† votre projet Xcode**

Ajoutez le framework :

![Ajouter le framework](./assets/add-framework.png)

Et ajoutez `-ObjC` √† vos param√®tres de build > Linking > Other Linker Flags :

![Indicateurs de l'√©diteur de liens](./assets/linker-flags.png)

> ‚ÑπÔ∏è **Remarque**
>
> Le plugin inclut WeChat Open SDK 1.9.2. Vous pouvez directement utiliser `import WechatOpenSDK` une fois le plugin import√©.

**3. Ajoutez le plugin √† vos options d'initialisation `LogtoClient`**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. G√©rez correctement `onOpenURL`**

> ‚ÑπÔ∏è **Remarque**
>
> La fonction `LogtoClient.handle(url:)` g√©rera tous les connecteurs natifs que vous avez activ√©s. Vous n'avez besoin de l'appeler qu'une seule fois.

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// ou AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android

Nous supposons que vous avez int√©gr√© le [Logto Android SDK](/quick-starts/android) dans votre application. Dans ce cas, les choses sont assez simples, et vous n'avez m√™me pas besoin de lire la documentation du SDK WeChat :

**1. Ajoutez `Wechat Open SDK` √† votre projet**

Assurez-vous que le d√©p√¥t `mavenCentral()` est dans les d√©p√¥ts de votre projet Gradle :

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

Ajoutez le Wechat Open SDK √† vos d√©pendances :

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // ou
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. Introduisez `WXEntryActivity` dans votre projet**

Cr√©ez un package `wxapi` sous votre racine de package et ajoutez le `WXEntryActivity` dans le package `wxapi` (Prenons `com.sample.app` comme exemple) :

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

La position finale du `WXEntryActivity` sous le projet devrait ressembler √† ceci (Prenons Kotlin comme exemple) :

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. Modifiez le `AndroidManifest.xml`**

Ajoutez la ligne suivante √† votre `AndroidManifest.xml` :

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- ligne √† ajouter -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```

## Tester le connecteur natif WeChat

C'est tout. N'oubliez pas d' [activer le connecteur social dans l'exp√©rience de connexion](/connectors/social-connectors/#enable-social-sign-in).

Une fois le connecteur natif WeChat activ√©, vous pouvez construire et ex√©cuter votre application pour voir si cela fonctionne.

> ‚ö†Ô∏è **Attention**
>
> WeChat n'a pas de plan pour les appareils sans l'application WeChat install√©e. Logto masquera ce connecteur lors de la connexion si c'est le cas (ce qui est la m√©thode recommand√©e par le [guide de d√©veloppement officiel](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/WeChat_Login/Development_Guide.html)).
