## Étape 1 : Créer une application GitHub \{#step-1-create-a-github-app}

Avant de pouvoir utiliser GitHub comme fournisseur d'authentification, vous devez créer une application GitHub sur GitHub afin d'obtenir des identifiants OAuth 2.0.

1. Rendez-vous sur [GitHub](https://github.com/) et connectez-vous avec votre compte, ou créez un nouveau compte si nécessaire.
2. Accédez à [Paramètres > Paramètres développeur > Applications GitHub](https://github.com/settings/apps).
3. Cliquez sur **Nouvelle application GitHub** pour enregistrer une nouvelle application :
   - **Nom de l'application GitHub** : Saisissez un nom unique pour votre application. Le nom ne peut pas dépasser 34 caractères et doit être unique sur GitHub.
   - **URL de la page d'accueil** : Saisissez l'URL de la page d'accueil de votre application.
   - **URL de rappel** : Copiez l'**URI de rappel** depuis votre connecteur GitHub Logto et collez-le ici. Vous pouvez ajouter plusieurs URL de rappel si nécessaire. Après la connexion des utilisateurs avec GitHub, ils seront redirigés ici avec un code d'autorisation que Logto utilise pour finaliser l'authentification.
   - **Expirer les jetons d’autorisation utilisateur** : Laissez cette option **cochée** (recommandé). Cela active l'expiration des jetons et les jetons de rafraîchissement pour une sécurité renforcée.
   - **Demander l’autorisation utilisateur (OAuth) lors de l’installation** : Cochez cette option si vous souhaitez inviter les utilisateurs à autoriser votre application lors de l'installation.
   - **Webhook** : Décochez **Actif** si vous n'avez pas besoin d'événements webhook. Pour les cas d'utilisation d'authentification uniquement, les webhooks ne sont généralement pas nécessaires.
4. Sous **Permissions**, configurez les permissions dont votre application a besoin (voir l'étape 2 ci-dessous pour plus de détails).
5. Sous **Où cette application GitHub peut-elle être installée ?**, sélectionnez **N'importe quel compte** si vous souhaitez que les utilisateurs de n'importe quel compte GitHub puissent utiliser votre application pour l'authentification.
6. Cliquez sur **Créer une application GitHub** pour créer l'application GitHub.

:::note
Contrairement aux applications OAuth, les applications GitHub utilisent des permissions fines au lieu de portées larges. Vous configurez les permissions dans le tableau de bord GitHub lors de la création de l'application, et les utilisateurs accordent l'accès à des dépôts spécifiques lors de l'autorisation.

Pour plus de détails sur la configuration des applications GitHub, consultez [Enregistrer une application GitHub](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/registering-a-github-app).
:::

## Étape 2 : Configurer les permissions dans GitHub \{#step-2-configure-permissions-in-github}

Les applications GitHub utilisent des permissions fines au lieu de portées OAuth. Vous devez configurer les permissions **dans le tableau de bord GitHub** lors de la création ou de la modification de votre application GitHub. Ces permissions déterminent à quelles données votre application peut accéder.

### Comprendre les permissions des applications GitHub \{#understanding-github-app-permissions}

Les permissions sont classées en trois types :

- **Permissions de dépôt** : Accès aux ressources au niveau du dépôt (code, tickets, pull requests, etc.)
- **Permissions d'organisation** : Accès aux ressources au niveau de l'organisation (membres, équipes, projets, etc.)
- **Permissions de compte** : Accès aux données du compte utilisateur (e-mail, profil, abonnés, etc.)

Pour chaque permission, vous pouvez sélectionner :

- **Aucun accès** : L'application ne peut pas accéder à cette ressource
- **Lecture seule** : L'application peut lire mais pas modifier cette ressource
- **Lecture & écriture** : L'application peut lire et modifier cette ressource

### Permissions recommandées pour l'authentification \{#recommended-permissions-for-authentication}

Pour la fonctionnalité de base "Se connecter avec GitHub", configurez au minimum ces **permissions de compte** :

| Permission          | Niveau d'accès | Objectif                                                             |
| ------------------- | -------------- | -------------------------------------------------------------------- |
| **Adresses e-mail** | Lecture seule  | Obtenir l'adresse e-mail de l'utilisateur pour la création de compte |

:::tip
Les applications GitHub ont un accès implicite à la lecture des informations de profil public lorsqu'elles agissent au nom d'un utilisateur. Vous n'avez pas besoin de demander explicitement la permission pour les données de profil de base telles que le nom d'utilisateur, l'avatar et l'URL du profil public.
:::

### Permissions supplémentaires pour l'accès à l'API \{#additional-permissions-for-api-access}

Si votre application doit accéder aux API GitHub au-delà de l'authentification, ajoutez les permissions correspondantes dans le tableau de bord GitHub. Voici quelques exemples courants :

| Type de permission | Permission    | Niveau d'accès                     | Cas d'utilisation                                                       |
| ------------------ | ------------- | ---------------------------------- | ----------------------------------------------------------------------- |
| **Dépôt**          | Contenus      | Lecture seule / Lecture & écriture | Accéder aux fichiers et au code du dépôt                                |
| **Dépôt**          | Tickets       | Lecture & écriture                 | Créer et gérer des tickets                                              |
| **Dépôt**          | Pull requests | Lecture & écriture                 | Créer et gérer des pull requests                                        |
| **Dépôt**          | Métadonnées   | Lecture seule                      | Accéder aux métadonnées du dépôt (requis pour de nombreuses opérations) |
| **Organisation**   | Membres       | Lecture seule                      | Lister les membres de l'organisation                                    |
| **Compte**         | Abonnés       | Lecture seule                      | Accéder aux abonnés et abonnements de l'utilisateur                     |

Ceci n'est pas une liste exhaustive — les applications GitHub prennent en charge de nombreuses autres permissions fines. Consultez [Permissions requises pour les applications GitHub](https://docs.github.com/en/rest/overview/permissions-required-for-github-apps) pour la liste complète.

:::tip[Différence clé avec les applications OAuth]
Contrairement aux applications OAuth où vous configurez les portées dans le connecteur Logto, les permissions des applications GitHub sont entièrement gérées dans le tableau de bord GitHub. Vous pouvez laisser le champ `Scope` vide dans votre connecteur GitHub Logto — ce n'est pas nécessaire car les applications GitHub n'utilisent pas les portées OAuth traditionnelles.

Il suffit de configurer les permissions dont vous avez besoin dans GitHub, et les utilisateurs seront invités à accorder l'accès lors de l'autorisation.
:::

## Étape 3 : Configurer votre connecteur Logto \{#step-3-configure-your-logto-connector}

Après avoir créé l'application GitHub, vous serez redirigé vers sa page de paramètres où vous pourrez obtenir les identifiants.

1. Sur la page des paramètres de votre application GitHub, copiez l'**ID client** et collez-le dans le champ `clientId` dans Logto.
2. Sous **Secrets client**, cliquez sur **Générer un nouveau secret client**. Copiez le secret généré et collez-le dans le champ `clientSecret` dans Logto.
3. Cliquez sur **Enregistrer et terminer** dans Logto pour connecter votre système d'identité à GitHub.

:::warning
Gardez votre secret client en sécurité et ne l'exposez jamais dans du code côté client. Les secrets client GitHub ne peuvent pas être récupérés en cas de perte — vous devrez en générer un nouveau.
:::

:::note
L'ID client d'une application GitHub est différent de l'ID de l'application. Assurez-vous d'utiliser l'ID client (affiché comme "Client ID" sur la page des paramètres), et non l'ID de l'application.
:::

## Étape 4 : Paramètres généraux \{#step-4-general-settings}

Voici quelques paramètres généraux qui ne bloqueront pas la connexion à GitHub mais peuvent affecter l'expérience d'authentification de l'utilisateur final.

### Synchroniser les informations de profil \{#sync-profile-information}

Dans le connecteur GitHub, vous pouvez configurer la façon dont les informations de profil sont synchronisées depuis les informations utilisateur GitHub vers le profil utilisateur Logto, y compris `name`, `avatar` et `email`. Choisissez parmi les options suivantes :

- **Synchroniser uniquement lors de l'inscription** : Les informations de profil sont récupérées une seule fois lors de la première connexion de l'utilisateur.
- **Toujours synchroniser lors de la connexion** : Les informations de profil sont mises à jour à chaque connexion de l'utilisateur.

### Stocker les jetons pour accéder aux API GitHub (Optionnel) \{#store-tokens-to-access-github-apis-optional}

Si vous souhaitez accéder aux API GitHub et effectuer des actions avec l'autorisation de l'utilisateur (que ce soit via la connexion sociale ou la liaison de compte), activez le stockage des jetons dans Logto :

1. Configurez les permissions requises dans les paramètres de votre application GitHub (Étape 2).
2. Activez **Stocker les jetons pour un accès API persistant** dans le connecteur GitHub Logto. Logto stockera en toute sécurité à la fois le jeton d’accès et le jeton de rafraîchissement dans le Secret Vault.

:::note
Comme les applications GitHub émettent toujours des jetons de rafraîchissement, Logto stocke automatiquement les deux jetons. Le jeton d’accès expire après 8 heures, mais Logto peut utiliser le jeton de rafraîchissement pour obtenir de nouveaux jetons d’accès, garantissant un accès API ininterrompu jusqu'à 6 mois.
:::

## Étape 5 : Tester votre intégration (Optionnel) \{#step-5-test-your-integration-optional}

Avant de passer en production, testez l'intégration de votre application GitHub :

1. Utilisez le connecteur dans un tenant de développement Logto.
2. Vérifiez que les utilisateurs peuvent se connecter avec GitHub.
3. Vérifiez que les utilisateurs sont invités à accorder les bonnes permissions lors de l'autorisation.
4. Si vous avez activé le stockage des jetons, vérifiez que les jetons d’accès (et les jetons de rafraîchissement) sont correctement stockés.
5. Testez les appels API en utilisant les jetons stockés pour vous assurer que les permissions fonctionnent comme prévu.

Les applications GitHub fonctionnent immédiatement avec n'importe quel compte utilisateur GitHub — il n'est pas nécessaire d'avoir des utilisateurs de test ou une approbation d'application comme sur d'autres plateformes. Cependant, si votre application est installée sur une organisation, les propriétaires de l'organisation devront peut-être approuver l'installation.
