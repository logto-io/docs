## Commencer \{#get-started}

1. Créez un compte développeur sur [Xiaomi Open Platform](https://dev.mi.com/)
2. Rendez-vous sur [Xiaomi Account Service](https://dev.mi.com/passport/oauth2/applist)
3. Créez une nouvelle application si vous n'en avez pas encore

## Configurer l’application OAuth Xiaomi \{#configure-xiaomi-oauth-application}

1. Rendez-vous sur [Xiaomi Account Service](https://dev.mi.com/passport/oauth2/applist)
2. Configurez les paramètres OAuth :
   - Ouvrez l'application que vous souhaitez utiliser pour la connexion, cliquez sur "Callback URL" (si vous n'avez pas modifié l'URL de rappel, elle s'affichera comme "Enabled")
   - Ajoutez l’URL de rappel d’autorisation : `${your_logto_origin}/callback/${connector_id}`
   - `connector_id` se trouve en haut de la page de détails du connecteur dans Logto Console
3. Récupérez `AppID` et `AppSecret` depuis la page de détails de l’application
4. Renseignez les champs `clientId` et `clientSecret` dans Logto Console avec les valeurs de l’étape 3
5. Configuration optionnelle :
   - `skipConfirm` : Permet de passer la page de confirmation d’autorisation Xiaomi lorsque l’utilisateur est déjà connecté à son compte Xiaomi, la valeur par défaut est false

## Description des portées (Scopes) \{#scopes-description}

Par défaut, le connecteur demande la portée suivante :

- `1` : Lire le profil utilisateur

Portées disponibles :

| Valeur de la portée | Description                                           | Interface API |
| ------------------- | ----------------------------------------------------- | ------------- |
| 1                   | Obtenir le profil utilisateur                         | user/profile  |
| 3                   | Obtenir l’open_id utilisateur                         | user/openIdV2 |
| 1000                | Obtenir les infos du routeur Xiaomi                   | Mi Router     |
| 1001                | Accéder à toutes les infos du routeur Xiaomi          | Mi Router     |
| 2001                | Accéder au calendrier cloud Xiaomi                    | Mi Cloud      |
| 2002                | Accéder à l’alarme cloud Xiaomi                       | Mi Cloud      |
| 6000                | Utiliser le service maison connectée Mi Home          | Mi Home       |
| 6002                | Ajouter des appareils tiers à Mi Home                 | Mi Home       |
| 6003                | Contrôle Alexa des appareils Xiaomi                   | Mi Home       |
| 6004                | Accès service tiers aux appareils Xiaomi              | Mi Home       |
| 7000                | Suivre le compte service Pages Jaunes                 | Mi Cloud      |
| 11000               | Obtenir les photos cloud Xiaomi                       | Mi Cloud      |
| 12001               | Sauvegarder les données de l’application sur Mi Cloud | Mi Cloud      |
| 12005               | Utiliser le service ECG santé                         | Health        |
| 16000               | Obtenir les passes Mi Wallet                          | app/get_pass  |
| 20000               | Activer le service vocal XiaoAI                       | XiaoAI        |
| 40000               | Activer le service cloud IA                           | Usage interne |

Plusieurs portées peuvent être configurées en les séparant par des espaces, par exemple : `1 3 6000`.

## Tester le connecteur Xiaomi \{#test-xiaomi-connector}

C’est tout. N’oubliez pas d’[activer la connexion sociale](https://docs.logto.io/connectors/social-connectors#enable-social-sign-in) dans l’expérience de connexion.
