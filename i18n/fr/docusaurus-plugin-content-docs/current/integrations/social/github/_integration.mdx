## Étape 1 : Créer une application OAuth sur GitHub \{#step-1-create-an-oauth-app-on-github}

Avant de pouvoir utiliser GitHub comme fournisseur d'authentification, vous devez créer une application OAuth sur GitHub pour obtenir des identifiants OAuth 2.0.

1. Rendez-vous sur [GitHub](https://github.com/) et connectez-vous avec votre compte, ou créez un nouveau compte si nécessaire.
2. Accédez à [Paramètres > Paramètres développeur > Applications OAuth](https://github.com/settings/developers).
3. Cliquez sur **Nouvelle application OAuth** pour enregistrer une nouvelle application :
   - **Nom de l'application** : Saisissez un nom descriptif pour votre application.
   - **URL de la page d'accueil** : Saisissez l'URL de la page d'accueil de votre application.
   - **URL de rappel d'autorisation** : Copiez l'**URI de rappel** depuis votre connecteur GitHub Logto et collez-le ici. Après la connexion des utilisateurs avec GitHub, ils seront redirigés ici avec un code d'autorisation que Logto utilise pour finaliser l'authentification.
   - **Description de l'application** : (Optionnel) Ajoutez une brève description de votre application.
4. Cliquez sur **Enregistrer l'application** pour créer l'application OAuth.

:::note
Nous vous recommandons de ne pas cocher la case **Activer Device Flow**, car les utilisateurs qui se connectent avec GitHub sur des appareils mobiles devront confirmer l'action de connexion initiale dans l'application mobile GitHub. De nombreux utilisateurs GitHub n'installent pas l'application mobile GitHub sur leur téléphone, ce qui pourrait bloquer le flux de connexion. Activez cette option uniquement si vous attendez des utilisateurs finaux qu'ils confirment leur connexion via l'application mobile GitHub. Voir les détails sur le [device flow](https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps#device-flow).

Pour plus de détails sur la configuration des applications OAuth GitHub, consultez [Créer une application OAuth](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/creating-an-oauth-app).
:::

## Étape 2 : Configurer votre connecteur Logto \{#step-2-configure-your-logto-connector}

Après avoir créé l'application OAuth sur GitHub, vous serez redirigé vers une page de détails où vous pourrez copier l'ID client et générer un secret client.

1. Copiez l'**ID client** de votre application OAuth GitHub et collez-le dans le champ `clientId` dans Logto.
2. Cliquez sur **Générer un nouveau secret client** sur GitHub pour créer un nouveau secret, puis copiez-le et collez-le dans le champ `clientSecret` dans Logto.
3. Cliquez sur **Enregistrer et Terminer** dans Logto pour connecter votre système d'identité à GitHub.

:::warning
Gardez votre secret client en sécurité et ne l'exposez jamais dans du code côté client. Les secrets client GitHub ne peuvent pas être récupérés s'ils sont perdus — vous devrez en générer un nouveau.
:::

## Étape 3 : Configurer les portées (Optionnel) \{#step-3-configure-scopes-optional}

Les portées (Scopes) définissent les permissions que votre application demande aux utilisateurs et contrôlent les données auxquelles votre application peut accéder depuis leurs comptes GitHub.

Utilisez le champ `Scopes` dans Logto pour demander des permissions supplémentaires à GitHub. Choisissez l'une des approches suivantes selon vos besoins :

### Option 1 : Aucune portée API supplémentaire requise \{#option-1-no-extra-api-scopes-needed}

- Laissez le champ `Scopes` vide dans votre connecteur GitHub Logto.
- La portée par défaut `read:user` sera demandée pour garantir que Logto puisse obtenir correctement les informations de base de l'utilisateur (par exemple, e-mail, nom, avatar).

### Option 2 : Demander des portées supplémentaires à la connexion \{#option-2-request-additional-scopes-at-sign-in}

- Parcourez toutes les [portées GitHub disponibles pour les applications OAuth](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/scopes-for-oauth-apps) et ajoutez uniquement celles dont votre application a besoin.
- Saisissez toutes les portées souhaitées dans le champ **Scopes**, séparées par des espaces.
- Toutes les portées que vous indiquez ici remplacent les valeurs par défaut, donc incluez toujours la portée d'authentification : `read:user`.
- Les portées supplémentaires courantes incluent :
  - `repo` : Contrôle total des dépôts privés
  - `public_repo` : Accès aux dépôts publics
  - `user:email` : Accès aux adresses e-mail de l'utilisateur
  - `notifications` : Accès aux notifications
- Assurez-vous que toutes les portées sont correctement orthographiées et valides. Une portée incorrecte ou non prise en charge entraînera une erreur "Invalid scope" de la part de GitHub.

### Option 3 : Demander des portées incrémentielles ultérieurement \{#option-3-request-incremental-scopes-later}

- Après la connexion de l'utilisateur, vous pouvez demander des portées supplémentaires à la demande en relançant un flux d'autorisation sociale fédérée et en mettant à jour l'ensemble de jetons stockés de l'utilisateur.
- Ces portées supplémentaires n'ont pas besoin d'être renseignées dans le champ `Scopes` de votre connecteur GitHub Logto, et peuvent être obtenues via l’API de vérification sociale de Logto.

En suivant ces étapes, votre connecteur GitHub Logto demandera exactement les permissions dont votre application a besoin — ni plus, ni moins.

:::tip
Si votre application demande ces portées pour accéder à l’API GitHub et effectuer des actions, assurez-vous d’activer **Stocker les jetons pour un accès API persistant** dans le connecteur GitHub Logto. Voir la section suivante pour plus de détails.
:::

## Étape 4 : Paramètres généraux \{#step-4-general-settings}

Voici quelques paramètres généraux qui ne bloqueront pas la connexion à GitHub mais peuvent affecter l'expérience d'authentification des utilisateurs finaux.

### Synchroniser les informations de profil \{#sync-profile-information}

Dans le connecteur GitHub, vous pouvez définir la politique de synchronisation des informations de profil, telles que les noms d'utilisateur et les avatars. Choisissez parmi :

- **Synchroniser uniquement à l'inscription** : Les informations de profil sont récupérées une seule fois lors de la première connexion de l'utilisateur.
- **Toujours synchroniser à la connexion** : Les informations de profil sont mises à jour à chaque connexion de l'utilisateur.

### Stocker les jetons pour accéder aux API GitHub (Optionnel) \{#store-tokens-to-access-github-apis-optional}

Si vous souhaitez accéder aux API GitHub et effectuer des actions avec l'autorisation de l'utilisateur (que ce soit via la connexion sociale ou la liaison de compte), Logto doit obtenir des portées API spécifiques et stocker les jetons.

1. Ajoutez les portées requises en suivant les instructions ci-dessus.
2. Activez **Stocker les jetons pour un accès API persistant** dans le connecteur GitHub Logto. Logto stockera en toute sécurité les jetons d’accès GitHub dans le Secret Vault.

:::note
Lorsque vous utilisez une **application OAuth GitHub** comme décrit dans ce tutoriel, vous ne pouvez pas obtenir de jeton de rafraîchissement de GitHub car son jeton d’accès n’expire pas, sauf si l’utilisateur le révoque manuellement. Par conséquent, il n’est pas nécessaire d’ajouter `offline_access` dans le champ `Scopes` — le faire peut provoquer une erreur.

Si vous souhaitez que le jeton d’accès expire ou utiliser des jetons de rafraîchissement, envisagez d’intégrer une **application GitHub** à la place. Découvrez les [différences entre les applications GitHub et les applications OAuth](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/differences-between-github-apps-and-oauth-apps).
:::

## Étape 5 : Tester votre intégration (Optionnel) \{#step-5-test-your-integration-optional}

Avant de passer en production, testez votre intégration GitHub :

1. Utilisez le connecteur dans un tenant de développement Logto.
2. Vérifiez que les utilisateurs peuvent se connecter avec GitHub.
3. Vérifiez que les bonnes portées sont demandées.
4. Testez les appels API si vous stockez des jetons.

Les applications OAuth GitHub fonctionnent immédiatement avec n'importe quel compte utilisateur GitHub — il n'est pas nécessaire d'avoir des utilisateurs de test ou une approbation d'application comme sur d'autres plateformes.
