## Configurer un service de messages courts dans la console SMS d'Aliyun \{#set-up-a-short-message-service-in-aliyun-sms-console}

### Créer un compte Aliyun \{#create-an-aliyun-account}

Rendez-vous sur le [site web d'Aliyun](https://cn.aliyun.com/) et inscrivez-vous si vous n'avez pas encore de compte Aliyun.

### Activer et configurer le service de messages courts Aliyun \{#enable-and-configure-aliyun-short-message-service}

1. Connectez-vous avec votre compte Aliyun sur le [site web d'Aliyun](https://cn.aliyun.com/) et accédez à la [page de la console du service SMS](https://www.aliyun.com/product/sms).
2. Cliquez sur le bouton "Ouverture gratuite" (免费开通) en haut à gauche de la page du service SMS et commencez le processus de configuration.
3. Lisez et acceptez les "Conditions d'activation du service SMS" (短信服务开通条款) puis cliquez sur "Souscrire au service" (开通服务) pour continuer.
4. Vous êtes maintenant sur la [page de la console du service SMS](https://dysms.console.aliyun.com/overview), allez soit sur le bouton "Chine continentale" (国内消息) soit sur "Hors Chine continentale" (国际/港澳台消息) dans la barre latérale selon votre cas d'utilisation.
5. Ajoutez une signature et un modèle en suivant les instructions, et fournissez les documents ou informations nécessaires pour la vérification.
   - N'oubliez pas de sélectionner "Message de code de vérification" (验证码) comme "Scénario" (适用场景) lors de la demande de signature et également "Message de code de vérification" (验证码) pour le "Type" (模板类型) lors de la demande de validation du modèle, car nous utilisons ces signatures et modèles pour envoyer des codes de vérification. Actuellement, nous ne prenons pas en charge l'envoi de messages SMS autres que ceux liés aux codes de vérification.
   - Utilisez également `{{code}}` comme espace réservé à l'endroit où vous souhaitez placer votre code de vérification numérique dans le contenu du modèle.
6. Après avoir soumis votre demande de signature et de modèle SMS, vous devez attendre qu'elle prenne effet. À ce stade, vous pouvez retourner à la [page de la console du service SMS](https://dysms.console.aliyun.com/overview) et envoyer un SMS de test. Si vos signatures et modèles sont prêts à l'emploi, vous pouvez les essayer directement ; s'ils ne sont pas encore actifs, Aliyun propose également des modèles de test.
   - Il se peut que vous deviez recharger un petit montant avant d'envoyer des messages de test.
   - Il se peut également qu'on vous demande d'associer un numéro de téléphone de test avant d'envoyer des messages de test. Pour plus de détails, rendez-vous dans l'onglet "Démarrage rapide" (快速学习) depuis la barre latérale de la [page de la console du service SMS](https://dysms.console.aliyun.com/overview).

## Composer le JSON du connecteur \{#compose-the-connector-json}

1. Depuis la [page de la console du service SMS](https://dysms.console.aliyun.com/overview), survolez votre avatar en haut à droite et allez dans "Gestion des AccessKey" (AccessKey 管理), puis cliquez sur "Créer AccessKey" (创建 AccessKey). Vous obtiendrez une paire "AccessKey ID" et "AccessKey Secret" après avoir terminé la vérification de sécurité. Veuillez les conserver soigneusement.
2. Rendez-vous dans l'onglet "Chine continentale" (国内消息) ou "Hors Chine continentale" (国际/港澳台消息) que vous venez de visiter, vous trouverez facilement "Signature" (签名名称) et "Code du modèle" (模板 CODE).
   - Si vous souhaitez utiliser la signature et le modèle de test uniquement, allez plutôt dans l'onglet "Démarrage rapide" (快速学习), et vous les trouverez sous "Signature & Modèles (Pour test uniquement)".
3. Remplissez les paramètres du connecteur SMS Aliyun :
   - Renseignez les champs `accessKeyId` et `accessKeySecret` avec la paire de clés d'accès obtenue à l'étape 1.
   - Renseignez le champ `signName` avec la "Signature" (签名名称) mentionnée à l'étape 2. Tous les modèles partageront ce nom de signature.
   - Vous pouvez ajouter plusieurs modèles de connecteur SMS pour différents cas d'utilisation. Voici un exemple d'ajout d'un seul modèle :
     - Renseignez le champ `templateCode`, qui permet de contrôler le contexte du SMS, avec le "Code du modèle" (模板 CODE) de l'étape 2.
     - Renseignez le champ `usageType` avec soit `Register`, `SignIn`, `ForgotPassword` ou `Generic` selon le cas d'utilisation. (`usageType` est une propriété Logto pour identifier le cas d'utilisation approprié.) Pour activer tous les parcours utilisateur, les modèles avec usageType `Register`, `SignIn`, `ForgotPassword` et `Generic` sont requis.

### Tester le connecteur SMS Aliyun \{#test-aliyun-sms-connector}

Vous pouvez saisir un numéro de téléphone et cliquer sur "Envoyer" pour vérifier si les paramètres fonctionnent avant de cliquer sur "Enregistrer et terminer".

C'est tout. N'oubliez pas d’<MainSiteUrl href="/connectors/sms-connectors/#enable-phone-number-sign-up-or-sign-in">activer le connecteur dans l’expérience de connexion</MainSiteUrl>.

### Types de configuration \{#config-types}

| Nom             | Type       |
| --------------- | ---------- |
| accessKeyId     | string     |
| accessKeySecret | string     |
| signName        | string     |
| templates       | Template[] |

| Propriétés du modèle | Type        | Valeurs Enum                                         |
| -------------------- | ----------- | ---------------------------------------------------- |
| templateCode         | string      | N/A                                                  |
| usageType            | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |
