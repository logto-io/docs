### Optionnel : Gérer le changement de permission utilisateur \{#optional-handle-user-permission-change}

Les permissions des utilisateurs peuvent changer à tout moment. Comme Logto émet des JWT pour le contrôle d’accès basé sur les rôles (RBAC), les mises à jour de permissions n’apparaissent que dans les nouveaux jetons émis, et ne modifient jamais les JWT existants.

:::info Règle de sous-ensemble de portée (Scope subset rule)
Un jeton d’accès (Access token) ne peut inclure que les portées (Scopes) qui ont été demandées lors du flux d’autorisation OAuth initial.
Même si un utilisateur obtient de nouvelles permissions (Permissions), le jeton émis par la suite ne peut contenir qu’un sous-ensemble des portées demandées à l’origine.
Pour accéder à de nouvelles portées accordées qui ne faisaient pas partie de la demande initiale, le client doit lancer un nouveau flux d’autorisation.
:::

#### Permissions réduites (Downscoped permissions) \{#downscoped-permissions}

Lorsqu’un utilisateur perd des permissions :

- Les nouveaux jetons émis reflètent immédiatement les portées réduites.
- Les JWT existants conservent les anciennes portées jusqu’à leur expiration.
- Votre API doit toujours valider les portées et s’appuyer sur des durées de vie de jeton courtes.

Si vous avez besoin d’une réaction plus rapide, implémentez votre propre signal pour demander aux clients d’actualiser leurs jetons.

#### Permissions élargies (Enlarged permissions) \{#enlarged-permissions}

{props.type === "global" && <p>Pour les ressources API globales, lorsqu’un utilisateur obtient de nouvelles permissions, les permissions élargies n’apparaîtront PAS lors d’un rafraîchissement. Le client doit effectuer un nouveau flux d’autorisation OAuth pour obtenir un jeton incluant les nouvelles portées. Cela peut se faire silencieusement si l’utilisateur a une session Logto active.</p>}

{props.type === "organization" && <p>Pour les jetons d’organisation, lorsqu’un utilisateur obtient de nouvelles permissions, les permissions élargies apparaîtront lors de la prochaine émission (rafraîchissement ou demande de jeton). Un nouveau jeton est toujours requis, mais une ré-authentification complète n’est pas nécessaire sauf si les nouvelles portées dépassent l’ensemble de la demande initiale.</p>}

#### Recommandations \{#recommendations}

- Validez les portées dans votre API à chaque appel.
- Gardez une expiration de jeton courte.
- Ajoutez des notifications optionnelles si vous avez besoin d’une propagation immédiate des changements de permissions.
