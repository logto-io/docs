스코프 (Scope)는 애플리케이션이 사용자로부터 요청하는 권한 (Permission)을 정의하며, 애플리케이션이 Microsoft Entra ID 계정에서 접근할 수 있는 데이터를 제어합니다. Microsoft Graph 권한을 요청하려면 양쪽 모두에서 구성이 필요합니다:

**Microsoft Entra 관리 센터에서:**

1. **Microsoft Entra ID > 앱 등록**으로 이동하여 애플리케이션을 선택하세요.
2. **API 권한 > 권한 추가 > Microsoft Graph > 위임된 권한**으로 이동하세요.
3. 애플리케이션에 필요한 권한만 선택하세요:
   - OpenID 권한:
     - `openid` (필수) - 사용자를 로그인시킴
     - `profile` (필수) - 사용자의 기본 프로필 보기
     - `email` (필수) - 사용자의 이메일 주소 보기
     - `offline_access` (선택) - Logto 커넥터에서 [지속적인 API 접근을 위한 토큰 저장](#step-4-store-tokens-to-access-microsoft-apis-optional)을 활성화하고 Microsoft Graph API에 장기적으로 접근하기 위해 리프레시 토큰이 필요한 경우에만 필요합니다.
   - API 접근 (선택): 애플리케이션에 추가로 필요한 권한을 추가하세요. 일반적인 Microsoft Graph 권한에는 `Mail.Read`, `Calendars.Read`, `Files.Read` 등이 있습니다. 사용 가능한 권한은 [Microsoft Graph 권한 참조](https://docs.microsoft.com/en-us/graph/permissions-reference)에서 확인할 수 있습니다.
4. **권한 추가**를 클릭하여 선택을 확인하세요.
5. 애플리케이션이 특정 권한에 대해 관리자 동의를 필요로 하는 경우, **[조직 이름]에 대한 관리자 동의 부여**를 클릭하세요.

<center>
  <img src="/img/assets/entra_id_oidc_add_api_permissions.webp" alt="Microsoft API 권한 추가" />
</center>

**Logto Microsoft Entra ID 커넥터에서:**

1. Logto는 기본적으로 `openid`, `profile`, `email` 스코프를 포함하여 기본 사용자 아이덴티티 정보를 가져옵니다. 기본 사용자 정보만 필요하다면 `Scopes` 필드를 비워두어도 됩니다.
2. 지속적인 API 접근을 위해 토큰을 저장할 계획이라면 `Scopes` 필드에 `offline_access`를 추가하세요. 이 스코프는 장기 API 접근을 위한 리프레시 토큰을 활성화합니다.
3. Microsoft Graph에서 더 많은 데이터를 요청하려면 `Scopes` 필드에 추가 스코프를 (공백으로 구분하여) 입력하세요. 예시: `User.Read Mail.Read Calendars.Read`

:::tip

애플리케이션이 Microsoft Graph API에 접근하고 작업을 수행하기 위해 이러한 스코프를 요청하는 경우, Logto Microsoft Entra ID 커넥터에서 **지속적인 API 접근을 위한 토큰 저장**을 반드시 활성화하세요. 자세한 내용은 다음 섹션을 참고하세요.

:::
