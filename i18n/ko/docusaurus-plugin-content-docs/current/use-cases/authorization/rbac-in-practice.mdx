---
sidebar_position: 1
sidebar_label: ì‹¤ì „ RBAC
description: 'ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC) ì‹¤ì „ ê°€ì´ë“œ: ê¶Œí•œ ì„¤ê³„, ì—­í•  ê´€ë¦¬, CMSì—ì„œ ì•ˆì „í•œ ì¸ê°€ (Authorization) ì„¤ì • ë°©ë²•ì„ ë°°ì›Œë³´ì„¸ìš”.'
---

<head>
  <link rel="canonical" href="https://blog.logto.io/rbac-in-practice" />
</head>

# ì‹¤ì „ RBAC: ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ì•ˆì „í•œ ì¸ê°€ (Authorization) êµ¬í˜„í•˜ê¸°

ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì•ˆì „í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ ì¸ê°€ (Authorization) ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ëŠ” ë° ì–´ë ¤ì›€ì„ ê²ªê³  ê³„ì‹ ê°€ìš”? ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)ëŠ” ì‚¬ìš©ì ê¶Œí•œ ê´€ë¦¬ë¥¼ ìœ„í•œ ì—…ê³„ í‘œì¤€ì´ì§€ë§Œ, ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„í•˜ëŠ” ê²ƒì€ ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ì‹¤ì œ ì½˜í…ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ (CMS) ì˜ˆì œë¥¼ í†µí•´ ê²¬ê³ í•œ RBAC ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

ì´ ê°€ì´ë“œë¥¼ ë”°ë¼ê°€ë©´ ë‹¤ìŒì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- âœ¨ ì„¸ë°€í•œ ê¶Œí•œì„ ì„¤ê³„í•˜ê³  êµ¬í˜„í•˜ì—¬ ì •ë°€í•˜ê²Œ ì œì–´í•˜ëŠ” ë°©ë²•
- ğŸ”’ ì˜ë¯¸ ìˆëŠ” ì—­í• ë¡œ ê¶Œí•œì„ ì²´ê³„ì ìœ¼ë¡œ êµ¬ì„±í•˜ëŠ” ëª¨ë²” ì‚¬ë¡€
- ğŸ‘¤ ë¦¬ì†ŒìŠ¤ ì†Œìœ ê¶Œì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê¸°ë²•
- ğŸš€ ì¸ê°€ (Authorization) ì‹œìŠ¤í…œì„ í™•ì¥ ê°€ëŠ¥í•˜ê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰½ê²Œ ë§Œë“œëŠ” ë°©ë²•
- ğŸ’¡ ì‹¤ì œ CMS ì˜ˆì œë¥¼ í†µí•œ ì‹¤ì „ êµ¬í˜„

ì´ íŠœí† ë¦¬ì–¼ì˜ ì „ì²´ ì†ŒìŠ¤ ì½”ë“œëŠ” [GitHub](https://github.com/logto-io/rbac-sample) ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## RBAC ê¸°ë³¸ ì›ë¦¬ ì´í•´í•˜ê¸° \{#understanding-rbac-fundamentals}

ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)ëŠ” ë‹¨ìˆœíˆ ì‚¬ìš©ìì—ê²Œ ê¶Œí•œì„ í• ë‹¹í•˜ëŠ” ê²ƒ ì´ìƒì…ë‹ˆë‹¤. ë³´ì•ˆê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ê· í˜• ìˆê²Œ ê³ ë ¤í•œ êµ¬ì¡°ì ì¸ ì¸ê°€ (Authorization) ì ‘ê·¼ ë°©ì‹ì„ ë§Œë“œëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤.

[RBACë€ ë¬´ì—‡ì¸ê°€](https://auth-wiki.logto.io/rbac) ì— ëŒ€í•´ ë” ì•Œì•„ë³´ì„¸ìš” (Auth Wiki).

ìš°ë¦¬ì˜ êµ¬í˜„ì—ì„œ ë”°ë¥¼ ì£¼ìš” ì›ì¹™ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

### ì„¸ë°€í•œ ê¶Œí•œ ì„¤ê³„ \{#fine-grained-permission-design}

ì„¸ë°€í•œ ê¶Œí•œì€ ì‚¬ìš©ìê°€ ì‹œìŠ¤í…œì—ì„œ ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•´ ì •ë°€í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. "admin" ë˜ëŠ” "user"ì™€ ê°™ì€ ê´‘ë²”ìœ„í•œ ì ‘ê·¼ ìˆ˜ì¤€ ëŒ€ì‹ , ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ì‚¬ìš©ìê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ë™ì‘ì„ ì •ì˜í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:

- `read:articles` - ì‹œìŠ¤í…œ ë‚´ ëª¨ë“  ê¸°ì‚¬ ë³´ê¸°
- `create:articles` - ìƒˆ ê¸°ì‚¬ ìƒì„±
- `update:articles` - ê¸°ì¡´ ê¸°ì‚¬ ìˆ˜ì •
- `publish:articles` - ê¸°ì‚¬ ê²Œì‹œ ìƒíƒœ ë³€ê²½

### ë¦¬ì†ŒìŠ¤ ì†Œìœ ê¶Œê³¼ ì ‘ê·¼ ì œì–´ \{#resource-ownership-and-access-control}

ë¦¬ì†ŒìŠ¤ ì†Œìœ ê¶Œì€ CMS ì¸ê°€ (Authorization) ì„¤ê³„ì˜ í•µì‹¬ ê°œë…ì…ë‹ˆë‹¤. RBACê°€ ê° ì—­í• ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë™ì‘ì„ ì •ì˜í•˜ëŠ” ë°˜ë©´, ì†Œìœ ê¶Œì€ ì ‘ê·¼ ì œì–´ì— ê°œì¸ì ì¸ ì°¨ì›ì„ ë”í•©ë‹ˆë‹¤:

- ì‘ì„±ìëŠ” ìì‹ ì´ ìƒì„±í•œ ê¸°ì‚¬ì— ìë™ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì´ ìì—°ìŠ¤ëŸ¬ìš´ ì†Œìœ ê¶Œ ëª¨ë¸ ë•ë¶„ì— ì‘ì„±ìëŠ” í•­ìƒ ìì‹ ì˜ ì½˜í…ì¸ ë¥¼ ë³´ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì‹œìŠ¤í…œì€ ê¸°ì‚¬ ì‘ì—… ì‹œ ì—­í•  ê¶Œí•œ ë˜ëŠ” ì†Œìœ ê¶Œì„ ëª¨ë‘ í™•ì¸í•©ë‹ˆë‹¤
- ì˜ˆë¥¼ ë“¤ì–´, `update:articles` ê¶Œí•œì´ ì—†ì–´ë„ ì‘ì„±ìëŠ” ìì‹ ì˜ ê¸°ì‚¬ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì´ ì„¤ê³„ëŠ” ì¶”ê°€ì ì¸ ì—­í•  ê¶Œí•œ í•„ìš”ì„±ì„ ì¤„ì´ë©´ì„œë„ ë³´ì•ˆì„ ìœ ì§€í•©ë‹ˆë‹¤

ì´ì¤‘ ë ˆì´ì–´ ì ‘ê·¼ ë°©ì‹(ì—­í•  + ì†Œìœ ê¶Œ)ì€ ë” ì§ê´€ì ì´ê³  ì•ˆì „í•œ ì‹œìŠ¤í…œì„ ë§Œë“­ë‹ˆë‹¤. í¼ë¸”ë¦¬ì…”ì™€ ê´€ë¦¬ìëŠ” ì—­í•  ê¶Œí•œì„ í†µí•´ ëª¨ë“  ì½˜í…ì¸ ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê³ , ì‘ì„±ìëŠ” ìì‹ ì˜ ì‘ì—…ì„ ì§ì ‘ í†µì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì•ˆì „í•œ API ì„¤ê³„í•˜ê¸° \{#designing-a-secure-apis}

ì´ì œ CMSì˜ í•µì‹¬ ê¸°ëŠ¥ì„ API ì—”ë“œí¬ì¸íŠ¸ë¡œ ì„¤ê³„í•´ë´…ì‹œë‹¤:

```
GET    /api/articles         # ëª¨ë“  ê¸°ì‚¬ ëª©ë¡ ì¡°íšŒ
GET    /api/articles/:id     # íŠ¹ì • ê¸°ì‚¬ ì¡°íšŒ
POST   /api/articles        # ìƒˆ ê¸°ì‚¬ ìƒì„±
PATCH  /api/articles/:id    # ê¸°ì‚¬ ìˆ˜ì •
DELETE /api/articles/:id    # ê¸°ì‚¬ ì‚­ì œ
PATCH  /api/articles/:id/published  # ê²Œì‹œ ìƒíƒœ ë³€ê²½
```

### API ì ‘ê·¼ ì œì–´ êµ¬í˜„í•˜ê¸° \{#implement-access-control-for-your-api}

ê° ì—”ë“œí¬ì¸íŠ¸ë§ˆë‹¤ ì ‘ê·¼ ì œì–´ì˜ ë‘ ê°€ì§€ ì¸¡ë©´ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤:

1. ë¦¬ì†ŒìŠ¤ ì†Œìœ ê¶Œ - ì‚¬ìš©ìê°€ ì´ ë¦¬ì†ŒìŠ¤ì˜ ì†Œìœ ìì¸ê°€?
2. ì—­í•  ê¸°ë°˜ ê¶Œí•œ - ì‚¬ìš©ìì˜ ì—­í• ì´ ì´ ì‘ì—…ì„ í—ˆìš©í•˜ëŠ”ê°€?

ê° ì—”ë“œí¬ì¸íŠ¸ë³„ ì ‘ê·¼ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

| ì—”ë“œí¬ì¸íŠ¸                        | ì ‘ê·¼ ì œì–´ ë¡œì§                                                     |
| --------------------------------- | ------------------------------------------------------------------ |
| GET /api/articles                 | - `list:articles` ê¶Œí•œì´ ìˆê±°ë‚˜, ì‘ì„±ìëŠ” ìì‹ ì˜ ê¸°ì‚¬ë§Œ ë³¼ ìˆ˜ ìˆìŒ |
| GET /api/articles/:id             | - `read:articles` ê¶Œí•œì´ ìˆê±°ë‚˜, í•´ë‹¹ ê¸°ì‚¬ì˜ ì‘ì„±ì                |
| POST /api/articles                | - `create:articles` ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ì                             |
| PATCH /api/articles/:id           | - `update:articles` ê¶Œí•œì´ ìˆê±°ë‚˜, í•´ë‹¹ ê¸°ì‚¬ì˜ ì‘ì„±ì              |
| DELETE /api/articles/:id          | - `delete:articles` ê¶Œí•œì´ ìˆê±°ë‚˜, í•´ë‹¹ ê¸°ì‚¬ì˜ ì‘ì„±ì              |
| PATCH /api/articles/:id/published | - `publish:articles` ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œ ê°€ëŠ¥                     |

### í™•ì¥ ê°€ëŠ¥í•œ ê¶Œí•œ ì‹œìŠ¤í…œ ë§Œë“¤ê¸° \{#creating-a-permission-system-that-scales}

API ì ‘ê·¼ ìš”êµ¬ì‚¬í•­ì„ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê¶Œí•œì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

| ê¶Œí•œ             | ì„¤ëª…                          |
| ---------------- | ----------------------------- |
| list:articles    | ì‹œìŠ¤í…œ ë‚´ ëª¨ë“  ê¸°ì‚¬ ëª©ë¡ ë³´ê¸° |
| read:articles    | ëª¨ë“  ê¸°ì‚¬ì˜ ì „ì²´ ë‚´ìš© ì½ê¸°    |
| create:articles  | ìƒˆ ê¸°ì‚¬ ìƒì„±                  |
| update:articles  | ëª¨ë“  ê¸°ì‚¬ ìˆ˜ì •                |
| delete:articles  | ëª¨ë“  ê¸°ì‚¬ ì‚­ì œ                |
| publish:articles | ê²Œì‹œ ìƒíƒœ ë³€ê²½                |

ì´ ê¶Œí•œë“¤ì€ ìì‹ ì´ ì†Œìœ í•˜ì§€ ì•Šì€ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ë•Œë§Œ í•„ìš”í•©ë‹ˆë‹¤. ê¸°ì‚¬ ì†Œìœ ìëŠ” ìë™ìœ¼ë¡œ:

- ìì‹ ì˜ ê¸°ì‚¬ ë³´ê¸° (`read:articles` ë¶ˆí•„ìš”)
- ìì‹ ì˜ ê¸°ì‚¬ ìˆ˜ì • (`update:articles` ë¶ˆí•„ìš”)
- ìì‹ ì˜ ê¸°ì‚¬ ì‚­ì œ (`delete:articles` ë¶ˆí•„ìš”)

## íš¨ê³¼ì ì¸ ì—­í•  ë§Œë“¤ê¸° \{#building-effective-roles}

APIì™€ ê¶Œí•œì„ ì •ì˜í–ˆìœ¼ë‹ˆ, ì´ì œ ì´ ê¶Œí•œë“¤ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ë¬¶ëŠ” ì—­í• ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

| ê¶Œí•œ/ì—­í•         | ğŸ‘‘ ê´€ë¦¬ì(Admin)      | ğŸ“ í¼ë¸”ë¦¬ì…”(Publisher)           | âœï¸ ì‘ì„±ì(Author)      |
| ---------------- | --------------------- | -------------------------------- | ---------------------- |
| **ì„¤ëª…**         | ì „ì²´ ì½˜í…ì¸  ê´€ë¦¬ ê¶Œí•œ | ëª¨ë“  ê¸°ì‚¬ ë³´ê¸° ë° ê²Œì‹œ ìƒíƒœ ê´€ë¦¬ | ì‹œìŠ¤í…œ ë‚´ ìƒˆ ê¸°ì‚¬ ì‘ì„± |
| list:articles    | âœ…                    | âœ…                               | âŒ                     |
| read:articles    | âœ…                    | âœ…                               | âŒ                     |
| create:articles  | âœ…                    | âŒ                               | âœ…                     |
| update:articles  | âœ…                    | âŒ                               | âŒ                     |
| delete:articles  | âœ…                    | âŒ                               | âŒ                     |
| publish:articles | âœ…                    | âœ…                               | âŒ                     |

**ì°¸ê³ **: ì‘ì„±ìëŠ” ì—­í•  ê¶Œí•œê³¼ ìƒê´€ì—†ì´ ìì‹ ì˜ ê¸°ì‚¬ì— ëŒ€í•´ ì½ê¸°/ìˆ˜ì •/ì‚­ì œ ê¶Œí•œì„ ìë™ìœ¼ë¡œ ê°€ì§‘ë‹ˆë‹¤.

ê° ì—­í• ì€ íŠ¹ì • ì±…ì„ì„ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤:

- **ê´€ë¦¬ì(Admin)**: CMS ì „ì²´ ë° ëª¨ë“  ê¸°ì‚¬ ì‘ì—…ì— ëŒ€í•œ ì™„ì „í•œ ì œì–´ê¶Œ
- **í¼ë¸”ë¦¬ì…”(Publisher)**: ì½˜í…ì¸  ê²€í†  ë° ê²Œì‹œ ê´€ë¦¬ì— ì§‘ì¤‘
- **ì‘ì„±ì(Author)**: ì½˜í…ì¸  ìƒì„±ì— íŠ¹í™”

ì´ ì—­í•  êµ¬ì¡°ëŠ” ì±…ì„ì˜ ëª…í™•í•œ ë¶„ë¦¬ë¥¼ ë§Œë“­ë‹ˆë‹¤:

- ì‘ì„±ìëŠ” ì½˜í…ì¸  ìƒì„±ì— ì§‘ì¤‘
- í¼ë¸”ë¦¬ì…”ëŠ” ì½˜í…ì¸  í’ˆì§ˆ ë° ë…¸ì¶œ ê´€ë¦¬
- ê´€ë¦¬ìëŠ” ì „ì²´ ì‹œìŠ¤í…œ ì œì–´

## Logtoì—ì„œ RBAC ì„¤ì •í•˜ê¸° \{#config-rbac-in-logto}

ì‹œì‘í•˜ê¸° ì „ì— [Logto Cloud](https://cloud.logto.io) ì—ì„œ ê³„ì •ì„ ìƒì„±í•˜ê±°ë‚˜, [Logto OSS ë²„ì „](/logto-oss) ì„ ì‚¬ìš©í•´ ìì²´ í˜¸ìŠ¤íŒ… Logto ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ê°„ë‹¨íˆ Logto Cloudë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.

### ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • \{#setting-up-your-application}

1. Logto Consoleì˜ "ì• í”Œë¦¬ì¼€ì´ì…˜"ì—ì„œ ìƒˆ React ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒì„±í•˜ì„¸ìš”.
   - ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„: Content Management System
   - ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•: ì „í†µì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
   - Redirect URI: http://localhost:5173/callback

![CMS React application](https://uploads.strapi.logto.io/cms_application_3ed42f2256.png)

### API ë¦¬ì†ŒìŠ¤ ë° ê¶Œí•œ ì„¤ì • \{#configuring-api-resources-and-permissions}

1. Logto Consoleì˜ "API ë¦¬ì†ŒìŠ¤"ì—ì„œ ìƒˆ API ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ì„¸ìš”.
   - API ì´ë¦„: CMS API
   - API ì‹ë³„ì: https://api.cms.com
   - API ë¦¬ì†ŒìŠ¤ì— ê¶Œí•œ ì¶”ê°€
     - `list:articles`
     - `read:articles`
     - `create:articles`
     - `update:articles`
     - `publish:articles`
     - `delete:articles`

![CMS API resource details](https://uploads.strapi.logto.io/cms_api_resource_b15ae2b91a.png)

### ì—­í•  ìƒì„± \{#creating-roles}

Logto Consoleì˜ ì—­í• (Roles)ì—ì„œ CMSë¥¼ ìœ„í•œ ë‹¤ìŒ ì—­í• ì„ ìƒì„±í•˜ì„¸ìš”.

- Admin
  - ëª¨ë“  ê¶Œí•œ í¬í•¨
- Publisher
  - `read:articles`, `list:articles`, `publish:articles` ê¶Œí•œ í¬í•¨
- Author
  - `create:articles` ê¶Œí•œ í¬í•¨

![Admin role](https://uploads.strapi.logto.io/admin_role_53edb35ecf.png)

![Publisher role](https://uploads.strapi.logto.io/publisher_role_2ac205cc32.png)

![Author role](https://uploads.strapi.logto.io/author_role_f89cd99543.png)

### ì‚¬ìš©ìì—ê²Œ ì—­í•  í• ë‹¹ \{#assigning-roles-to-users}

Logto Consoleì˜ "ì‚¬ìš©ì ê´€ë¦¬" ì„¹ì…˜ì—ì„œ ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ì„¸ìš”.

ì‚¬ìš©ì ìƒì„¸ ì •ë³´ì˜ "Roles" íƒ­ì—ì„œ ì‚¬ìš©ìì—ê²Œ ì—­í• ì„ í• ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ 3ëª…ì˜ ì‚¬ìš©ìë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

- Alex: Admin
- Bob: Publisher
- Charlie: Author

![User management](https://uploads.strapi.logto.io/user_management_c0bc17119f.png)

![User details - Alex](https://uploads.strapi.logto.io/user_details_alex_702f96ef9a.png)

:::note
ë°ëª¨ ëª©ì ìƒ Logto Consoleì„ í†µí•´ ì´ ë¦¬ì†ŒìŠ¤ì™€ ì„¤ì •ì„ ìƒì„±í•©ë‹ˆë‹¤. ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œëŠ” Logtoì—ì„œ ì œê³µí•˜ëŠ” [Management API](/integrate-logto/interact-with-management-api) ë¥¼ ì‚¬ìš©í•´ í”„ë¡œê·¸ë˜ë°ì ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ì™€ ì„¤ì •ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

## í”„ë¡ íŠ¸ì—”ë“œì— Logto RBAC ì—°ë™í•˜ê¸° \{#integrate-your-frontend-with-logto-rbac}

ì´ì œ Logtoì—ì„œ RBACë¥¼ ì„¤ì •í–ˆìœ¼ë‹ˆ, í”„ë¡ íŠ¸ì—”ë“œì— ì—°ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¨¼ì € [Logto ë¹ ë¥¸ ì‹œì‘](/quick-starts) ì„ ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— Logtoë¥¼ ì—°ë™í•˜ì„¸ìš”.

ì˜ˆì‹œì—ì„œëŠ” [React](/quick-starts/react) ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì• í”Œë¦¬ì¼€ì´ì…˜ì— Logtoë¥¼ ì„¤ì •í•œ í›„, Logtoê°€ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ RBAC ì„¤ì •ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

```tsx
// frontend/src/App.tsx

const logtoConfig: LogtoConfig = {
  appId: LOGTO_APP_ID, // Logto Consoleì—ì„œ ìƒì„±í•œ ì•± ID
  endpoint: LOGTO_ENDPOINT, // Logto Consoleì—ì„œ ìƒì„±í•œ ì—”ë“œí¬ì¸íŠ¸
  resources: [API_RESOURCE], // Logto Consoleì—ì„œ ìƒì„±í•œ API ë¦¬ì†ŒìŠ¤ ì‹ë³„ì, ì˜ˆ: https://api.cms.com
  // í”„ë¡ íŠ¸ì—”ë“œì—ì„œ API ë¦¬ì†ŒìŠ¤ì— ìš”ì²­í•  ëª¨ë“  ìŠ¤ì½”í”„
  scopes: [
    'list:articles',
    'create:articles',
    'read:articles',
    'update:articles',
    'delete:articles',
    'publish:articles',
  ],
};
```

ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœë¼ë©´, ì´ ë³€ê²½ ì‚¬í•­ì´ ì ìš©ë˜ë„ë¡ ë°˜ë“œì‹œ ë¡œê·¸ì•„ì›ƒ í›„ ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ì„¸ìš”.

ì‚¬ìš©ìê°€ Logtoë¡œ ë¡œê·¸ì¸í•˜ê³  ìœ„ì—ì„œ ì§€ì •í•œ API ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ í† í°ì„ ìš”ì²­í•˜ë©´, LogtoëŠ” ì‚¬ìš©ìì˜ ì—­í• ê³¼ ê´€ë ¨ëœ ìŠ¤ì½”í”„(ê¶Œí•œ)ë¥¼ ì•¡ì„¸ìŠ¤ í† í°ì— ì¶”ê°€í•©ë‹ˆë‹¤.

`useLogto` í›…ì˜ `getAccessTokenClaims`ë¥¼ ì‚¬ìš©í•´ ì•¡ì„¸ìŠ¤ í† í°ì—ì„œ ìŠ¤ì½”í”„ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// frontend/src/hooks/use-user-data.ts

import { useLogto } from '@logto/react';
import { API_RESOURCE } from '../config';
import { useState, useEffect } from 'react';

export const useUserData = () => {
  const { getAccessTokenClaims } = useLogto();
  const [userScopes, setUserScopes] = useState<string[]>([]);
  const [userId, setUserId] = useState<string>();

  useEffect(() => {
    const fetchScopes = async () => {
      const token = await getAccessTokenClaims(API_RESOURCE);
      setUserScopes(token?.scope?.split(' ') ?? []);
      setUserId(token?.sub);
    };

    fetchScopes();
  }, [getAccessTokenClaims]);

  return { userId, userScopes };
};
```

ê·¸ë¦¬ê³  `userScopes`ë¥¼ ì‚¬ìš©í•´ ì‚¬ìš©ìê°€ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// frontend/src/pages/Dashboard.tsx

const Dashboard = () => {
  const { userId, userScopes } = useUserData();
  // ...

  return (
    <div>
      {/* ... */}
      {(userScopes.includes('delete:articles') || article.ownerId === userId) && (
        <button
          onClick={() => handleDelete(article.id)}
          className="text-red-600 hover:text-red-900"
        >
          Delete
        </button>
      )}
    </div>
  );
};
```

## ë°±ì—”ë“œì— Logto RBAC ì—°ë™í•˜ê¸° \{#integrate-your-backend-with-logto-rbac}

ì´ì œ Logto RBACë¥¼ ë°±ì—”ë“œì— ì—°ë™í•  ì°¨ë¡€ì…ë‹ˆë‹¤.

### ë°±ì—”ë“œ ì¸ê°€ (Authorization) ë¯¸ë“¤ì›¨ì–´ \{#backend-authorization-middleware}

ë¨¼ì €, ë°±ì—”ë“œì—ì„œ ì‚¬ìš©ì ê¶Œí•œì„ í™•ì¸í•˜ê³ , ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í–ˆëŠ”ì§€, íŠ¹ì • APIì— ì ‘ê·¼í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

```javascript
// backend/src/middleware/auth.js

const { createRemoteJWKSet, jwtVerify } = require('jose');

const getTokenFromHeader = (headers) => {
  const { authorization } = headers;
  const bearerTokenIdentifier = 'Bearer';

  if (!authorization) {
    throw new Error('Authorization header missing');
  }

  if (!authorization.startsWith(bearerTokenIdentifier)) {
    throw new Error('Authorization token type not supported');
  }

  return authorization.slice(bearerTokenIdentifier.length + 1);
};

const hasScopes = (tokenScopes, requiredScopes) => {
  if (!requiredScopes || requiredScopes.length === 0) {
    return true;
  }
  const scopeSet = new Set(tokenScopes);
  return requiredScopes.every((scope) => scopeSet.has(scope));
};

const verifyJwt = async (token) => {
  const JWKS = createRemoteJWKSet(new URL(process.env.LOGTO_JWKS_URL));

  const { payload } = await jwtVerify(token, JWKS, {
    issuer: process.env.LOGTO_ISSUER,
    audience: process.env.LOGTO_API_RESOURCE,
  });

  return payload;
};

const requireAuth = (requiredScopes = []) => {
  return async (req, res, next) => {
    try {
      // Extract the token
      const token = getTokenFromHeader(req.headers);

      // Verify the token
      const payload = await verifyJwt(token);

      // Add user info to request
      req.user = {
        id: payload.sub,
        scopes: payload.scope?.split(' ') || [],
      };

      // Verify required scopes
      if (!hasScopes(req.user.scopes, requiredScopes)) {
        throw new Error('Insufficient permissions');
      }

      next();
    } catch (error) {
      res.status(401).json({ error: 'Unauthorized' });
    }
  };
};

module.exports = {
  requireAuth,
  hasScopes,
};
```

ì´ ë¯¸ë“¤ì›¨ì–´ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œ ìš”ì²­ì— ìœ íš¨í•œ ì•¡ì„¸ìŠ¤ í† í°ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì•¡ì„¸ìŠ¤ í† í°ì˜ audienceê°€ Logto Consoleì—ì„œ ìƒì„±í•œ API ë¦¬ì†ŒìŠ¤ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.

API ë¦¬ì†ŒìŠ¤ë¥¼ ê²€ì¦í•˜ëŠ” ì´ìœ ëŠ”, ìš°ë¦¬ì˜ API ë¦¬ì†ŒìŠ¤ê°€ ì‹¤ì œë¡œ CMS ë°±ì—”ë“œì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ëŒ€í‘œí•˜ë©°, ëª¨ë“  CMS ê¶Œí•œì´ ì´ API ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°ë˜ì–´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì´ API ë¦¬ì†ŒìŠ¤ê°€ Logtoì—ì„œ CMS ë¦¬ì†ŒìŠ¤ë¥¼ ëŒ€í‘œí•˜ë¯€ë¡œ, í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œì—ì„œëŠ” ë°±ì—”ë“œì— API ìš”ì²­ì„ ë³´ë‚¼ ë•Œ í•´ë‹¹ ì•¡ì„¸ìŠ¤ í† í°ì„ í•¨ê»˜ ì „ì†¡í•©ë‹ˆë‹¤:

```typescript
// frontend/src/hooks/use-api.ts
export const useApi = () => {
  const { getAccessToken } = useLogto();

  return useMemo(
    () =>
      async (endpoint: string, options: RequestInit = {}) => {
        try {
          // Get the access token for the API resource
          const token = await getAccessToken(API_RESOURCE);

          if (!token) {
            throw new ApiRequestError('Failed to get access token');
          }

          const response = await fetch(`${API_BASE_URL}${endpoint}`, {
            ...options,
            headers: {
              'Content-Type': 'application/json',
              // Add the access token to the request headers
              Authorization: `Bearer ${token}`,
              ...options.headers,
            },
          });

          // ... handle response

          return await response.json();
        } catch (error) {
          // ... error handling
        }
      },
    [getAccessToken]
  );
};
```

ì´ì œ `requireAuth` ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•´ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë³´í˜¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### API ì—”ë“œí¬ì¸íŠ¸ ë³´í˜¸í•˜ê¸° \{#protecting-api-endpoints}

íŠ¹ì • ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” APIì˜ ê²½ìš°, ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì§ì ‘ ì œí•œì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê¸°ì‚¬ ìƒì„± APIëŠ” `create:articles` ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
// backend/src/routes/articles.js

const { requireAuth } = require('../middleware/auth');

router.post('/articles', requireAuth(['create:articles']), async (req, res) => {
  // ...
});
```

ê¶Œí•œê³¼ ë¦¬ì†ŒìŠ¤ ì†Œìœ ê¶Œì„ ëª¨ë‘ í™•ì¸í•´ì•¼ í•˜ëŠ” APIì˜ ê²½ìš°, `hasScopes` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê¸°ì‚¬ ëª©ë¡ APIì—ì„œëŠ” `list:articles` ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìëŠ” ëª¨ë“  ê¸°ì‚¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆê³ , ì‘ì„±ìëŠ” ìì‹ ì´ ì‘ì„±í•œ ê¸°ì‚¬ë§Œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
// backend/src/routes/articles.js

const { requireAuth, hasScopes } = require('../middleware/auth');

router.get('/articles', requireAuth(), async (req, res) => {
  try {
    // If user has list:articles scope, return all articles
    if (hasScopes(req.user.scopes, ['list:articles'])) {
      const articles = await articleDB.list();
      return res.json(articles);
    }

    // Otherwise, return only user's articles
    const articles = await articleDB.listByOwner(req.user.id);
    res.json(articles);
  } catch (error) {
    res.status(500).json({ error: 'Failed to fetch articles' });
  }
});
```

ì´ì œ RBAC êµ¬í˜„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. [ì „ì²´ ì†ŒìŠ¤ ì½”ë“œ](https://github.com/logto-io/rbac-sample) ë¥¼ ì°¸ê³ í•´ ì „ì²´ êµ¬í˜„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## CMS RBAC êµ¬í˜„ í…ŒìŠ¤íŠ¸í•˜ê¸° \{#test-the-cms-rbac-implementation}

ì´ì œ ì•ì„œ ìƒì„±í•œ ì„¸ ëª…ì˜ ì‚¬ìš©ìë¥¼ ì´ìš©í•´ CMS RBAC êµ¬í˜„ì„ í…ŒìŠ¤íŠ¸í•´ë´…ì‹œë‹¤.

:::note
"ì‚¬ìš©ì ê´€ë¦¬"ì—ì„œ ìƒì„±í•œ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ì—†ë‹¤ë©´, ë¨¼ì € ì ì ˆí•œ ë¡œê·¸ì¸ ë°©ì‹ì„ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤. Logto Consoleì˜ "ë¡œê·¸ì¸ ê²½í—˜"ì—ì„œ ì›í•˜ëŠ” ì¸ì¦ (Authentication) ë°©ì‹ì„ í™œì„±í™”í•˜ì„¸ìš” (ì˜ˆ: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ ë˜ëŠ” ì‚¬ìš©ìëª… + ë¹„ë°€ë²ˆí˜¸).
:::

ë¨¼ì € Alexì™€ Charlesë¡œ ê°ê° ë¡œê·¸ì¸í•˜ì—¬ ê¸°ì‚¬ë¥¼ ìƒì„±í•´ë´…ì‹œë‹¤.

AlexëŠ” Admin ì—­í• ì´ë¯€ë¡œ, ê¸°ì‚¬ ìƒì„±, ì‚­ì œ, ìˆ˜ì •, ê²Œì‹œ, ëª¨ë“  ê¸°ì‚¬ ë³´ê¸° ë“±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

![CMS dashboard - Alex](https://uploads.strapi.logto.io/cms_dashboard_alex_a11863a94b.png)

CharlesëŠ” Author ì—­í• ë¡œ, ìì‹ ì˜ ê¸°ì‚¬ë§Œ ìƒì„±/ë³´ê¸°/ìˆ˜ì •/ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![CMS dashboard - Charles - Article list](https://uploads.strapi.logto.io/cms_dashboard_charles_05f610066a.png)

Bobì€ Publisher ì—­í• ë¡œ, ëª¨ë“  ê¸°ì‚¬ ë³´ê¸° ë° ê²Œì‹œë§Œ ê°€ëŠ¥í•˜ë©°, ìƒì„±/ìˆ˜ì •/ì‚­ì œëŠ” í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

![CMS dashboard - Bob](https://uploads.strapi.logto.io/cms_dashboard_bob_421a429b69.png)

## ê²°ë¡  \{#conclusion}

ì¶•í•˜í•©ë‹ˆë‹¤! ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê²¬ê³ í•œ RBAC ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤.

ë©€í‹° í…Œë„ŒíŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶• ë“± ë” ë³µì¡í•œ ì‹œë‚˜ë¦¬ì˜¤ê°€ í•„ìš”í•˜ë‹¤ë©´, LogtoëŠ” ì¡°ì§(Organization) ë‹¨ìœ„ì˜ ì ‘ê·¼ ì œì–´ë¥¼ ìœ„í•œ í¬ê´„ì ì¸ ì§€ì›ì„ ì œê³µí•©ë‹ˆë‹¤. ì¡°ì§ ì „ì²´ ì ‘ê·¼ ì œì–´ êµ¬í˜„ì— ëŒ€í•´ ë” ì•Œê³  ì‹¶ë‹¤ë©´ [ë©€í‹° í…Œë„ŒíŠ¸ SaaS ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶•: ì„¤ê³„ë¶€í„° êµ¬í˜„ê¹Œì§€ ì™„ë²½ ê°€ì´ë“œ](https://blog.logto.io/build-multi-tenant-saas) ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

í–‰ë³µí•œ ì½”ë”© ë˜ì„¸ìš”! ğŸš€
