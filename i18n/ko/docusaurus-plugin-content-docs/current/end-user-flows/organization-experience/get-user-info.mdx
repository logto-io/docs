---
sidebar_position: 4
---

# 조직 내에서 사용자 정보 가져오기

## 사용처 \{#where-to-use-it}

이 기능은 일반적으로 사용자의 조직 정보를 보여주어야 하는 사용자 프로필 페이지에서 사용됩니다.

<img src="/img/assets/user-info-page.png" alt="조직 사용자 정보" />

## 구현 방법 \{#how-to-implement-it}

조직 내에서 사용자 정보를 가져오는 방법은 두 가지가 있습니다.

### ID 토큰(ID token) 디코딩하기 \{#decode-the-id-token}

ID 토큰(ID token)은 사용자 프로필 정보와 조직 관련 클레임(Claim)을 포함하는 표준 JWT입니다. SDK의 `decodeIdToken()` 메서드를 호출하면 다음과 같은 JSON 객체를 얻을 수 있습니다:

```json
{
  "sub": "aauqbb63vg4s",
  "name": "John Doe",
  "picture": "https://example.com/johndoe.png",
  "email": "johndoe@example.com",
  // ...
  "organizations": [
    "organization-id-1",
    "organization-id-2",
    "organization-id-3"
    // ...
  ],
  "organization_roles": [
    "organization-id-1:admin",
    "organization-id-2:member",
    "organization-id-3:viewer"
    // ...
  ],
  "aud": "admin-console"
  // ...
}
```

하지만 ID 토큰(ID token)은 인증(Authentication) 시에만 발급되며, 이후 사용자 프로필이 변경될 경우 오래된 정보가 될 수 있습니다.
가장 최신 정보를 얻으려면 아래의 두 번째 방법을 사용하거나, `clearAllTokens()`를 호출한 후 인증(Authentication) 플로우를 다시 시작하여 새로운 ID 토큰(ID token)을 받아야 합니다.

```ts
await logtoClient.clearAllTokens();
logtoClient.signIn({
  redirectUri: 'https://your-app.com/callback',
  prompt: 'consent',
});
```

세션이 여전히 유효하다면, `signIn` 호출은 자격 증명 입력 없이 앱으로 다시 리디렉션됩니다. 사용자 입장에서는 앱이 단순히 새로고침되고, 백그라운드에서 새로운 ID 토큰(ID token)이 발급됩니다.

### `/oidc/me` 엔드포인트에서 사용자 정보 가져오기 \{#fetch-user-info-from-the-oidc-me-endpoint}

조직 컨텍스트에서 실시간 사용자 정보를 얻으려면 `/oidc/me`를 요청할 수도 있습니다. SDK의 `fetchUserInfo()` 메서드를 호출하세요.

:::tip[불투명 토큰(Opaque token) 지원]
[불투명 토큰(Opaque token)](/concepts/opaque-token) (API 리소스가 지정되지 않았을 때 발급됨)을 사용하는 경우에도 userinfo 엔드포인트를 통해 조직 멤버십 정보를 조회할 수 있습니다. `urn:logto:scope:organizations` 스코프(Scope)를 요청하면 응답에 `organizations` 및 기타 조직 관련 클레임(Claim)이 포함됩니다.

불투명 토큰(Opaque token)은 조직별 리소스에 접근하는 조직 토큰(Organization token)으로 사용할 수 없다는 점에 유의하세요. 자세한 내용은 [불투명 토큰(Opaque token)과 조직](/concepts/opaque-token#opaque-token-and-organizations)을 참고하세요.
:::
