### 선택 사항: 사용자 권한 변경 처리 \{#optional-handle-user-permission-change}

사용자 권한은 언제든지 변경될 수 있습니다. Logto는 RBAC를 위해 JWT를 발급하므로, 권한 업데이트는 새로 발급된 토큰에만 반영되며 기존 JWT는 절대 수정되지 않습니다.

:::info 스코프 (Scope) 하위 집합 규칙
액세스 토큰 (Access token)은 원래 OAuth 인가 (Authorization) 플로우에서 요청된 스코프 (Scope)만 포함할 수 있습니다.
사용자가 새로운 권한을 얻더라도, 이후에 발급된 토큰은 원래 요청된 스코프의 하위 집합만 포함할 수 있습니다.
초기 요청에 포함되지 않은 새로 부여된 스코프에 접근하려면, 클라이언트는 새로운 인가 (Authorization) 플로우를 실행해야 합니다.
:::

#### 축소된 권한 (Downscoped permissions) \{#downscoped-permissions}

사용자가 권한을 잃었을 때:

- 새로 발급된 토큰은 즉시 축소된 스코프를 반영합니다.
- 기존 JWT는 만료될 때까지 이전 스코프를 유지합니다.
- API에서는 항상 스코프를 검증하고, 짧은 토큰 수명을 사용하는 것이 좋습니다.

더 빠른 반응이 필요하다면, 클라이언트에게 토큰을 새로고침하라는 신호를 직접 구현하세요.

#### 확장된 권한 (Enlarged permissions) \{#enlarged-permissions}

{props.type === "global" && <p>글로벌 API 리소스의 경우, 사용자가 권한을 얻으면 확장된 권한은 새로고침을 통해 나타나지 않습니다. 클라이언트는 새로운 OAuth 인가 (Authorization) 플로우를 수행해야 새로운 스코프가 포함된 토큰을 받을 수 있습니다. 사용자가 활성 Logto 세션을 가지고 있다면 이 과정은 자동으로(조용히) 진행될 수 있습니다.</p>}

{props.type === "organization" && <p>조직 토큰의 경우, 사용자가 권한을 얻으면 확장된 권한은 다음 발급(새로고침 또는 토큰 요청) 시 반영됩니다. 새로운 토큰이 필요하지만, 새로운 스코프가 원래 요청 범위를 초과하지 않는 한 전체 재인증은 필요하지 않습니다.</p>}

#### 권장 사항 \{#recommendations}

- API 호출마다 스코프를 검증하세요.
- 토큰 만료 시간을 짧게 유지하세요.
- 즉각적인 권한 변경 전파가 필요하다면, 선택적으로 알림 기능을 추가하세요.
