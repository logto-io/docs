import TabItem from '@theme/TabItem';
import Tabs from '@theme/Tabs';

<Tabs groupId="api-framework">
  <TabItem value="rails" label="Rails">

```ruby title="app/controllers/application_controller.rb"
class ApplicationController < ActionController::API # API 전용 앱의 경우
# class ApplicationController < ActionController::Base # 전체 Rails 앱의 경우
  include JwtAuthentication
end
```

```ruby title="app/controllers/api/protected_controller.rb"
class Api::ProtectedController < ApplicationController
  before_action :verify_access_token

  def index
    # @auth에서 인증 (Authentication) 정보에 접근
    render json: { auth: @auth.to_h }
  end

  def show
    # 보호된 엔드포인트 로직
    render json: {
      auth: @auth.to_h,
      message: "보호된 데이터에 성공적으로 접근했습니다"
    }
  end
end
```

```ruby title="config/routes.rb"
Rails.application.routes.draw do
  namespace :api do
    resources :protected, only: [:index, :show]
  end
end
```

  </TabItem>
  <TabItem value="sinatra" label="Sinatra">

```ruby title="app.rb"
require 'sinatra'
require 'json'
require_relative 'auth_middleware'
require_relative 'auth_constants'
require_relative 'auth_info'
require_relative 'authorization_error'
require_relative 'auth_helpers'
require_relative 'jwt_validator'

# 미들웨어 적용
use AuthMiddleware

get '/api/protected' do
  content_type :json

  # env에서 인증 (Authentication) 정보에 접근
  auth = env['auth']
  { auth: auth.to_h }.to_json
end

get '/api/protected/:id' do
  content_type :json

  # 보호된 엔드포인트 로직
  auth = env['auth']
  {
    auth: auth.to_h,
    id: params[:id],
    message: "보호된 데이터에 성공적으로 접근했습니다"
  }.to_json
end

# 공개 엔드포인트 (미들웨어로 보호되지 않음)
get '/' do
  content_type :json
  { message: "공개 엔드포인트" }.to_json
end
```

  </TabItem>
  <TabItem value="grape" label="Grape">

```ruby title="api.rb"
require 'grape'
require_relative 'auth_helpers'
require_relative 'auth_constants'
require_relative 'auth_info'
require_relative 'authorization_error'
require_relative 'jwt_validator'

class API < Grape::API
  format :json

  helpers GrapeAuthHelpers

  namespace :api do
    namespace :protected do
      before do
        authenticate_user!
      end

      get do
        # 인증 (Authentication) 헬퍼에서 정보에 접근
        { auth: auth.to_h }
      end

      get ':id' do
        # 보호된 엔드포인트 로직
        {
          auth: auth.to_h,
          id: params[:id],
          message: "보호된 데이터에 성공적으로 접근했습니다"
        }
      end
    end
  end

  # 공개 엔드포인트 (보호되지 않음)
  get :public do
    { message: "공개 엔드포인트" }
  end
end
```

```ruby title="config.ru"
require_relative 'api'

run API
```

  </TabItem>
</Tabs>
