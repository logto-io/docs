---
slug: /quick-starts/next-app-router
sidebar_label: Next.js (App Router)
sidebar_custom_props:
  logoFilename: 'next.svg'
  darkLogoFilename: 'next-dark.svg'
  description: Next.js App Router ist ein neues Paradigma zum Erstellen von Anwendungen mit den neuesten Funktionen von React.
---

import ApiResourcesDescription from '../../fragments/_api-resources-description.md';
import FurtherReadings from '../../fragments/_further-readings.md';
import ExternalStorage from '../next/_external-storage.mdx';
import Installation from '../next/_installation.mdx';

import GetUserInformation from './_get-user-information.mdx';
import GuideTip from './_guide-tip.mdx';
import Integration from './_integration.mdx';
import ConfigApiResources from './api-resources/_config-api-resources.mdx';
import FetchAccessTokenForApiResources from './api-resources/_fetch-access-token-for-api-resources.mdx';
import FetchOrganizationTokenForUser from './api-resources/_fetch-organization-token-for-user.mdx';

# Authentifizierung zu deiner Next.js (App Router)-Anwendung hinzufügen (Add authentication to your Next.js (App Router) application)

<GuideTip />

## Voraussetzungen \{#prerequisites}

- Ein [Logto Cloud](https://cloud.logto.io)-Konto oder eine [selbst gehostete Logto](/introduction/set-up-logto-oss).
- Eine erstellte traditionelle Logto-Anwendung.

## Installation \{#installation}

<Installation />

## Integration \{#integration}

<Integration />

## Benutzerinformationen abrufen \{#fetch-user-information}

<GetUserInformation />

## API-Ressourcen \{#api-resources}

<ApiResourcesDescription />

### Logto-Client konfigurieren \{#configure-logto-client}

<ConfigApiResources />

### Zugangstoken für die API-Ressource abrufen \{#fetch-access-token-for-the-api-resource}

<FetchAccessTokenForApiResources />

Wenn du ein Zugangstoken im Server-Component abrufen musst, kannst du die Funktion `getAccessTokenRSC` verwenden:

```tsx title="app/page.tsx"
import { getAccessTokenRSC } from '@logto/next/server-actions';
import { logtoConfig } from './logto';

export default async function Home() {
  const accessToken = await getAccessTokenRSC(logtoConfig, 'https://shopping.your-app.com/api');

  return (
    <main>
      <p>Zugangstoken: {accessToken}</p>
    </main>
  );
}
```

:::tip

HTTP erlaubt das Setzen von Cookies nach Beginn des Streamings nicht, daher kann `getAccessTokenRSC` den Cookie-Wert nicht aktualisieren. Wenn das Zugangstoken also aktualisiert wird, bleibt es nicht in der Sitzung erhalten. Es wird empfohlen, die Funktion `getAccessToken` auf der Client-Seite oder in Route-Handlern zu verwenden.

:::

### Organisationstokens abrufen \{#fetch-organization-tokens}

<FetchOrganizationTokenForUser />

Wenn du ein Organisationstoken im Server-Component abrufen musst, kannst du die Funktion `getOrganizationTokenRSC` verwenden:

```tsx title="app/page.tsx"
import { getOrganizationTokenRSC } from '@logto/next/server-actions';
import { logtoConfig } from './logto';

export default async function Home() {
  const token = await getOrganizationTokenRSC(logtoConfig, 'organization-id');

  return (
    <main>
      <p>Organisationstoken: {token}</p>
    </main>
  );
}
```

:::tip

HTTP erlaubt das Setzen von Cookies nach Beginn des Streamings nicht, daher kann `getOrganizationTokenRSC` den Cookie-Wert nicht aktualisieren. Wenn das Zugangstoken also aktualisiert wird, bleibt es nicht in der Sitzung erhalten. Es wird empfohlen, die Funktion `getOrganizationToken` auf der Client-Seite oder in Route-Handlern zu verwenden.

:::

## Externen Sitzungspeicher verwenden \{#use-external-session-storage}

<ExternalStorage />

## Automatische Weiterleitung zur Anmeldung bei fehlender Berechtigung \{#automatic-sign-in-redirect\}

:::tip
Der `signIn`-Helper ändert Cookies, um die Anmeldesitzung zu erstellen, daher kann er nicht direkt in einer React Server Component (RSC) aufgerufen werden. Um die Anmeldung automatisch auszulösen, wenn eine RSC einen nicht autorisierten Benutzer erkennt, rufe `signIn` in einem dedizierten Route-Handler auf und leite zu dieser Route weiter.
:::

```ts title="app/sign-in/route.ts"
import { signIn } from '@logto/next/server-actions';
import { logtoConfig } from '../../logto';

export async function GET() {
  await signIn(logtoConfig);
}
```

```tsx title="app/protected/page.tsx"
import { getLogtoContext } from '@logto/next/server-actions';
import { redirect } from 'next/navigation';
import { logtoConfig } from '../logto';

export default async function ProtectedPage() {
  const { isAuthenticated } = await getLogtoContext(logtoConfig);

  if (!isAuthenticated) {
    redirect('/sign-in');
  }

  return <div>Geschützter Inhalt</div>;
}
```

## Weiterführende Literatur \{#further-readings}

<FurtherReadings />
