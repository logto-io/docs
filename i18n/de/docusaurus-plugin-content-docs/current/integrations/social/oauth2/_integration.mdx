## Erstelle deine OAuth-App \{#create-your-oauth-app}

Wenn du diese Seite öffnest, gehen wir davon aus, dass du bereits weißt, mit welchem sozialen Identitätsanbieter du dich verbinden möchtest. Das Erste, was du tun solltest, ist zu bestätigen, dass der Identitätsanbieter das OAuth-Protokoll unterstützt, da dies eine Voraussetzung für die Konfiguration eines gültigen Connectors ist. Folge dann den Anweisungen des Identitätsanbieters, um die entsprechende App für die OAuth-Autorisierung zu registrieren und zu erstellen.

## Konfiguriere deinen Connector \{#configure-your-connector}

Wir unterstützen AUSSCHLIESSLICH den "Authorization Code" Grant-Typ aus Sicherheitsgründen, und dieser passt perfekt zum Szenario von Logto.

`clientId` und `clientSecret` findest du auf der Detailseite deiner OAuth-App.

_clientId_: Die Client-ID ist ein eindeutiger Bezeichner, der die Client-Anwendung während der Registrierung beim Aussteller (Issuer) identifiziert. Diese ID wird vom Aussteller verwendet, um die Identität der Client-Anwendung zu überprüfen und alle autorisierten Zugangstokens mit dieser spezifischen Client-Anwendung zu verknüpfen.

_clientSecret_: Das Client-Secret ist ein vertraulicher Schlüssel, der der Client-Anwendung vom Aussteller während der Registrierung ausgestellt wird. Die Client-Anwendung verwendet diesen geheimen Schlüssel, um sich beim Aussteller zu authentifizieren, wenn Zugangstokens angefordert werden. Das Client-Secret gilt als vertrauliche Information und sollte stets sicher aufbewahrt werden.

_tokenEndpointAuthMethod_: Die Authentifizierungsmethode für den Token-Endpunkt wird von der Client-Anwendung verwendet, um sich beim Aussteller zu authentifizieren, wenn Zugangstokens angefordert werden. Um unterstützte Methoden zu entdecken, konsultiere das Feld `token_endpoint_auth_methods_supported`, das am OpenID Connect Discovery-Endpunkt des OAuth 2.0-Dienstanbieters verfügbar ist, oder schaue in die entsprechende Dokumentation des OAuth 2.0-Dienstanbieters.

_clientSecretJwtSigningAlgorithm (Optional)_: Nur erforderlich, wenn `tokenEndpointAuthMethod` auf `client_secret_jwt` gesetzt ist. Der Client-Secret-JWT-Signaturalgorithmus wird von der Client-Anwendung verwendet, um das JWT zu signieren, das während der Token-Anfrage an den Aussteller gesendet wird.

_scope_: Der Scope-Parameter wird verwendet, um die Menge an Ressourcen und Berechtigungen (Scopes) anzugeben, auf die die Client-Anwendung zugreifen möchte. Der Scope-Parameter wird typischerweise als durch Leerzeichen getrennte Liste von Werten definiert, die bestimmte Berechtigungen darstellen. Zum Beispiel könnte ein Scope-Wert von "read write" anzeigen, dass die Client-Anwendung Lese- und Schreibzugriff auf die Daten eines Benutzers anfordert.

Du solltest `authorizationEndpoint`, `tokenEndpoint` und `userInfoEndpoint` in der Dokumentation des sozialen Anbieters finden.

_authenticationEndpoint_: Dieser Endpunkt wird verwendet, um den Authentifizierungsprozess zu starten. Der Authentifizierungsprozess beinhaltet typischerweise, dass sich der Benutzer anmeldet und der Client-Anwendung die Autorisierung erteilt, auf seine Ressourcen zuzugreifen.

_tokenEndpoint_: Dieser Endpunkt wird von der Client-Anwendung verwendet, um ein Zugangstoken zu erhalten, das zum Zugriff auf die angeforderten Ressourcen verwendet werden kann. Die Client-Anwendung sendet typischerweise eine Anfrage mit einem Grant-Typ und einem Autorisierungscode an den Token-Endpunkt, um ein Zugangstoken zu erhalten.

_userInfoEndpoint_: Dieser Endpunkt wird von der Client-Anwendung verwendet, um zusätzliche Informationen über den Benutzer zu erhalten, wie z. B. seinen vollständigen Namen, seine E-Mail-Adresse oder sein Profilbild. Der User-Info-Endpunkt wird typischerweise aufgerufen, nachdem die Client-Anwendung ein Zugangstoken vom Token-Endpunkt erhalten hat.

Logto stellt außerdem ein `profileMap`-Feld bereit, mit dem Benutzer die Zuordnung von Profilfeldern der sozialen Anbieter anpassen können, da diese oft nicht standardisiert sind. Die Schlüssel sind die standardisierten Benutzprofil-Feldnamen von Logto, und die entsprechenden Werte sollten die Feldnamen der sozialen Profile sein. Im aktuellen Stadium berücksichtigt Logto nur 'id', 'name', 'avatar', 'email' und 'phone' aus dem sozialen Profil, wobei nur 'id' erforderlich ist und die anderen Felder optional sind.

`responseType` und `grantType` können NUR FESTE Werte mit dem Authorization Code Grant-Typ sein, daher machen wir sie optional und Standardwerte werden automatisch ausgefüllt.

Zum Beispiel findest du [Google User Profile Response](https://developers.google.com/identity/openid-connect/openid-connect#an-id-tokens-payload) und daher sollte das `profileMap` wie folgt aussehen:

```json
{
  "id": "sub",
  "avatar": "picture"
}
```

:::note

Wir haben einen OPTIONALEN Schlüssel `customConfig` bereitgestellt, um deine eigenen Parameter einzufügen.
Jeder soziale Identitätsanbieter kann seine eigene Variante des OAuth-Standardprotokolls haben. Wenn dein gewünschter sozialer Identitätsanbieter strikt dem OAuth-Standardprotokoll folgt, musst du dich nicht um `customConfig` kümmern.

:::

## Konfigurationstypen \{#config-types}

| Name                      | Typ                     | Erforderlich |
| ------------------------- | ----------------------- | ------------ |
| authorizationEndpoint     | string                  | ja           |
| userInfoEndpoint          | string                  | ja           |
| clientId                  | string                  | ja           |
| clientSecret              | string                  | ja           |
| tokenEndpointResponseType | enum                    | nein         |
| responseType              | string                  | nein         |
| grantType                 | string                  | nein         |
| tokenEndpoint             | string                  | nein         |
| scope                     | string                  | nein         |
| customConfig              | Record\<string, string> | nein         |
| profileMap                | ProfileMap              | nein         |

| ProfileMap-Felder | Typ    | Erforderlich | Standardwert |
| ----------------- | ------ | ------------ | ------------ |
| id                | string | nein         | id           |
| name              | string | nein         | name         |
| avatar            | string | nein         | avatar       |
| email             | string | nein         | email        |
| phone             | string | nein         | phone        |

## Allgemeine Einstellungen \{#general-settings}

Hier sind einige allgemeine Einstellungen, die die Verbindung zu deinem Identitätsanbieter nicht blockieren, aber die Authentifizierungserfahrung für Endbenutzer beeinflussen können.

### Name und Logo des sozialen Buttons \{#social-button-name-and-logo}

Wenn du einen sozialen Button auf deiner Anmeldeseite anzeigen möchtest, kannst du den **Namen** und das **Logo** (Dark Mode und Light Mode) des sozialen Identitätsanbieters festlegen. Dies hilft den Benutzern, die Option für die soziale Anmeldung zu erkennen.

### Name des Identitätsanbieters \{#identity-provider-name}

Jeder Social Connector hat einen eindeutigen Identitätsanbieter (IdP)-Namen, um Benutzeridentitäten zu unterscheiden. Während gängige Connectoren einen festen IdP-Namen verwenden, benötigen benutzerdefinierte Connectoren einen eindeutigen Wert. Erfahre mehr über [IdP-Namen](https://docs.logto.io/connectors/connector-data-structure#target-identity-provider-name) für weitere Details.

### Profilinformationen synchronisieren \{#sync-profile-information}

Im OAuth-Connector kannst du die Richtlinie für das Synchronisieren von Profilinformationen wie Benutzernamen und Avataren festlegen. Wähle aus:

- **Nur beim ersten Anmelden synchronisieren**: Profilinformationen werden einmalig abgerufen, wenn sich der Benutzer zum ersten Mal anmeldet.
- **Immer beim Anmelden synchronisieren**: Profilinformationen werden jedes Mal aktualisiert, wenn sich der Benutzer anmeldet.

### Tokens speichern, um auf Drittanbieter-APIs zuzugreifen (Optional) \{#store-tokens-to-access-third-party-apis-optional}

Wenn du auf die APIs des Identitätsanbieters zugreifen und Aktionen mit Benutzerautorisierung durchführen möchtest (entweder über soziale Anmeldung oder Kontoverknüpfung), muss Logto bestimmte API-Berechtigungen (Scopes) erhalten und Tokens speichern.

1. Füge die erforderlichen Scopes im **scope**-Feld gemäß den obigen Anweisungen hinzu.
2. Aktiviere **Tokens für dauerhaften API-Zugriff speichern** im Logto OAuth-Connector. Logto speichert Zugangstokens sicher im Secret Vault.
3. Für **Standard** OAuth/OIDC-Identitätsanbieter muss der Scope `offline_access` enthalten sein, um ein Auffrischungstoken (Refresh token) zu erhalten und wiederholte Benutzerzustimmungsaufforderungen zu vermeiden.

:::warning
Halte dein Client-Secret sicher und veröffentliche es niemals im Client-seitigen Code. Wenn es kompromittiert wird, generiere sofort ein neues in den App-Einstellungen deines Identitätsanbieters.
:::

## Den OAuth-Connector nutzen \{#utilize-the-oauth-connector}

Sobald du einen OAuth-Connector erstellt und mit deinem Identitätsanbieter verbunden hast, kannst du ihn in deine Endbenutzer-Flows einbinden. Wähle die Optionen, die zu deinen Anforderungen passen:

### Social Sign-in-Button aktivieren \{#enable-social-sign-in-button}

1. Gehe in der Logto Console zu <CloudLink to="/sign-in-experience/sign-up-and-sign-in">Anmeldeerfahrung > Registrierung und Anmeldung</CloudLink>.
2. Füge den OAuth-Connector im Abschnitt **Soziale Anmeldung** hinzu, damit Benutzer sich mit deinem Identitätsanbieter authentifizieren können.

Erfahre mehr über die [soziale Anmeldeerfahrung](https://docs.logto.io/end-user-flows/sign-up-and-sign-in/social-sign-in).

### Ein soziales Konto verknüpfen oder trennen \{#link-or-unlink-a-social-account}

Nutze die Account API, um ein benutzerdefiniertes Account Center in deiner App zu erstellen, das angemeldeten Benutzern ermöglicht, ihre sozialen Konten zu verknüpfen oder zu trennen. [Folge dem Account API-Tutorial](https://docs.logto.io/end-user-flows/account-settings/by-account-api#link-a-new-social-connection)

:::tip
Es ist erlaubt, den OAuth-Connector nur für Kontoverknüpfung und API-Zugriff zu aktivieren, ohne ihn für die soziale Anmeldung zu aktivieren.
:::

### Auf Identitätsanbieter-APIs zugreifen und Aktionen durchführen \{#access-identity-provider-apis-and-perform-actions}

Deine Anwendung kann gespeicherte Zugangstokens aus dem Secret Vault abrufen, um die APIs deines Identitätsanbieters aufzurufen und Backend-Aufgaben zu automatisieren. Die spezifischen Möglichkeiten hängen von deinem Identitätsanbieter und den angeforderten Scopes ab. Siehe die Anleitung zum Abrufen gespeicherter Tokens für den API-Zugriff.

## Soziale Identität des Benutzers verwalten \{#manage-user-s-social-identity}

Nachdem ein Benutzer sein soziales Konto verknüpft hat, können Administratoren diese Verbindung in der Logto Console verwalten:

1. Navigiere zu <CloudLink to="/users">Logto Console > Benutzerverwaltung</CloudLink> und öffne das Benutzerprofil.
2. Unter **Soziale Verbindungen** finde den Identitätsanbieter-Eintrag und klicke auf **Verwalten**.
3. Auf dieser Seite können Administratoren die soziale Verbindung des Benutzers verwalten, alle gewährten und synchronisierten Profilinformationen aus dem sozialen Konto einsehen und den Status des Zugangstokens überprüfen.

:::note
Einige Identitätsanbieter geben im Zugangstoken-Response keine spezifischen Scope-Informationen zurück, sodass Logto die Liste der vom Benutzer gewährten Berechtigungen nicht direkt anzeigen kann. Solange der Benutzer jedoch den angeforderten Scopes während der Autorisierung zugestimmt hat, hat deine Anwendung beim Zugriff auf die OAuth-API die entsprechenden Berechtigungen.
:::
