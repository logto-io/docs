## Alipay-Entwicklerkonto registrieren \{#register-alipay-developer-account}

[Registriere ein Alipay-Entwicklerkonto](https://certifyweb.alipay.com/certify/reg/guide#/), falls du noch keines hast.

## Alipay-App erstellen und konfigurieren \{#create-and-configure-alipay-app}

1. Melde dich mit dem gerade registrierten Konto in der [Alipay-Konsole](https://open.alipay.com/) an.
2. Gehe zum Tab „Web & Mobile Apps“ (网页&移动应用) im Panel „Meine Anwendung“ (我的应用).
3. Klicke auf die Schaltfläche „App erstellen“ (立即创建), um mit der Konfiguration deiner Anwendung zu beginnen.
4. Benenne deine Anwendung im Feld „Anwendungsname“ (应用名称) gemäß den Namenskonventionen und lade dein „Anwendungssymbol“ (应用图标) hoch. Stelle sicher, dass du „Mobile Anwendung“ (移动应用) als „App-Typ“ (应用类型) auswählst. Für den Bau einer iOS-App ist eine eindeutige „Bundle-ID“ erforderlich. Außerdem sind „Anwendungssignatur“ (应用签名) und „Anwendungspaketname“ (应用包名) für Android-Apps erforderlich.
5. Nach dem Erstellen der Anwendung gelangst du zur Übersichtsseite. Dort solltest du auf „Fähigkeit hinzufügen“ (添加能力) klicken, um „Drittanbieter-Anwendungsautorisierung“ (第三方应用授权), „Mitgliedsinformationen abrufen“ (获取会员信息) und „App Alipay-Login“ (App 支付宝登录) hinzuzufügen, bevor du die Alipay-Anmeldung aktivierst.
6. Gehe zum [Alipay-Kundencenter](https://b.alipay.com/index2.htm) und melde dich mit dem Alipay-Entwicklerkonto an. Klicke auf „Account Center“ (账号中心) in der oberen Leiste und gehe zu „APPID-Bindung“ (APPID 绑定), deren Zugang sich unten in der Seitenleiste befindet. „Bindung hinzufügen“ (添加绑定), indem du die APPID der gerade in Schritt 4 erstellten mobilen Anwendung eingibst.
7. Klicke auf die Schaltfläche „Signieren“ von „App Alipay-Login“ und schließe den Signiervorgang gemäß der Anleitung ab. Nach Abschluss dieses Schritts sollten die in Schritt 5 hinzugefügten Fähigkeiten aktiv sein.
8. Kehre zur Alipay Open Platform-Konsole zurück. Im Abschnitt „Entwicklungsinformationen“ (开发信息) findest du „Schnittstellen-Signaturmethode“ (接口加签方式（密钥/证书）). Klicke auf die Schaltfläche „Einrichten“ (设置), um die Signaturmethode festzulegen. „Öffentlicher Schlüssel“ (公钥) ist die bevorzugte Signaturmethode. Trage den Inhalt der von dir generierten öffentlichen Schlüsseldatei in das Textfeld ein.
9. Richte die „Autorisierungs-Redirect-URI“ (授权回调地址) ein, indem du auf die Schaltfläche „Einrichten“ (设置) unten auf der Alipay-Konsole klickst. `${your_logto_origin}/callback/${connector_id}` ist die Standard-Redirect-URI, die im Logto Core verwendet wird. Die `connector_id` findest du in der oberen Leiste der Logto Admin Console auf der Connector-Detailseite.
10. Nachdem du alle diese Schritte abgeschlossen hast, gehe zurück in die obere rechte Ecke der Alipay-Konsole und klicke auf „Zur Überprüfung einreichen“ (提交审核). Sobald die Überprüfung genehmigt ist, kannst du einen reibungslosen Alipay-Anmeldeablauf nutzen.

:::note

Du kannst _openssl_ verwenden, um Schlüsselpaaren auf deinem lokalen Rechner zu generieren, indem du folgenden Code-Schnipsel im Terminal ausführst.

```bash
openssl genrsa -out private.pem 2048
openssl rsa -in private.pem -outform PEM -pubout -out public.pem
```

Beim Ausfüllen des öffentlichen Schlüssels auf der Alipay-App-Einrichtungsseite musst du den Header und Footer von `public.pem` entfernen, alle Zeilenumbrüche löschen und den restlichen Inhalt in das Textfeld für „öffentlicher Schlüssel“ einfügen.
:::

## Logto Alipay Native Connector-Einstellungen konfigurieren \{#set-up-the-logto-alipay-native-connector-settings}

1. Im [Alipay-Konsole-Arbeitsbereich](https://open.alipay.com/dev/workspace) gehe zum Panel „Meine Anwendung“ (我的应用) und klicke auf den Tab „Web & Mobile Apps“ (网页&移动应用). Dort findest du die APPID aller Anwendungen.
2. Im Schritt 7 des vorherigen Abschnitts hast du bereits ein Schlüsselpaar mit privatem und öffentlichem Schlüssel generiert.
3. Fülle die Logto-Connector-Einstellungen aus:
   - Trage in das Feld `appId` die APPID aus Schritt 1 ein.
   - Trage in das Feld `privateKey` den Inhalt der privaten Schlüsseldatei aus Schritt 2 ein. ERSETZE ALLE Zeilenumbrüche durch '\n'. Du musst den Header und Footer in der privaten Schlüsseldatei NICHT entfernen.
   - Trage in das Feld `signType` 'RSA2' ein, da wir im Schritt 7 von „Alipay-Apps erstellen und konfigurieren“ die Signaturmethode `Public key` gewählt haben.

### Konfigurationstypen \{#config-types}

| Name       | Typ         | Enum-Werte     |
| ---------- | ----------- | -------------- |
| appId      | string      | N/A            |
| privateKey | string      | N/A            |
| signType   | enum string | 'RSA' / 'RSA2' |

## Alipay Native-Anmeldung in deiner App aktivieren \{#enable-alipay-native-sign-in-in-your-app}

### iOS \{#ios}

Wir gehen davon aus, dass du das <MainSiteUrl href="/quick-starts/swift">Logto iOS SDK</MainSiteUrl> in deine App integriert hast. In diesem Fall ist alles ziemlich einfach und du musst nicht einmal die Alipay SDK-Dokumentation lesen:

**1. Füge `LogtoSocialPluginAlipay` zu deinem Xcode-Projekt hinzu**

Füge das Framework hinzu:

<img src="/img/assets/add-framework.png" alt="Framework hinzufügen" />

:::note

Das Plugin enthält das Alipay „Minimalist SDK“ (极简版 SDK). Du kannst nach dem Import des Plugins direkt `import AFServiceSDK` verwenden.

:::

**2. Füge das Plugin zu den `LogtoClient`-Init-Optionen hinzu**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginAlipay(callbackScheme: "your-scheme")]
)
```

Dabei ist `callbackScheme` eines der [benutzerdefinierten URL-Schemes](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app), das zu deiner App navigieren kann.

### Android \{#android}

Wir gehen davon aus, dass du das <MainSiteUrl href="/quick-starts/android">Logto Android SDK</MainSiteUrl> in deine App integriert hast. In diesem Fall ist alles ziemlich einfach und du musst nicht einmal die Alipay SDK-Dokumentation lesen:

**1. Lade das Alipay „Minimalist SDK“ herunter und füge es deinem Projekt hinzu**

Lade das Alipay „Minimalist SDK“ (极简版 SDK) von [Logto 3rd-party Social SDKs](https://github.com/logto-io/social-sdks/blob/master/alipay/android/alipaySdk-15.7.9-20200727142846.aar) in den Ordner `app/libs` deines Projekts herunter:

```bash
project-path/app/libs/alipaySdk-15.7.9-20200727142846.aar
```

**2. Füge das Alipay „Minimalist SDK“ als Abhängigkeit hinzu**

Öffne deine `build.gradle`-Datei:

```bash
project-path/app/build.gradle
```

Füge die Abhängigkeit hinzu:

```kotlin
dependencies {
  // ...
  implementation(files("./libs/alipaySdk-15.7.9-20200727142846.aar"))  // kotlin-script
  // oder
  implementation files('./libs/alipaySdk-15.7.9-20200727142846.aar')  // groovy-script
}
```
