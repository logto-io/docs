## Erstelle eine mobile App in der WeChat Open Platform \{#create-a-mobile-app-in-the-wechat-open-platform}

:::tip

Du kannst einige Abschnitte Ã¼berspringen, wenn du sie bereits abgeschlossen hast.

:::

### Erstelle ein Konto \{#create-an-account}

Ã–ffne https://open.weixin.qq.com/, klicke auf die SchaltflÃ¤che â€žSign Upâ€œ oben rechts und schlieÃŸe dann den Registrierungsprozess ab.

### Erstelle eine mobile App \{#create-a-mobile-app}

Melde dich mit dem gerade erstellten Konto an. Im Tab â€žMobile Applicationâ€œ (ç§»åŠ¨åº”ç”¨) klicke auf die groÃŸe grÃ¼ne SchaltflÃ¤che â€žCreate a mobile appâ€œ (åˆ›å»ºç§»åŠ¨åº”ç”¨).

<img src="/img/assets/app-tabs.png" alt="App tabs" />

FÃ¼llen wir die erforderlichen Informationen im Antragsformular aus.

<img src="/img/assets/create-mobile-app.png" alt="Create mobile app" />

#### Grundlegende Informationen \{#basic-info}

Die meisten Felder sind selbsterklÃ¤rend, und wir haben hier einige Tipps:

- Wenn du nur WeChat-Anmeldung testen mÃ¶chtest und die App nicht im App Store ist, wÃ¤hle im Abschnitt â€žApp is availableâ€œ die Option â€žNoâ€œ, um den â€žApp download linkâ€œ zu Ã¼berspringen.
- Das â€žApp operation flow chartâ€œ sieht kompliziert aus. Nach unserer Erfahrung solltest du ein einfaches Flussdiagramm und einige App-Screenshots vorbereiten, um die Wahrscheinlichkeit zu erhÃ¶hen, die ÃœberprÃ¼fung zu bestehen.

Klicke auf â€žNext stepâ€œ, um fortzufahren.

#### Plattform-Informationen \{#platform-info}

Du kannst eine oder beide Plattformen, iOS und Android, konfigurieren, um Logto mit WeChat Native Sign-in zu integrieren.

**iOS-App**

WÃ¤hle â€žiOS appâ€œ (iOS åº”ç”¨) aus und dann entsprechend den ZielgerÃ¤tetyp deiner App.

<img src="/img/assets/platform.png" alt="App platform" />

Wenn du â€žNoâ€œ fÃ¼r die App Store-VerfÃ¼gbarkeit gewÃ¤hlt hast, kannst du das Feld â€žAppStore download addressâ€œ hier Ã¼berspringen.

FÃ¼lle _Bundle ID_, _Test version Bundle ID_ und _Universal Links_ aus (tatsÃ¤chlich wird nur ein Link benÃ¶tigt ðŸ˜‚).

:::note

_Bundle ID_ und _Test version Bundle ID_ kÃ¶nnen denselben Wert haben.

:::

:::tip

WeChat verlangt einen Universal Link fÃ¼r die native Anmeldung. Wenn du ihn noch nicht eingerichtet hast oder nicht weiÃŸt, was das ist, siehe die [offizielle Apple-Dokumentation](https://developer.apple.com/ios/universal-links/).

:::

**Android-App**

WÃ¤hle â€žAndroid appâ€œ (Android åº”ç”¨) aus.

<img src="/img/assets/platform-android-app.png" alt="Android app platform" />

FÃ¼lle _Application Signing Signature_ (åº”ç”¨ç­¾å) und _Application Package Name_ (åº”ç”¨åŒ…å) aus.

:::note

Du musst deine App signieren, um eine Signatur zu erhalten. Weitere Informationen findest du unter [Sign your app](https://developer.android.com/studio/publish/app-signing).

:::

Nach dem Signieren kannst du die Aufgabe `signingReport` ausfÃ¼hren, um die Signatur zu erhalten.

```bash
./gradlew your-android-project:signingReport
```

Der `MD5`-Wert des Berichts der entsprechenden Build-Variante ist die _Application Signing Signature_ (åº”ç”¨ç­¾å), aber denke daran, alle Doppelpunkte aus dem Wert zu entfernen und ihn in Kleinbuchstaben zu schreiben.

Z.B. `1A:2B:3C:4D` -> `1a2b3c4d`.

#### Warten auf das ÃœberprÃ¼fungsergebnis \{#waiting-for-the-review-result}

Nachdem du die Plattforminformationen ausgefÃ¼llt hast, klicke auf â€žSubmit Reviewâ€œ, um fortzufahren. In der Regel geht die ÃœberprÃ¼fung schnell und ist innerhalb von 1-2 Tagen abgeschlossen.

Wir vermuten, dass der PrÃ¼fer bei jeder Einreichung zufÃ¤llig zugewiesen wird, da der Standard schwankt. Es kann sein, dass du beim ersten Mal abgelehnt wirst, aber gib nicht auf! ErklÃ¤re deine aktuelle Situation und frage den PrÃ¼fer, wie du sie Ã¤ndern kannst.

## Aktiviere WeChat Native Sign-in in deiner App \{#enable-wechat-native-sign-in-in-your-app}

### iOS \{#ios}

Wir gehen davon aus, dass du das [Logto iOS SDK](/quick-starts/swift) in deiner App integriert hast. In diesem Fall ist alles ziemlich einfach und du musst nicht einmal die WeChat SDK-Dokumentation lesen:

**1. Konfiguriere Universal Link und URL Scheme in deinem Xcode-Projekt**

Im Xcode-Projekt -> Tab â€žSigning & Capabilitiesâ€œ, fÃ¼ge die FÃ¤higkeit â€žAssociated Domainsâ€œ und den zuvor konfigurierten Universal Link hinzu.

<img src="/img/assets/universal-link.png" alt="Universal link" />

Gehe dann zum Tab â€žInfoâ€œ und fÃ¼ge ein [benutzerdefiniertes URL-Schema](https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app) mit der WeChat App ID hinzu.

<img src="/img/assets/custom-url-scheme.png" alt="Custom URL scheme" />

Ã–ffne abschlieÃŸend deine `Info.plist` und fÃ¼ge `weixinULAPI` und `weixin` unter `LSApplicationQueriesSchemes` hinzu.

<img src="/img/assets/plist.png" alt="Plist" />

:::note

Wir wissen, dass diese Schritte nicht sehr sinnvoll erscheinen, aber dies ist die minimal funktionsfÃ¤hige LÃ¶sung, die wir gefunden haben. Siehe den [magischen offiziellen Leitfaden](https://developers.weixin.qq.com/doc/oplatform/en/Mobile_App/Access_Guide/iOS.html) fÃ¼r weitere Informationen.

:::

**2. FÃ¼ge `LogtoSocialPluginWechat` zu deinem Xcode-Projekt hinzu**

FÃ¼ge das Framework hinzu:

<img src="/img/assets/add-framework.png" alt="Add framework" />

Und fÃ¼ge `-ObjC` zu deinen Build Settings > Linking > Other Linker Flags hinzu:

<img src="/img/assets/linker-flags.png" alt="Linker flags" />

:::note

Das Plugin enthÃ¤lt das WeChat Open SDK 1.9.2. Du kannst nach dem Importieren des Plugins direkt `import WechatOpenSDK` verwenden.

:::

**3. FÃ¼ge das Plugin zu deinen `LogtoClient`-Init-Optionen hinzu**

```swift
let logtoClient = LogtoClient(
  useConfig: config,
  socialPlugins: [LogtoSocialPluginWechat()]
)
```

**4. Behandle `onOpenURL` korrekt**

:::note

Die Funktion `LogtoClient.handle(url:)` behandelt alle nativen Connectors, die du aktiviert hast. Du musst sie nur einmal aufrufen.

:::

```swift
// SwiftUI
YourRootView()
  .onOpenURL { url in
      LogtoClient.handle(url: url)
  }

// oder AppDelegate
func application(_ app: UIApplication, open url: URL, options: /*...*/) -> Bool {
  LogtoClient.handle(url: url)
}
```

### Android \{#android}

Wir gehen davon aus, dass du das [Logto Android SDK](/quick-starts/android) in deiner App integriert hast. In diesem Fall ist alles ziemlich einfach und du musst nicht einmal die WeChat SDK-Dokumentation lesen:

**1. FÃ¼ge das `Wechat Open SDK` zu deinem Projekt hinzu**

Stelle sicher, dass das Repository `mavenCentral()` in deinen Gradle-Projekt-Repositories enthalten ist:

```kotlin
repositories {
  // ...
  mavenCentral()
}
```

FÃ¼ge das Wechat Open SDK zu deinen AbhÃ¤ngigkeiten hinzu:

```kotlin
dependencies {
  // ...
  api("com.tencent.mm.opensdk:wechat-sdk-android:6.8.0")  // kotlin-script
  // oder
  api 'com.tencent.mm.opensdk:wechat-sdk-android:6.8.0'   // groovy-script
}
```

**2. FÃ¼ge `WXEntryActivity` zu deinem Projekt hinzu**

Erstelle ein `wxapi`-Paket unter deinem Paket-Root und fÃ¼ge die `WXEntryActivity` im `wxapi`-Paket hinzu (Beispiel: `com.sample.app`):

```kotlin
// WXEntryActivity.kt
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

class WXEntryActivity: WechatSocialResultActivity()
```

```java
// WXEntryActivity.java
package com.sample.app.wxapi

import io.logto.sdk.android.auth.social.wechat.WechatSocialResultActivity

public class WXEntryActivity extends WechatSocialResultActivity {}
```

Die endgÃ¼ltige Position der `WXEntryActivity` im Projekt sollte wie folgt aussehen (Beispiel fÃ¼r Kotlin):

```bash
src/main/kotlin/com/sample/app/wxapi/WXEntryActivity.kt
```

**3. Ã„ndere die `AndroidManifest.xml`**

FÃ¼ge die folgende Zeile zu deiner `AndroidManifest.xml` hinzu:

```xml
\<?xml version="1.0" encoding="utf-8"?>
\<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.sample.app">

  \<application>
    \<!-- Zeile, die hinzugefÃ¼gt werden muss -->
    \<activity android:name=".wxapi.WXEntryActivity" android:exported="true"/>
  \</application>

\</manifest>
```
