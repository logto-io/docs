## Aliyun DirectMail コンソールでメールサービスを設定する \{#set-up-an-email-service-in-aliyun-directmail-console}

### Aliyun アカウントを作成する \{#create-an-aliyun-account}

[Aliyun](https://aliyun.com/) にアクセスし、まだアカウントをお持ちでない場合は Aliyun アカウントを作成してください。

### Aliyun Direct Mail を有効化・設定する \{#enable-and-configure-aliyun-direct-mail}

[DM サービスコンソールページ](https://www.aliyun.com/product/directmail) にアクセスし、サインインします。ページ左上の「申請開通 (Apply to enable)」ボタンをクリックして Direct Mail サービスを有効化し、設定を開始します。

[DM 管理コンソールページ](https://dm.console.aliyun.com/) から、次の手順を行います：

1. サイドバーの「発信域名 (Email Domains)」に移動し、案内に従って「新建域名 (New Domain)」を追加します。
2. 「発信地址 (Sender Addresses)」および「邮件标签 (Email Tags)」をそれぞれカスタマイズします。

セットアップが完了したら、テスト方法は 2 つあります：

- [DirectMail 概要ページ](https://dm.console.aliyun.com/) にアクセスし、ページ下部の「操作引导 (Operation Guide)」を見つけ、「发送邮件 (Send Emails)」をクリックします。さまざまなテスト方法が確認できます。
- サイドバーの「发送邮件 (Send Emails)」→「发送邮件 (Email Tasks)」の順に進み、テストタスクを作成します。

## コネクター JSON を作成する \{#compose-the-connector-json}

1. [DM 管理コンソールページ](https://dm.console.aliyun.com/) で、右上のアバターにカーソルを合わせて「AccessKey 管理 (AccessKey Management)」に進み、「创建 AccessKey (Create AccessKey)」をクリックします。セキュリティ認証が完了すると「AccessKey ID」と「AccessKey Secret」のペアが取得できます。大切に保管してください。
2. 先ほどアクセスした「发信地址 (Sender Addresses)」または「邮件标签 (Email Tags)」タブで、_Sender Address_ または _Email Tag_ を簡単に確認できます。
3. Aliyun DM コネクターの設定を入力します：
   - `accessKeyId` および `accessKeySecret` フィールドには、手順 1 で取得したアクセスキーのペアを入力します。
   - `accountName` および `fromAlias` フィールドには、手順 2 で確認した「Sender Address」と「Email Tag」を入力します。すべてのテンプレートでこの署名名を共有します。（`fromAlias` は任意なので空欄でも構いません。）
   - 異なるケースごとに複数の DM コネクターテンプレートを追加できます。単一テンプレートを追加する例は以下の通りです：
     - `subject` フィールドには、送信メールのタイトルとなる内容を入力します。
     - `content` フィールドには任意の文字列型コンテンツを入力します。ランダム認証コード用の `{{code}}` プレースホルダーを忘れずに残してください。
     - `usageType` フィールドには、用途に応じて `Register`、`SignIn`、`ForgotPassword`、`Generic` のいずれかを入力します。（`usageType` は適切なユースケースを識別するための Logto プロパティです。）すべてのユーザーフローを有効にするには、`Register`、`SignIn`、`ForgotPassword`、`Generic` の usageType を持つテンプレートが必要です。

### Aliyun DM コネクターのテスト \{#test-aliyun-dm-connector}

「保存して完了」する前に、メールアドレスを入力して「送信」をクリックし、設定が機能するかどうかを確認できます。

以上です。<MainSiteUrl href="/connectors/email-connectors/#enable-email-sign-up-or-sign-in">サインイン体験でコネクターを有効化</MainSiteUrl> するのをお忘れなく。

### 設定タイプ \{#config-types}

| 名前            | 型                |
| --------------- | ----------------- |
| accessKeyId     | string            |
| accessKeySecret | string            |
| accountName     | string            |
| fromAlias       | string (OPTIONAL) |
| templates       | Template[]        |

| テンプレートプロパティ | 型          | 列挙値                                               |
| ---------------------- | ----------- | ---------------------------------------------------- |
| subject                | string      | N/A                                                  |
| content                | string      | N/A                                                  |
| usageType              | enum string | 'Register' / 'SignIn' / 'ForgotPassword' / 'Generic' |
