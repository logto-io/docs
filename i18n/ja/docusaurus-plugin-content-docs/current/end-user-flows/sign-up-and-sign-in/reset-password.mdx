---
sidebar_position: 4
---

import resetPasswordImage from '@site/docs/end-user-flows/sign-up-and-sign-in/assets/reset-password.png';

# パスワードのリセット

有効な [Email コネクター](/connectors/email-connectors) または [SMS コネクター](/connectors/sms-connectors) が設定されている場合、パスワード回復機能が自動的に有効になります。ユーザーは登録済みのメールアドレスまたは電話番号を提供することでパスワードをリセットできます。

## パスワードリセットフロー \{#password-reset-flow}

パスワードリセット機能が有効になると、サインインフォームの下に「パスワードを忘れた」リンクボタンが表示されます。ユーザーは「パスワードを忘れた」リンクをクリックしてパスワードリセットプロセスを開始できます。

:::note
「パスワードを忘れた」リンクが表示されない場合は、有効な **Email** または **SMS** コネクターが設定されていることを確認してください。
:::

1. **サインインページを訪問**：ユーザーがサインインページを訪れます。
2. **パスワードを忘れたリンクをクリック**：ユーザーが「パスワードを忘れた」リンクをクリックします。
3. **メール / 電話番号を入力**：ユーザーは「パスワードを忘れた」リンクをクリックした後、登録済みのメールアドレスまたは電話番号を入力できる新しいページにリダイレクトされます。
4. **確認コードを送信**：Logto はユーザーが提供したメールアドレスまたは電話番号に確認コードを送信し、コード確認ページにリダイレクトします。
5. **確認コードを入力**：ユーザーはメールまたは電話で受け取った確認コードを入力します。Logto はコードとメールアドレスまたは電話番号に関連付けられたユーザーのアイデンティティを確認します。
6. **新しいパスワードを入力**：確認コードが正常に確認されると、ユーザーは新しいパスワードを入力するよう促されます。
7. **パスワードリセット成功**：提供されたパスワードがパスワードポリシーの要件を満たしている場合、パスワードは正常に更新されます。
8. **サインインページにリダイレクト**：ユーザーは新しいパスワードでサインインするためにサインインページにリダイレクトされます。

<img src={resetPasswordImage} alt="パスワードリセットフロー" />

## 認証済みユーザーのパスワード更新 \{#update-password-for-authenticate-users}

認証済みユーザーは、アカウント設定ページを訪問してパスワードを更新できます。ユーザーアカウント設定ページの実装については、[アカウント設定](/end-user-flows/account-settings/)を確認してください。

## パスワードポリシーの設定 \{#set-up-password-policy}

新しいユーザーまたはパスワードを更新するユーザーに対して、パスワードの強度要件を強制するためのパスワードポリシーを設定できます。<CloudLink to="/sign-in-experience/password-policy"> Console > サインイン体験 > パスワードポリシー</CloudLink> にアクセスして、パスワードポリシーの設定を構成してください。

1. **最小パスワード長**：パスワードに必要な最小文字数を設定します。（NIST は少なくとも 8 [文字](https://pages.nist.gov/800-63-3/sp800-63b.html#sec5) を使用することを推奨しています）
2. **必要な文字タイプの最小数**：パスワードに必要な文字タイプの最小数を設定します。利用可能な文字タイプは次のとおりです：
   1. 大文字：`(A-Z)`
   2. 小文字：`(a-z)`
   3. 数字：`(0-9)`
   4. 特殊文字：``(!"#$%&'()\*+,-./:;<>=?@[]^\_`|{}~ )``
3. **漏洩履歴チェック**：この設定を有効にして、データ漏洩で以前に公開されたパスワードを拒否します。（[Have I Been Pwned](https://haveibeenpwned.com/Passwords) によって提供されています）
4. **繰り返しチェック**：この設定を有効にして、繰り返し文字を含むパスワードを拒否します。（例：「11111111」または「password123」）
5. **ユーザー情報チェック**：この設定を有効にして、ユーザー名、メールアドレス、電話番号などのユーザー情報を含むパスワードを拒否します。
6. **カスタムワード**：パスワードで拒否したいカスタムワード（大文字小文字を区別しない）のリストを提供します。

## よくある質問 \{#faqs}

<details>
  <summary>

### パスワードリセット成功後にユーザーをサインアウトする方法 \{#how-to-sign-out-a-user-after-a-successful-password-reset}

</summary>

ユーザーがパスワードを正常にリセットしたときに通知を受け取るために、`PostResetPassword` [Webhook イベント](/developers/webhooks/webhooks-events#user-interaction-hook-events) を購読します。その後、ユーザーの現在のセッションを無効にし、サインインページにリダイレクトするために [サインアウト](/end-user-flows/sign-out) アクションをトリガーできます。

</details>

<details>
  <summary>

### カスタム UI でパスワードリセットフローを実装する方法 \{#how-to-implement-the-password-reset-flow-on-my-custom-ui}

</summary>

Logto の **Management API** と **Account API** を使用して独自のパスワードリセットフローを実装できます。詳細については [アカウント設定](/end-user-flows/account-settings/) を確認してください。

</details>

<details>
  <summary>

### ユーザーのメールにパスワードリセットリンクを送信する方法 \{#how-can-i-send-a-password-reset-link-to-the-users-email}

</summary>

自己ホスト型のパスワードリセットエンドポイントを作成し、Logto SDK を利用して [`first_screen`](/end-user-flows/authentication-parameters/first-screen) を `reset-password` に設定してサインインリクエストを開始します。これにより、ユーザーはシームレスにパスワードリセットページにリダイレクトされます。

</details>

## 関連リソース \{#related-resources}

<Url href="https://blog.logto.io/design-your-password-policy">パスワードポリシーを設計する</Url>
