import CodeBlock from '@theme/CodeBlock';

import CliamsNeedNetworkRequest from '../../fragments/_claims-need-network-request.mdx';
import FindUserInfoMissing from '../../fragments/_find-user-info-missing.mdx';
import ScopesAndClaims from '../../fragments/_scopes-and-claims.mdx';
import ScopesAndClaimsIntroduction from '../../fragments/_scopes-claims-introduction.md';

### แสดงข้อมูลผู้ใช้ \{#display-user-information}

หากต้องการแสดงข้อมูลของผู้ใช้ คุณสามารถใช้เมธอด `@client.id_token_claims` ตัวอย่างเช่น ในมุมมอง (view):

```erb title="app/views/sample/index.html.erb"
<% if @client.is_authenticated? %>
  <p>ยินดีต้อนรับ, <%= @client.id_token_claims["name"] %></p>
<% else %>
  <p>กรุณาลงชื่อเข้าใช้</p>
<% end %>
```

โปรดดูรายละเอียดเพิ่มเติมเกี่ยวกับเมธอด `#id_token_claims` ได้ที่ [gemdocs](https://gemdocs.org/gems/logto/latest)

### ขอการอ้างสิทธิ์เพิ่มเติม \{#request-additional-claims}

<FindUserInfoMissing method="id_token_claims" />

<ScopesAndClaimsIntroduction />

หากต้องการขอขอบเขต (scopes) เพิ่มเติม คุณสามารถกำหนดค่า `scopes` ในอ็อบเจกต์ `LogtoClient::Config` ได้ดังนี้:

```ruby
require "logto/client"

@client = LogtoClient.new(
  config: LogtoClient::Config.new(
    # ...การตั้งค่าอื่น ๆ
    # highlight-next-line
    scopes: ["email", "phone"] # เพิ่ม scopes ตามที่ต้องการ
  ),
  # ...การตั้งค่าอื่น ๆ
)
```

จากนั้นคุณสามารถเข้าถึงการอ้างสิทธิ์เพิ่มเติมผ่าน `id_token_claims` ได้:

```erb title="app/views/sample/index.html.erb"
<% if @client.is_authenticated? %>
  <p>ชื่อ: <%= @client.id_token_claims["name"] %></p>
  <p>อีเมล: <%= @client.id_token_claims["email"] %></p>
  <p>โทรศัพท์: <%= @client.id_token_claims["phone"] %></p>
<% else %>
  <p>กรุณาลงชื่อเข้าใช้</p>
<% end %>
```

<CliamsNeedNetworkRequest
  type="method"
  method="fetch_user_info"
  codeSnippet={<CodeBlock language="erb" title="app/views/sample/index.html.erb">{`<% if @client.is_authenticated? %>
  <p>ข้อมูลกำหนดเอง: <%= @client.fetch_user_info["custom_data"] %></p>
<!-- ... -->`}</CodeBlock>}
/>

### ขอบเขตและการอ้างสิทธิ์ \{#scopes-and-claims}

<ScopesAndClaims />
