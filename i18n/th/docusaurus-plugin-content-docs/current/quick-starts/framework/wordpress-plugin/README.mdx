---
slug: /quick-starts/wordpress-plugin
sidebar_label: ปลั๊กอิน WordPress
sidebar_custom_props:
  description: ใช้ปลั๊กอิน WordPress อย่างเป็นทางการเพื่อผสาน Logto เข้ากับเว็บไซต์ WordPress ของคุณ
  logoFilename: wordpress.svg
language: php
official_link: https://wordpress.org/
app_type: เว็บแบบดั้งเดิม
framework: WordPress
---

import FurtherReadings from '../../fragments/_further-readings.md';

import Integration from './_integration.mdx';

# เพิ่มการยืนยันตัวตนให้กับเว็บไซต์ WordPress ของคุณด้วยปลั๊กอิน Logto

บทแนะนำนี้จะแสดงวิธีผสาน Logto เข้ากับเว็บไซต์ [WordPress](https://wordpress.org) ของคุณด้วยปลั๊กอิน WordPress อย่างเป็นทางการของเรา

## ข้อกำหนดเบื้องต้น \{#prerequisites}

- บัญชี [Logto Cloud](https://cloud.logto.io) หรือ [Logto ที่โฮสต์เอง](/introduction/set-up-logto-oss)
- สร้างแอปพลิเคชัน Logto แบบดั้งเดิมแล้ว
- โปรเจกต์ WordPress: ทำตาม [คู่มือการติดตั้ง WordPress อย่างเป็นทางการ](https://wordpress.org/support/article/how-to-install-wordpress/) เพื่อเตรียมเว็บไซต์ WordPress ของคุณก่อนดำเนินการต่อ

## การผสานระบบ \{#integration}

<Integration />

## การตั้งค่าการยืนยันตัวตน (Authentication) \{#authentication-settings}

แม้ว่าปลั๊กอินจะใช้งานได้ทันทีโดยไม่ต้องตั้งค่าเพิ่มเติม คุณสามารถปรับแต่งการตั้งค่าการยืนยันตัวตนในหน้าตั้งค่าปลั๊กอิน Logto เพื่อให้เหมาะกับความต้องการของคุณมากขึ้น

### ขอบเขต (Scopes) \{#scopes}

Logto ใช้ขอบเขต (Scopes) เพื่อควบคุมว่าข้อมูลใดจะถูกแชร์กับแอปพลิเคชันของคุณ ปลั๊กอิน WordPress ของ Logto ใช้ [Logto PHP SDK](https://github.com/logto-io/php) เพื่อจัดการกระบวนการยืนยันตัวตน ซึ่งรวมขอบเขตต่อไปนี้โดยค่าเริ่มต้น:

- `openid`: ขอบเขตพื้นฐานที่จำเป็นสำหรับ OpenID Connect
- `profile`: เพื่อรับข้อมูลโปรไฟล์พื้นฐานของผู้ใช้
- `offline_access`: เพื่อรับโทเค็นรีเฟรช (Refresh token) สำหรับการเข้าถึงแบบออฟไลน์

ดูข้อมูลเพิ่มเติมเกี่ยวกับขอบเขตได้ที่ [ขอบเขตและการอ้างสิทธิ์ (Scopes and claims)](/quick-starts/php#scopes-and-claims)

ปลั๊กอินยังเพิ่มขอบเขตเพิ่มเติมอีกสองรายการโดยค่าเริ่มต้น:

- `email`: เพื่อรับที่อยู่อีเมลของผู้ใช้
- `roles`: เพื่อรับบทบาท (Roles) ของผู้ใช้ใน Logto

ขอบเขตทั้งสองนี้ใช้สำหรับแมปอีเมลและบทบาทของ Logto กับอีเมลและบทบาทของ WordPress คุณสามารถปรับแต่งขอบเขตได้โดยแก้ไขฟิลด์ **Scopes** ในหน้าตั้งค่าปลั๊กอิน

:::warning
หากคุณลบขอบเขต `email` หรือ `roles` ฟีเจอร์บางอย่างของปลั๊กอินจะไม่ทำงานอย่างถูกต้อง
:::

### พารามิเตอร์เพิ่มเติม (Extra params) \{#extra-params}

คุณอาจต้องการเพิ่มพารามิเตอร์เพิ่มเติมในคำขอการยืนยันตัวตนเพื่อปรับแต่งกระบวนการยืนยันตัวตน เช่น คุณสามารถเพิ่มพารามิเตอร์ `first_screen` เพื่อกำหนดว่าจะให้แสดงหน้าจอใดก่อนในกระบวนการยืนยันตัวตน

ดูข้อมูลเพิ่มเติมเกี่ยวกับพารามิเตอร์เพิ่มเติมได้ที่ [พารามิเตอร์การยืนยันตัวตน (Authentication parameters)](/end-user-flows/authentication-parameters)

### ต้องการอีเมลที่ได้รับการยืนยัน (Require verified email) \{#require-verified-email}

โดยค่าเริ่มต้น ปลั๊กอินจะกำหนดให้ผู้ใช้ต้องมีอีเมลที่ได้รับการยืนยันใน Logto เพื่อเข้าสู่เว็บไซต์ WordPress ของคุณ หากผู้ใช้พยายามเข้าสู่ระบบโดยไม่มีอีเมลที่ได้รับการยืนยัน ปลั๊กอินจะแสดงข้อผิดพลาด

คุณสามารถปิดฟีเจอร์นี้ได้โดยยกเลิกการเลือกตัวเลือก **Require verified email** ในหน้าตั้งค่าปลั๊กอิน

### ต้องการรหัสองค์กร (Require organization ID) \{#require-organization-id}

คุณสามารถกำหนดให้ผู้ใช้ต้องเป็นสมาชิกขององค์กรที่ระบุใน Logto เพื่อเข้าสู่เว็บไซต์ WordPress ของคุณ เมื่อระบุรหัสองค์กรแล้ว ปลั๊กอินจะตรวจสอบว่าผู้ใช้มีรหัสองค์กรที่ระบุในโทเค็น ID หรือไม่ หากไม่มีจะเกิดข้อผิดพลาด

ดูข้อมูลเพิ่มเติมเกี่ยวกับองค์กรได้ที่ [องค์กร (Organizations)](/organizations)

## การตั้งค่าการอนุญาต (Authorization) \{#authorization-settings}

นอกจากการยืนยันตัวตนแล้ว Logto ยังมีฟีเจอร์การอนุญาต เช่น [การควบคุมการเข้าถึงตามบทบาท (RBAC)](/authorization/role-based-access-control) แม้คุณจะต้องเขียนโค้ดเองหากพัฒนาแอปของคุณเอง แต่ปลั๊กอิน WordPress ของ Logto มีวิธีแมปบทบาท Logto กับ [บทบาท WordPress](https://wordpress.org/documentation/article/roles-and-capabilities/) ในตัว

### การแมปบทบาท (Role mapping) \{#role-mapping}

ปลั๊กอิน WordPress ของ Logto อนุญาตให้คุณแมปบทบาท Logto กับบทบาท WordPress ได้ ซึ่งหมายความว่าคุณสามารถกำหนดบทบาทต่าง ๆ ให้กับผู้ใช้ใน Logto และปลั๊กอินจะกำหนดบทบาท WordPress ที่สอดคล้องกันให้กับผู้ใช้เหล่านั้นโดยอัตโนมัติเมื่อเข้าสู่ระบบ

ในการแมปบทบาท ให้คลิก **Add** ในส่วน **Role mapping** เพื่อเพิ่มการแมปบทบาทใหม่ เช่น หากคุณต้องการแมปบทบาท `group:editors` ใน Logto กับบทบาท `Editor` ใน WordPress ให้เพิ่มการแมปบทบาทใหม่โดยใช้ค่าต่อไปนี้:

- บทบาท Logto: `group:editors`
- บทบาท WordPress: `editor` (slug ของบทบาท `Editor` ใน WordPress)

คุณสามารถดู slug ของบทบาท WordPress ทั้งหมดได้ที่เอกสาร [Roles and Capabilities](https://wordpress.org/documentation/article/roles-and-capabilities/)

:::note
Slug ของบทบาทมีผลกับตัวพิมพ์เล็ก-ใหญ่ หากคุณกรอกชื่อบทบาทเป็น `Editor` แทนที่จะเป็น `editor` การแมปบทบาทจะไม่ทำงาน
:::

จากนั้นไปที่ Logto Console แล้วคลิก **Roles** ที่แถบด้านซ้าย สร้างบทบาทใหม่ชื่อ `group:editors` และกำหนดให้กับผู้ใช้ จากนั้นเข้าสู่เว็บไซต์ WordPress ด้วยผู้ใช้นั้น คุณจะเห็นว่าผู้ใช้ได้รับบทบาท `Editor` ใน WordPress

:::note
หากผู้ใช้ได้เข้าสู่เว็บไซต์ WordPress แล้ว การแมปบทบาทจะไม่มีผลจนกว่าผู้ใช้จะออกจากระบบและเข้าสู่ระบบใหม่
:::

คุณยังสามารถเพิ่มการแมปบทบาทหลายรายการเพื่อแมปบทบาท Logto หลายรายการกับบทบาท WordPress ได้ ขณะนี้ปลั๊กอินจะพยายามแมปบทบาทตามลำดับความสำคัญ เช่น หากคุณมีการแมปบทบาทดังนี้:

- บทบาท Logto: `group:editors`, บทบาท WordPress: `editor`
- บทบาท Logto: `group:authors`, บทบาท WordPress: `author`
- บทบาท Logto: `group:subscribers`, บทบาท WordPress: `subscriber`

และผู้ใช้มีทั้งบทบาท `group:editors` และ `group:authors` ใน Logto ผู้ใช้จะได้รับบทบาท `Editor` ใน WordPress

## การตั้งค่าขั้นสูง \{#advanced-settings}

### จดจำเซสชัน (Remember session) \{#remember-session}

โดยค่าเริ่มต้น ปลั๊กอินจะจดจำเซสชันของผู้ใช้เป็นเวลา 2 สัปดาห์ หมายความว่าหากผู้ใช้เข้าสู่เว็บไซต์ WordPress ของคุณ จะไม่ถูกขอให้เข้าสู่ระบบอีกเป็นเวลา 2 สัปดาห์ คุณสามารถลดเวลานี้เหลือ 2 วันได้โดยยกเลิกการเลือกตัวเลือก **Remember session** ในหน้าตั้งค่าปลั๊กอิน

### ซิงค์โปรไฟล์ (Sync profile) \{#sync-profile}

โดยค่าเริ่มต้น ปลั๊กอินจะซิงค์โปรไฟล์ของผู้ใช้ทุกครั้งที่เข้าสู่ระบบ หมายความว่าหากผู้ใช้เข้าสู่เว็บไซต์ WordPress โปรไฟล์ของเขาจะได้รับการอัปเดตด้วยข้อมูลล่าสุดจาก Logto คุณสามารถปิดฟีเจอร์นี้ได้โดยยกเลิกการเลือกตัวเลือก **Sync profile** ในหน้าตั้งค่าปลั๊กอิน

:::warning
หากคุณปิดฟีเจอร์นี้ การแมปบทบาทจะมีผลเฉพาะเมื่อผู้ใช้เข้าสู่ระบบครั้งแรกเท่านั้น
:::

### การเข้าสู่ระบบด้วยฟอร์ม WordPress (WordPress form login) \{#wordpress-form-login}

โดยค่าเริ่มต้น คุณสามารถเติม `?form=1` ต่อท้าย URL เข้าสู่ระบบ WordPress เพื่อใช้ฟอร์มเข้าสู่ระบบของ WordPress ได้ ฟีเจอร์นี้เหมาะสำหรับการทดสอบ แต่คุณสามารถปิดได้หากไม่ต้องการให้ผู้ใช้เข้าสู่ระบบด้วยฟอร์ม WordPress

### กลยุทธ์ชื่อผู้ใช้ (Username strategy) \{#username-strategy}

มีหลายวิธีในการสร้างชื่อผู้ใช้สำหรับผู้ใช้ใน WordPress โดยทั่วไปปลอดภัยที่จะใช้กลยุทธ์เริ่มต้นเมื่อคุณใช้ email เป็นตัวระบุเฉพาะของผู้ใช้

## การแก้ไขปัญหา \{#troubleshooting}

### Callback URL แสดง 404 \{#callback-url-shows-404}

หาก Callback URL แสดงข้อผิดพลาด 404 อาจเป็นเพราะกฎ rewrite ของ WordPress ล้าสมัยและต้องรีเฟรชด้วยตนเอง ให้ไปที่ **Settings** > **Permalinks** ในแผงผู้ดูแล WordPress (หรือเข้าที่ `/wp-admin/options-permalink.php` โดยตรง) แล้วคลิก **Save Changes**

## คำถามที่พบบ่อย \{#frequently-asked-questions}

### จะเรียกใช้งานลืมรหัสผ่านได้อย่างไร? \{#how-can-i-trigger-the-forgot-password-flow}

มีสองวิธีในการเรียกใช้งานลืมรหัสผ่าน:

1. คลิกลิงก์ลืมรหัสผ่านในหน้าลงชื่อเข้าใช้ของ Logto
2. เติม `?action=lostpassword` ต่อท้าย URL เข้าสู่ระบบ WordPress เช่น `https://example.com/wp-login.php?action=lostpassword`
   ระบบจะเปลี่ยนเส้นทางไปยังหน้าลืมรหัสผ่านของ Logto

### จะใช้ฟอร์มเข้าสู่ระบบ WordPress ได้อย่างไร? \{#how-can-i-use-the-wordpress-form-login}

โดยค่าเริ่มต้น คุณสามารถเติม `?form=1` ต่อท้าย URL เข้าสู่ระบบ WordPress เพื่อใช้ฟอร์มเข้าสู่ระบบ WordPress เช่น `https://example.com/wp-login.php?form=1`

หากต้องการปิดฟีเจอร์นี้ ให้ยกเลิกการเลือกตัวเลือก **WordPress form login** ในหน้าตั้งค่าปลั๊กอิน

## อ่านเพิ่มเติม \{#further-readings}

<FurtherReadings />
