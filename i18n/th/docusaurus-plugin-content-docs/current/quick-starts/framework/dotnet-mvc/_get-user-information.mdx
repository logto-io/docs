import FindUserInfoMissing from '../../fragments/_find-user-info-missing.mdx';
import ScopesAndClaims from '../../fragments/_scopes-and-claims.mdx';
import ScopesAndClaimsIntroduction from '../../fragments/_scopes-claims-introduction.md';

### แสดงข้อมูลผู้ใช้ \{#display-user-information}

หากต้องการทราบว่าผู้ใช้ได้รับการยืนยันตัวตนหรือไม่ คุณสามารถตรวจสอบพร็อพเพอร์ตี้ `User.Identity?.IsAuthenticated`

หากต้องการรับการอ้างสิทธิ์ (claims) โปรไฟล์ของผู้ใช้ คุณสามารถใช้พร็อพเพอร์ตี้ `User.Claims` ได้ดังนี้:

```csharp title="Controllers/HomeController.cs"
var claims = User.Claims;

// รับ user ID
var userId = claims.FirstOrDefault(c => c.Type == LogtoParameters.Claims.Subject)?.Value;
```

ดู [`LogtoParameters.Claims`](https://github.com/logto-io/csharp/blob/master/src/Logto.AspNetCore.Authentication/LogtoParameters.cs) สำหรับรายชื่อการอ้างสิทธิ์และความหมาย

### ขอการอ้างสิทธิ์เพิ่มเติม \{#request-additional-claims}

<FindUserInfoMissing method="User.Claims" />

<ScopesAndClaimsIntroduction />

หากต้องการขอขอบเขต (scopes) เพิ่มเติม คุณสามารถกำหนดพร็อพเพอร์ตี้ `Scopes` ในอ็อบเจกต์ `options` ได้ดังนี้:

```csharp title="Program.cs"
builder.Services.AddLogtoAuthentication(options =>
{
  // ...
  // highlight-start
  options.Scopes = new string[] {
    LogtoParameters.Scopes.Email,
    LogtoParameters.Scopes.Phone
  }
  // highlight-end
});
```

จากนั้นคุณสามารถเข้าถึงการอ้างสิทธิ์เพิ่มเติมผ่าน `User.Claims` ได้:

```csharp title="Controllers/HomeController.cs"
var claims = User.Claims;

// รับอีเมลของผู้ใช้
var email = claims.FirstOrDefault(c => c.Type == LogtoParameters.Claims.Email)?.Value;
```

### การอ้างสิทธิ์ที่ต้องร้องขอผ่านเครือข่าย \{#claims-that-need-network-request}

เพื่อป้องกันไม่ให้อ็อบเจกต์ผู้ใช้มีขนาดใหญ่เกินไป การอ้างสิทธิ์บางรายการจำเป็นต้องร้องขอผ่านเครือข่าย เช่น การอ้างสิทธิ์ custom_data จะไม่ถูกรวมอยู่ในอ็อบเจกต์ผู้ใช้ แม้ว่าจะร้องขอไว้ใน scopes ก็ตาม หากต้องการดึงการอ้างสิทธิ์เหล่านี้ คุณสามารถตั้งค่า `GetClaimsFromUserInfoEndpoint` เป็น `true` ในอ็อบเจกต์ `options` ได้ดังนี้:

```csharp title="Program.cs"
builder.Services.AddLogtoAuthentication(options =>
{
  // ...
  // highlight-next-line
  options.GetClaimsFromUserInfoEndpoint = true;
});
```

### ขอบเขตและการอ้างสิทธิ์{scopes-and-claims} \{#scopes-and-claims}

<ScopesAndClaims />
