## ขั้นตอนที่ 1: สร้าง OAuth app บน GitHub \{#step-1-create-an-oauth-app-on-github}

ก่อนที่คุณจะใช้ GitHub เป็นผู้ให้บริการการยืนยันตัวตน คุณต้องสร้าง OAuth App บน GitHub เพื่อรับข้อมูลประจำตัว OAuth 2.0

1. ไปที่ [GitHub](https://github.com/) และลงชื่อเข้าใช้ด้วยบัญชีของคุณ หรือสร้างบัญชีใหม่หากจำเป็น
2. ไปที่ [Settings > Developer settings > OAuth apps](https://github.com/settings/developers)
3. คลิก **New OAuth App** เพื่อขึ้นทะเบียนแอปใหม่:
   - **Application name**: กรอกชื่อที่สื่อความหมายสำหรับแอปของคุณ
   - **Homepage URL**: กรอก URL หน้าแรกของแอปพลิเคชันของคุณ
   - **Authorization callback URL**: คัดลอก **Callback URI** จากตัวเชื่อมต่อ GitHub ของคุณใน Logto แล้ววางที่นี่ หลังจากผู้ใช้ลงชื่อเข้าใช้ด้วย GitHub แล้ว พวกเขาจะถูกเปลี่ยนเส้นทางมาที่นี่พร้อมรหัสการอนุญาตที่ Logto ใช้เพื่อดำเนินการยืนยันตัวตนให้เสร็จสมบูรณ์
   - **Application description**: (ไม่บังคับ) เพิ่มคำอธิบายสั้น ๆ เกี่ยวกับแอปของคุณ
4. คลิก **Register application** เพื่อสร้าง OAuth App

:::note
เราแนะนำว่าไม่ควรติ๊กเลือก **Enable Device Flow** เพราะผู้ใช้ที่ลงชื่อเข้าใช้ด้วย GitHub บนอุปกรณ์มือถือจะต้องยืนยันการลงชื่อเข้าใช้ครั้งแรกในแอป GitHub บนมือถือ ซึ่งผู้ใช้ GitHub จำนวนมากไม่ได้ติดตั้งแอป GitHub บนโทรศัพท์ อาจทำให้ขั้นตอนการลงชื่อเข้าใช้ติดขัด เปิดใช้งานเฉพาะเมื่อคุณคาดว่าผู้ใช้จะยืนยันการลงชื่อเข้าใช้ผ่านแอป GitHub บนมือถือเท่านั้น ดูรายละเอียดเกี่ยวกับ [device flow](https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps#device-flow)

สำหรับรายละเอียดเพิ่มเติมเกี่ยวกับการตั้งค่า GitHub OAuth Apps ดูที่ [Creating an OAuth App](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/creating-an-oauth-app)
:::

## ขั้นตอนที่ 2: ตั้งค่าตัวเชื่อมต่อ Logto ของคุณ \{#step-2-configure-your-logto-connector}

หลังจากสร้าง OAuth app ใน GitHub แล้ว คุณจะถูกเปลี่ยนเส้นทางไปยังหน้ารายละเอียดซึ่งคุณสามารถคัดลอก Client ID และสร้าง Client secret ได้

1. คัดลอก **Client ID** จาก GitHub OAuth app ของคุณแล้ววางลงในช่อง `clientId` ใน Logto
2. คลิก **Generate a new client secret** ใน GitHub เพื่อสร้าง secret ใหม่ จากนั้นคัดลอกและวางลงในช่อง `clientSecret` ใน Logto
3. คลิก **Save and Done** ใน Logto เพื่อเชื่อมต่อระบบข้อมูลระบุตัวตนของคุณกับ GitHub

:::warning
เก็บรักษา Client secret ของคุณให้ปลอดภัยและอย่าเปิดเผยในโค้ดฝั่งไคลเอนต์ Client secret ของ GitHub ไม่สามารถกู้คืนได้หากสูญหาย — คุณจะต้องสร้างใหม่เท่านั้น
:::

## ขั้นตอนที่ 3: ตั้งค่าขอบเขต (Scopes) (ไม่บังคับ) \{#step-3-configure-scopes-optional}

ขอบเขต (Scopes) กำหนดสิทธิ์ที่แอปของคุณร้องขอจากผู้ใช้ และควบคุมว่าแอปของคุณจะเข้าถึงข้อมูลใดจากบัญชี GitHub ของพวกเขาได้บ้าง

ใช้ช่อง `Scopes` ใน Logto เพื่อร้องขอสิทธิ์เพิ่มเติมจาก GitHub เลือกวิธีการต่อไปนี้ตามความต้องการของคุณ:

### ตัวเลือกที่ 1: ไม่ต้องการขอบเขต API เพิ่มเติม \{#option-1-no-extra-api-scopes-needed}

- เว้นว่างช่อง `Scopes` ในตัวเชื่อมต่อ GitHub ของคุณใน Logto
- ขอบเขตเริ่มต้น `read:user` จะถูกขอโดยอัตโนมัติเพื่อให้ Logto สามารถดึงข้อมูลผู้ใช้พื้นฐาน (เช่น อีเมล ชื่อ รูปโปรไฟล์) ได้อย่างถูกต้อง

### ตัวเลือกที่ 2: ขอขอบเขตเพิ่มเติมขณะลงชื่อเข้าใช้ \{#option-2-request-additional-scopes-at-sign-in}

- ดู [GitHub scopes สำหรับ OAuth apps ทั้งหมด](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/scopes-for-oauth-apps) และเพิ่มเฉพาะขอบเขตที่แอปของคุณต้องการ
- กรอกขอบเขตทั้งหมดที่ต้องการในช่อง **Scopes** โดยคั่นด้วยช่องว่าง
- ขอบเขตที่คุณระบุที่นี่จะเขียนทับค่าตั้งต้น ดังนั้นควรใส่ขอบเขตการยืนยันตัวตนเสมอ: `read:user`
- ขอบเขตเพิ่มเติมที่พบบ่อย เช่น:
  - `repo`: ควบคุม repository ส่วนตัวทั้งหมด
  - `public_repo`: เข้าถึง repository สาธารณะ
  - `user:email`: เข้าถึงอีเมลของผู้ใช้
  - `notifications`: เข้าถึงการแจ้งเตือน
- ตรวจสอบให้แน่ใจว่าขอบเขตทั้งหมดสะกดถูกต้องและใช้งานได้ ขอบเขตที่ผิดหรือไม่รองรับจะทำให้เกิดข้อผิดพลาด "Invalid scope" จาก GitHub

### ตัวเลือกที่ 3: ขอขอบเขตเพิ่มเติมภายหลัง \{#option-3-request-incremental-scopes-later}

- หลังจากผู้ใช้ลงชื่อเข้าใช้แล้ว คุณสามารถร้องขอขอบเขตเพิ่มเติมตามต้องการโดยเริ่ม federated social authorization flow ใหม่และอัปเดต token set ของผู้ใช้
- ขอบเขตเพิ่มเติมเหล่านี้ไม่จำเป็นต้องกรอกในช่อง `Scopes` ของตัวเชื่อมต่อ GitHub ใน Logto และสามารถทำได้ผ่าน Social Verification API ของ Logto

เมื่อทำตามขั้นตอนเหล่านี้ ตัวเชื่อมต่อ GitHub ของคุณใน Logto จะร้องขอสิทธิ์ที่แอปของคุณต้องการอย่างพอดี — ไม่มากหรือน้อยเกินไป

:::tip
หากแอปของคุณร้องขอขอบเขตเหล่านี้เพื่อเข้าถึง GitHub API และดำเนินการต่าง ๆ อย่าลืมเปิดใช้งาน **Store tokens for persistent API access** ในตัวเชื่อมต่อ GitHub ของ Logto ดูรายละเอียดในหัวข้อถัดไป
:::

## ขั้นตอนที่ 4: การตั้งค่าทั่วไป \{#step-4-general-settings}

นี่คือการตั้งค่าทั่วไปบางประการที่แม้จะไม่ขัดขวางการเชื่อมต่อกับ GitHub แต่ก็อาจมีผลต่อประสบการณ์การยืนยันตัวตนของผู้ใช้ปลายทาง

### ซิงค์ข้อมูลโปรไฟล์ \{#sync-profile-information}

ในตัวเชื่อมต่อ GitHub คุณสามารถตั้งค่านโยบายการซิงค์ข้อมูลโปรไฟล์ เช่น ชื่อผู้ใช้และรูปโปรไฟล์ ได้ดังนี้:

- **ซิงค์เฉพาะตอนสมัครสมาชิก**: ดึงข้อมูลโปรไฟล์ครั้งเดียวเมื่อผู้ใช้ลงชื่อเข้าใช้ครั้งแรก
- **ซิงค์ทุกครั้งที่ลงชื่อเข้าใช้**: อัปเดตข้อมูลโปรไฟล์ทุกครั้งที่ผู้ใช้ลงชื่อเข้าใช้

### เก็บโทเค็นเพื่อเข้าถึง GitHub APIs (ไม่บังคับ) \{#store-tokens-to-access-github-apis-optional}

หากคุณต้องการเข้าถึง GitHub APIs และดำเนินการต่าง ๆ ด้วยการอนุญาตของผู้ใช้ (ไม่ว่าจะผ่าน social sign-in หรือ account linking) Logto จำเป็นต้องขอขอบเขต API ที่เกี่ยวข้องและเก็บโทเค็นไว้

1. เพิ่มขอบเขตที่ต้องการตามคำแนะนำข้างต้น
2. เปิดใช้งาน **Store tokens for persistent API access** ในตัวเชื่อมต่อ GitHub ของ Logto Logto จะเก็บ GitHub access token ไว้อย่างปลอดภัยใน Secret Vault

:::note
เมื่อใช้ **OAuth App** ของ GitHub ตามที่อธิบายไว้ในคู่มือนี้ คุณจะไม่ได้รับ refresh token จาก GitHub เพราะ access token จะไม่มีวันหมดอายุ เว้นแต่ผู้ใช้จะเพิกถอนด้วยตนเอง ดังนั้นคุณไม่จำเป็นต้องเพิ่ม `offline_access` ในช่อง `Scopes` — การเพิ่มอาจทำให้เกิดข้อผิดพลาด

หากคุณต้องการให้ access token หมดอายุหรือใช้ refresh token ให้พิจารณาเชื่อมต่อกับ **GitHub App** แทน ศึกษา [ความแตกต่างระหว่าง GitHub Apps และ OAuth Apps](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/differences-between-github-apps-and-oauth-apps)
:::

## ขั้นตอนที่ 5: ทดสอบการเชื่อมต่อของคุณ (ไม่บังคับ) \{#step-5-test-your-integration-optional}

ก่อนเปิดใช้งานจริง ให้ทดสอบการเชื่อมต่อ GitHub ของคุณ:

1. ใช้ตัวเชื่อมต่อใน Logto development tenant
2. ตรวจสอบว่าผู้ใช้สามารถลงชื่อเข้าใช้ด้วย GitHub ได้
3. ตรวจสอบว่าขอบเขตที่ร้องขอถูกต้อง
4. ทดสอบเรียก API หากคุณเก็บโทเค็นไว้

GitHub OAuth Apps สามารถใช้งานได้กับบัญชีผู้ใช้ GitHub ทันที — ไม่จำเป็นต้องมีผู้ใช้ทดสอบหรือขออนุมัติแอปเหมือนบางแพลตฟอร์มอื่น
