:::note

Apple sign-in เป็นข้อบังคับสำหรับ AppStore หากแอปของคุณมีวิธีเข้าสู่ระบบโซเชียลอื่น ๆ
การมี Apple sign-in บนอุปกรณ์ Android ก็เป็นเรื่องดีหากคุณมีแอป Android ด้วย

:::

คุณต้องสมัครเข้าร่วม [Apple Developer Program](https://developer.apple.com/programs/) ก่อนดำเนินการต่อ

### เปิดใช้งาน Sign in with Apple สำหรับแอปของคุณ \{#enable-sign-in-with-apple-for-your-app}

:::caution

แม้ว่าคุณต้องการใช้งาน Sign in with Apple เฉพาะบนเว็บแอป คุณก็ยังจำเป็นต้องมีแอปที่อยู่ในระบบนิเวศของ AppStore (เช่น ต้องมี App ID ที่ถูกต้อง)

:::

คุณสามารถทำได้ผ่าน Xcode -> Project settings -> Signing & Capabilities หรือเข้าไปที่ [Certificates, Identifiers & Profiles](https://developer.apple.com/account/resources/identifiers/list/bundleId)

<img src="/img/assets/enable-sign-in-with-apple-in-xcode.png" alt="Enable Sign in with Apple" />

ดูหัวข้อ "Enable an App ID" ใน [เอกสารทางการของ Apple](https://developer.apple.com/documentation/sign_in_with_apple/configuring_your_environment_for_sign_in_with_apple) สำหรับข้อมูลเพิ่มเติม

### สร้าง identifier \{#create-an-identifier}

1. ไปที่ [Certificates, Identifiers & Profiles](https://developer.apple.com/account/resources/identifiers/list/serviceId) แล้วคลิกปุ่ม "+" ข้าง "Identifier"
2. ในหน้า "Register a new identifier" เลือก "Services IDs" แล้วคลิก "Continue"
3. กรอก "Description" และ "Identifier" (เช่น `Logto Test` และ `io.logto.test`) จากนั้นคลิก "Continue"
4. ตรวจสอบข้อมูลอีกครั้งแล้วคลิก "Register"

### เปิดใช้งาน Sign in with Apple สำหรับ identifier ของคุณ \{#enable-sign-in-with-apple-for-your-identifier}

คลิก identifier ที่คุณเพิ่งสร้างขึ้น ตรวจสอบ "Sign in with Apple" ในหน้ารายละเอียดแล้วคลิก "Configure"

<img src="/img/assets/enable-sign-in-with-apple.png" alt="Enable Sign in with Apple" />

ในหน้าต่างที่เปิดขึ้น ให้เลือก App ID ที่คุณเพิ่งเปิดใช้งาน Sign in with Apple

กรอกโดเมนของ Logto instance ของคุณโดยไม่ต้องใส่ protocol และ port เช่น `your.logto.domain` จากนั้นกรอก "Return URL" (หรือ Redirect URI) ซึ่งก็คือ URL ของ Logto ตามด้วย `/callback/${connector_id}` เช่น `https://your.logto.domain/callback/apple-universal` คุณจะได้รับ `connector_id` ที่สร้างแบบสุ่มหลังจากสร้าง Apple connector ใน Admin Console

<img src="/img/assets/domain-and-url.png" alt="Domain and URL" />

คลิก "Next" แล้ว "Done" เพื่อปิดหน้าต่าง จากนั้นคลิก "Continue" ที่มุมขวาบน แล้วคลิก "Save" เพื่อบันทึกการตั้งค่าของคุณ

:::caution

Apple ไม่อนุญาตให้ใช้ Return URL ที่เป็น HTTP protocol และโดเมน `localhost`

หากคุณต้องการทดสอบในเครื่อง คุณต้องแก้ไขไฟล์ `/etc/hosts` เพื่อแมป localhost กับโดเมนที่กำหนดเอง และตั้งค่า environment HTTPS ในเครื่อง [mkcert](https://github.com/FiloSottile/mkcert) สามารถช่วยคุณตั้งค่า HTTPS ในเครื่องได้

:::

## กำหนดค่า scope \{#configure-scope}

หากต้องการรับอีเมลของผู้ใช้จาก Apple คุณต้องกำหนดค่า scope ให้มี `email` สำหรับทั้งอีเมลและชื่อ คุณสามารถใช้ `name email` เป็น scope ดูข้อมูลเพิ่มเติมได้ที่ [เอกสารทางการของ Apple](https://developer.apple.com/documentation/sign_in_with_apple/sign_in_with_apple_js/incorporating_sign_in_with_apple_into_other_platforms#3332113)

:::note

ผู้ใช้อาจเลือกซ่อนที่อยู่อีเมลจากแอปของคุณ ในกรณีนี้คุณจะไม่สามารถดึงอีเมลจริงได้ ระบบจะส่งอีเมลลักษณะนี้กลับมาแทน `random@privaterelay.appleid.com`

:::
