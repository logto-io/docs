---
id: webhooks-request
title: คำขอ Webhooks
sidebar_label: คำขอ Webhooks
sidebar_position: 4
---

# คำขอ Webhooks

เมื่อมีการปล่อยเหตุการณ์ hook ที่ถูกต้อง Logto จะค้นหา webhooks ที่เกี่ยวข้องและส่งคำขอ POST ต่อ hook config แต่ละรายการ

## ส่วนหัวของคำขอ \{#request-headers}

| Key                     | ปรับแต่งได้ | หมายเหตุ                                                                                                   |
| ----------------------- | ----------- | ---------------------------------------------------------------------------------------------------------- |
| user-agent              | ✅          | ค่าเริ่มต้นคือ `Logto (https://logto.io/)`                                                                 |
| content-type            | ✅          | ค่าเริ่มต้นคือ `application/json`                                                                          |
| logto-signature-sha-256 |             | ลายเซ็นของเนื้อหา request ดูที่ [การรักษาความปลอดภัย webhook ของคุณ](/developers/webhooks/secure-webhooks) |

คุณสามารถเขียนทับ header ที่ปรับแต่งได้โดย [ปรับแต่ง request](/developers/webhooks/configure-webhooks/#secure-webhook) header ด้วย key เดียวกัน

## เนื้อหาคำขอของเหตุการณ์ interaction hook \{#interaction-hook-events-request-body}

เหตุการณ์ที่ใช้ได้: `PostRegister`, `PostSignIn`, `PostResetPassword`

เนื้อหาคำขอเป็นอ็อบเจกต์ JSON ที่มีข้อมูล 3 ประเภทดังนี้:

```tsx
type UserEntity = {
  id: string;
  username?: string;
  primaryEmail?: string;
  primaryPhone?: string;
  name?: string;
  avatar?: string;
  customData?: object;
  identities?: object;
  lastSignInAt?: string;
  createdAt?: string;
  applicationId?: string;
  isSuspended?: boolean;
};
```

```tsx
enum ApplicationType {
  Native = 'Native',
  SPA = 'SPA',
  Traditional = 'Traditional',
  MachineToMachine = 'MachineToMachine',
  Protected = 'Protected',
  SAML = 'SAML',
}

type ApplicationEntity = {
  id: string;
  type: ApplicationType;
  name: string;
  description?: string;
};
```

| Field            | Type                | Optional | หมายเหตุ                                                      |
| ---------------- | ------------------- | -------- | ------------------------------------------------------------- |
| hookId           | `string`            |          | ตัวระบุใน Logto                                               |
| event            | `string`            |          | เหตุการณ์ที่เรียกใช้ hook นี้                                 |
| createdAt        | `string`            |          | เวลาสร้าง payload ในรูปแบบ ISO                                |
| interactionEvent | `string`            |          | เหตุการณ์ interaction ที่เรียกใช้ hook นี้                    |
| sessionId        | `string`            | ✅       | Session ID (ไม่ใช่ Interaction ID) สำหรับเหตุการณ์นี้ (ถ้ามี) |
| userAgent        | `string`            | ✅       | user-agent ของคำขอที่เรียกใช้ hook นี้                        |
| userIp           | `string`            | ✅       | ที่อยู่ IP ของคำขอที่เรียกใช้ hook นี้                        |
| userId           | `string`            | ✅       | User ID ที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)                  |
| user             | `UserEntity`        | ✅       | user entity ที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)              |
| applicationId    | `string`            | ✅       | Application ID ที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)           |
| application      | `ApplicationEntity` | ✅       | ข้อมูลแอปพลิเคชันที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)         |

ดูข้อมูลอ้างอิง [ผู้ใช้](/user-management/user-data) และ [แอปพลิเคชัน](/integrate-logto/application-data-structure) สำหรับคำอธิบาย field โดยละเอียด

## เนื้อหาคำขอของเหตุการณ์ data mutation hook \{#data-mutation-hook-events-request-body}

### ฟิลด์มาตรฐานของเนื้อหาคำขอ \{#standard-request-body-fields}

| Field     | Type     | Optional | หมายเหตุ                       |
| --------- | -------- | -------- | ------------------------------ |
| hookId    | `string` |          | ตัวระบุใน Logto                |
| event     | `string` |          | เหตุการณ์ที่เรียกใช้ hook นี้  |
| createdAt | `string` |          | เวลาสร้าง payload ในรูปแบบ ISO |
| userAgent | `string` | ✅       | user-agent ของคำขอ             |
| ip        | `string` | ✅       | ที่อยู่ IP ของคำขอ             |

### ฟิลด์ context ของ Interaction API \{#interaction-api-context-body-fields}

เหตุการณ์ data mutation hook ที่ถูกเรียกโดยการเรียก API interaction ของผู้ใช้

เหตุการณ์ที่ใช้ได้: `User.Created`, `User.Data.Updated`

| Field            | Type                | Optional | หมายเหตุ                                                      |
| ---------------- | ------------------- | -------- | ------------------------------------------------------------- |
| interactionEvent | `string`            | ✅       | เหตุการณ์ interaction ที่เรียกใช้ hook นี้                    |
| sessionId        | `string`            | ✅       | Session ID (ไม่ใช่ Interaction ID) สำหรับเหตุการณ์นี้ (ถ้ามี) |
| applicationId    | `string`            | ✅       | Application ID ที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)           |
| application      | `ApplicationEntity` | ✅       | ข้อมูลแอปพลิเคชันที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)         |

### ฟิลด์ context ของ Management API \{#management-api-context-body-fields}

เหตุการณ์ data mutation hook ที่ถูกเรียกโดยการเรียก Management API

| Field        | Type     | Optional | หมายเหตุ                                                                                                        |
| ------------ | -------- | -------- | --------------------------------------------------------------------------------------------------------------- |
| path         | `string` | ✅       | path ของ API call ที่เรียกใช้ hook นี้                                                                          |
| method       | `string` | ✅       | method ของ API call ที่เรียกใช้ hook นี้                                                                        |
| status       | `number` | ✅       | รหัสสถานะตอบกลับของ API call ที่เรียกใช้ hook นี้                                                               |
| params       | `object` | ✅       | koa path params ของ API call ที่เรียกใช้ hook นี้                                                               |
| matchedRoute | `string` | ✅       | koa matched route ของ API call ที่เรียกใช้ hook นี้ Logto ใช้ field นี้เพื่อจับคู่กับ hook events ที่เปิดใช้งาน |

### ฟิลด์เนื้อหาข้อมูล (Data payload body fields) \{#data-payload-body-fields}

**เหตุการณ์ผู้ใช้**

| Event             | Field | Type       | Optional | หมายเหตุ                                   |
| ----------------- | ----- | ---------- | -------- | ------------------------------------------ |
| User.Created      | data  | UserEntity |          | user entity ที่ถูกสร้างสำหรับเหตุการณ์นี้  |
| User.Data.Updated | data  | UserEntity |          | user entity ที่ถูกอัปเดตสำหรับเหตุการณ์นี้ |
| User.Deleted      | data  | null       | /        |                                            |

**เหตุการณ์บทบาท (Role events)**

```tsx
type Role = {
  id: string;
  name: string;
  description: string;
  type: 'User' | 'MachineToMachine';
  isDefault: boolean;
};
```

```tsx
type Scope = {
  id: string;
  name: string;
  description: string;
  resourceId: string;
  createdAt: number;
};
```

| Event              | Field  | Type    | Optional | หมายเหตุ                                                                                                      |
| ------------------ | ------ | ------- | -------- | ------------------------------------------------------------------------------------------------------------- |
| Role.Created       | data   | Role    |          | role entity ที่ถูกสร้างสำหรับเหตุการณ์นี้                                                                     |
| Role.Data.Updated  | data   | Role    |          | role entity ที่ถูกอัปเดตสำหรับเหตุการณ์นี้                                                                    |
| Role.Deleted       | data   | null    |          |                                                                                                               |
| Role.Scope.Updated | data   | Scope[] |          | scopes ที่ถูกอัปเดตและกำหนดให้กับ role                                                                        |
| Role.Scope.Updated | roleId | string  | ✅       | role ID ที่ scopes ถูกกำหนดให้ (มีเฉพาะเมื่อเหตุการณ์ถูกเรียกโดยการสร้าง role ใหม่พร้อมกำหนด scopes ล่วงหน้า) |

**เหตุการณ์สิทธิ์ (Permission / Scope events)**

| Event              | Field | Type  | Optional | หมายเหตุ                                    |
| ------------------ | ----- | ----- | -------- | ------------------------------------------- |
| Scope.Created      | data  | Scope |          | scope entity ที่ถูกสร้างสำหรับเหตุการณ์นี้  |
| Scope.Data.Updated | data  | Scope |          | scope entity ที่ถูกอัปเดตสำหรับเหตุการณ์นี้ |
| Scope.Deleted      | data  | null  | /        |                                             |

**เหตุการณ์องค์กร (Organization events)**

```tsx
type Organization = {
  id: string;
  name: string;
  description?: string;
  customData: object;
  createdAt: number;
};
```

| Event                           | Field | Type         | Optional | หมายเหตุ                                           |
| ------------------------------- | ----- | ------------ | -------- | -------------------------------------------------- |
| Organization.Created            | data  | Organization |          | organization entity ที่ถูกสร้างสำหรับเหตุการณ์นี้  |
| Organization.Data.Updated       | data  | Organization |          | organization entity ที่ถูกอัปเดตสำหรับเหตุการณ์นี้ |
| Organization.Deleted            | data  | null         | /        |                                                    |
| Organization.Membership.Updated | data  | null         | /        |                                                    |

**เหตุการณ์ OrganizationRole**

```tsx
type OrganizationRole = {
  id: string;
  name: string;
  description?: string;
};
```

```tsx
type OrganizationScope = {
  id: string;
  name: string;
  description?: string;
};
```

| Event                          | Field              | Type             | Optional | หมายเหตุ                                                                                                      |
| ------------------------------ | ------------------ | ---------------- | -------- | ------------------------------------------------------------------------------------------------------------- |
| OrganizationRole.Created       | data               | OrganizationRole |          | organization role entity ที่ถูกสร้างสำหรับเหตุการณ์นี้                                                        |
| OrganizationRole.Data.Updated  | data               | OrganizationRole |          | organization role entity ที่ถูกอัปเดตสำหรับเหตุการณ์นี้                                                       |
| OrganizationRole.Deleted       | data               | null             | /        |                                                                                                               |
| OrganizationRole.Scope.Updated | data               | null             | /        |                                                                                                               |
| OrganizationRole.Scope.Updated | organizationRoleId | string           | ✅       | role ID ที่ scopes ถูกกำหนดให้ (มีเฉพาะเมื่อเหตุการณ์ถูกเรียกโดยการสร้าง role ใหม่พร้อมกำหนด scopes ล่วงหน้า) |

**เหตุการณ์สิทธิ์ขององค์กร (Organization permission / OrganizationScope events)**

| Event                          | Field | Type              | Optional | หมายเหตุ                               |
| ------------------------------ | ----- | ----------------- | -------- | -------------------------------------- |
| OrganizationScope.Created      | data  | OrganizationScope |          | organization scope entity ที่ถูกสร้าง  |
| OrganizationScope.Data.Updated | data  | OrganizationScope |          | organization scope entity ที่ถูกอัปเดต |
| OrganizationScope.Deleted      | data  | null              | /        |                                        |

## เนื้อหาคำขอของเหตุการณ์ exception hook \{#exception-hook-events-request-body}

เหตุการณ์ที่ใช้ได้: `Identifier.Lockout`

เนื้อหาคำขอเป็นอ็อบเจกต์ JSON ที่มีฟิลด์มาตรฐานของเนื้อหาคำขอและฟิลด์เพิ่มเติมดังนี้:

```tsx
enum SignInIdentifier {
  Email = 'email',
  Phone = 'phone',
  Username = 'username',
}
```

| Field            | Type                | Optional | หมายเหตุ                                                      |
| ---------------- | ------------------- | -------- | ------------------------------------------------------------- |
| hookId           | `string`            |          | ตัวระบุใน Logto                                               |
| event            | `string`            |          | เหตุการณ์ที่เรียกใช้ hook นี้                                 |
| createdAt        | `string`            |          | เวลาสร้าง payload ในรูปแบบ ISO                                |
| userAgent        | `string`            | ✅       | user-agent ของคำขอ                                            |
| ip               | `string`            | ✅       | ที่อยู่ IP ของคำขอ                                            |
| interactionEvent | `string`            | ✅       | เหตุการณ์ interaction ที่เรียกใช้ hook นี้                    |
| sessionId        | `string`            | ✅       | Session ID (ไม่ใช่ Interaction ID) สำหรับเหตุการณ์นี้ (ถ้ามี) |
| applicationId    | `string`            | ✅       | Application ID ที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)           |
| application      | `ApplicationEntity` | ✅       | ข้อมูลแอปพลิเคชันที่เกี่ยวข้องกับเหตุการณ์นี้ (ถ้ามี)         |
| type             | `SignInIdentifier`  |          | ประเภท identifier ของผู้ใช้ เช่น email, phone หรือ username   |
| value            | `string`            |          | ค่า identifier ของผู้ใช้ที่ทำให้เกิด lockout                  |
