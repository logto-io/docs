name: Deploy

on:
  push:
    branches: [master]

concurrency: deploy

jobs:
  deploy:
    environment: production
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Setup Node and pnpm
        uses: silverhand-io/actions-node-pnpm-run-steps@v1.2.2

      - name: Configure Git user
        run: |
          git config --global user.email bot@silverhand.io
          git config --global user.name silverhand-bot

      - name: Deploy
        run: pnpm deploy
        env:
          GIT_USER: silverhand-bot
          GIT_PASS: ${{ secrets.GH_CI_TOKEN }}
