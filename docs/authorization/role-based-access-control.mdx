---
sidebar_position: 1
---

import globalApiResources from './assets/rbac-global-api-resources.png';
import organizationApiResources from './assets/rbac-organization-level-api-resources.png';
import organizationPermissions from './assets/rbac-organization-permissions.png';

# Role-based access control (RBAC)

[Role-based access control (RBAC)](https://auth.wiki/rbac) is a proven authorization model that maps real-world business actions to roles and permissions. This guide covers how RBAC works in Logto, practical design patterns, and best practices for building secure, scalable SaaS applications.

## What is RBAC?

RBAC lets you manage **who** can do **what** in your application by grouping permissions into roles. Users and clients are assigned one or more roles, which grant the permissions needed to access features, APIs, or data.

**Core concepts**

- **Role** A named set of permissions (e.g., `admin`, `viewer`, `billing-manager`).
- **Permission** An action or right (e.g., `manage:members`, `view:analytics`).
- **Scope** A synonym for permission, often used in OAuth 2.0 contexts.
- **Resource** The API or feature to which permissions apply.
- **User/Client** The entity assigned roles (end users, M2M clients).

:::note
In Logto (and OAuth 2.1), **“permissions” and “scopes” refer to the same concept** and are used interchangeably throughout this documentation.
:::

## RBAC in Logto

Logto provides flexible RBAC at both the **global** and **organization** levels to support multi-tenant SaaS:

- **Global roles** Assigned across the Logto tenant. Ideal for product-wide permissions, admins, or superusers.
- **Organization roles** Assigned within an organization. Perfect for organization-specific access, such as workspace admins, project members, or custom groups.
- **Resources** Registered APIs and features that require authorization.
- **Permissions (scopes)** Defined per API resource or in the organization template.
  - API resource permissions can be assigned to either global or organization roles.
  - Organization permissions can be assigned only to organization roles.

Depending on your product’s needs, you can use these RBAC models separately or in combination.

Below are three illustrative examples with diagrams:

### Model 1: Global API resources

**Scenario**

A SaaS product with APIs shared across all users, regardless of organization.
Use global roles to control access to product-wide API resources.

**Diagram**

<img src={globalApiResources} alt="Global API resources RBAC" style={{ maxWidth: '100%' }} />

**Key points**

- **Users** and **M2M apps** are assigned global roles (e.g., Store manager, Service agent).
- Roles grant permissions (scopes), such as `read:store`, `order:book`.
- Permissions are linked directly to API resources (e.g., `https://read.shop/stores`).

**When to use**

When access is not organization-specific or users/clients operate across all organizations.

:::note
Logto doesn't support non-API permissions at the global level since it is reserved for OpenID Connect (OIDC) scopes.
:::

### Model 2: Organization (non-API) permissions

**Scenario**

Controlling in-app features or workflows that aren’t enforced at the API layer (such as gating UI features, dashboards, or internal tools) using organization roles and permissions.

**Diagram**

<img
  src={organizationPermissions}
  alt="Organization permissions RBAC"
  style={{ maxWidth: '800px', width: '100%' }}
/>

**Key points**

- Each organization (A and B) has its own assignments, but all organizations share a common set of roles defined in the organization template.
- **Users** and **M2M apps** can have different roles in each organization.
- **Organization roles** (e.g., Admin, Member) grant organization permissions like `invite:member`, `manage:billing`.
- Permissions are enforced in the app’s UI or business logic, not by the API gateway.

**When to use**

When you want to manage who can see or use features inside an organization when API-level enforcement isn’t needed.

### Model 3: Organization-level API resources

**Scenario**

A multi-tenant SaaS platform where each organization has its own members, data, and roles.
Use **organization roles** to grant API access within each organization.

**Diagram**

<img
  src={organizationApiResources}
  alt="Organization-level API resources RBAC"
  style={{ maxWidth: '100%' }}
/>

**Key points**

- Each organization (A and B) has its own assignments, but all organizations share a common set of roles defined in the organization template.
- **Users** and **M2M apps** can have different roles in each organization.
- Permissions (scopes), such as `invite:member`, `manage:billing` are linked to API resources.
- Permissions are enforced at the API level when the access token includes an organization context.

**When to use**

When you need to control API access based on organization context, such as allowing users to manage their own organization’s data.

## Design and implement a permission model

According to your product’s architecture and user needs, you can choose a suitable RBAC model from the examples above. Here’s a cheat sheet to help you design and implement your permission model effectively:

| Permission model                   | Define API resources with permissions? | Define organization permissions? | Use global roles? | Use organization roles? |
| ---------------------------------- | -------------------------------------- | -------------------------------- | ----------------- | ----------------------- |
| Global API resources               | ✅                                     | n/a                              | ✅                | n/a                     |
| Organization (non-API) permissions | n/a                                    | ✅                               | n/a               | ✅                      |
| Organization-level API resources   | ✅                                     | n/a                              | n/a               | ✅                      |

### Define API resources with permissions

Register your APIs via <CloudLink to="/api-resource">Console → API resources</CloudLink> or [Management API](https://openapi.logto.io/group/endpoint-resources) to define the API resources and their permissions (scopes).

:::note
In OAuth 2.0 and OIDC, an “API resource” is technically called a resource indicator, a unique URI that identifies your protected API or service.
:::

**Tips**

- Map API resource indicators to the real API endpoints to provide intuitive names.
  - For example, `https://api.example.com/v1/users`.
- Use clear, action-based naming (e.g., `invite:member`, `manage:billing`, `view:analytics`).
  - Alternatively, some genre may prefer a prefix or group by feature for clarity (e.g., `billing:read`, `billing:manage`).
- Keep permissions business-driven, not just technical endpoints.

**Example**

| API resource indicator            | Permission       | Description            |
| --------------------------------- | ---------------- | ---------------------- |
| `https://api.example.com/users`   | `invite:user`    | Invite new users       |
| `https://api.example.com/users`   | `manage:user`    | Update or delete users |
| `https://api.example.com/billing` | `view:billing`   | View billing details   |
| `https://api.example.com/billing` | `manage:billing` | Edit billing settings  |

### Define organization permissions

Define organization permissions in the [organization template](/authorization/organization-template) to control access to organization-specific features or workflows.

**Tips**

- Use clear, action-based names (e.g., `invite:member`, `manage:billing`).
- Keep organization permissions distinct from API permissions to avoid confusion.

**Example**

| Organization permission | Description                                |
| ----------------------- | ------------------------------------------ |
| `invite:member`         | Invite new members to the organization     |
| `manage:billing`        | Edit billing settings for the organization |

### Use global roles

Create global roles via <CloudLink to="/roles">Console → Roles</CloudLink> or [Management API](https://openapi.logto.io/group/endpoint-roles) to group permissions that apply across the entire Logto tenant.

A global role can one of the following:

- **User role**: Assigned to end users, granting permissions to access APIs and features.
- **Machine-to-machine (M2M) role**: Assigned to M2M clients, granting permissions to access APIs and features, including Logto Management API.

:::note
You can set one or more global role as **default roles** for new users. Default roles are the automatically assigned roles when the users are created, either for the self-sign-up or created through Management API. You can enable this toggle by going to “General” tab on the detail page under <CloudLink to="/roles">Console > Roles</CloudLink>.
:::

Please note that these two types of roles cannot be mixed or updated after creation. Assign users or M2M clients to the role, depending on its type.

### Use organization roles

Create organization roles in the [organization template](/authorization/organization-template) to group permissions that apply within each organization.

An organization role can be one of the following:

- **User role**: Assigned to end users within an organization, granting permissions to access APIs and features.
- **Machine-to-machine (M2M) role**: Assigned to M2M clients within an organization, granting permissions to access APIs and features, including Logto Management API.

Please note that these two types of roles cannot be mixed or updated after creation. Assign users or M2M clients to the role, depending on its type.

### Enforcing authorization in your backend or API

Logto issues [JSON Web Tokens (JWTs)](https://auth.wiki/jwt) that contain the necessary claims to enforce authorization in your application or API.

To enforce authorization, your backend or API should:

1. Require the client to present a valid access token in the request header with the `Authorization: Bearer <token>` format.
2. Validate the access token to ensure it is issued by Logto, not expired, and has the required permissions (scopes) for the requested action.
3. Respond with an error (e.g., HTTP 401 Unauthorized or HTTP 403 Forbidden) if the token is missing, invalid, or does not have the required permissions.

For step-by-step and language-specific guides, see [How to validate access tokens](/developers/validate-access-tokens).

### Integrate Logto with your application

To retrieve proper access tokens with the required permissions in your application, you can:

- Integrate one of the [Logto SDKs](/quick-starts) to handle authentication and authorization flows.
- Use one of the standard OAuth 2.0 or OpenID Connect (OIDC) libraries to implement flows accordingly.

---

For each of the above models, you can refer to the following pages for implementation details:

- [Protect global API resources](/authorization/protect-global-api-resources)
- [Protect organization (non-API) permissions](/authorization/protect-organization-non-api-permissions)
- [Protect organization-level API resources](/authorization/organization-level-api-resources)

## Advanced scenarios

Explore more sophisticated RBAC use cases in Logto:

- **Combining global and organization roles**: Assign both to users/clients when needed; Logto will resolve based on the requested token context.
- **Multiple apps**: Use shared resources and scopes for cross-application RBAC.
- **Dynamic permissions**: If needed, combine RBAC with runtime checks (e.g., ownership, attributes) for advanced scenarios.
- **Custom token claims**: Use [custom claims](/developers/custom-token-claims) to enrich tokens as needed.

## Best practices & common pitfalls

- **Principle of least privilege**: Grant only the permissions each role needs.
- **Avoid permission sprawl**: Keep your permission model simple and maintainable.
- **Review and update roles/permissions**: Regularly audit your RBAC model as your product evolves.
- **Separation of duties**: Create distinct roles for sensitive/admin actions.
- **Test RBAC in staging**: Validate permission boundaries and escalations.

## FAQ & troubleshooting

- **Q: How do I update roles or permissions across all organizations?**

  A: Update the [organization template](/authorization/organization-template) for global changes; existing organizations can inherit updates.

- **Q: Can I change roles/permissions dynamically?**

  A: Yes, roles and their permissions can be updated at any time.

- **Q: What happens if I remove a permission from a role?**

  A: Users/clients with that role will lose the permission immediately for new tokens.

- **Q: How can I audit who has what role?**

  A: Use the Logto Console or API to list role assignments.

- **Q: Can roles and permissions be assigned via API?**

  A: Yes, both the Console and Management API support managing roles and assignments programmatically.

## Further reading

- [Organization template](/authorization/organization-template)
- [Customizing token claims](/developers/custom-token-claims)
- [How to validate access tokens](/developers/validate-access-tokens)
- [Protect organization (non-API) permissions](/authorization/protect-organization-non-api-permissions)
- [Protect organization-level API resources](/authorization/organization-level-api-resources)
