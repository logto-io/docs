<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/recipes/impersonation/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">ğŸ­ User impersonation | Logto docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.logto.io/docs/recipes/impersonation/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ğŸ­ User impersonation | Logto docs"><meta data-rh="true" name="description" content="Imagine Sarah, a support engineer at TechCorp, receives a urgent ticket from Alex, a customer who can&#x27;t access a critical resource. To efficiently diagnose and resolve the issue, Sarah needs to see exactly what Alex sees in the system. This is where Logto&#x27;s user impersonation feature comes in handy."><meta data-rh="true" property="og:description" content="Imagine Sarah, a support engineer at TechCorp, receives a urgent ticket from Alex, a customer who can&#x27;t access a critical resource. To efficiently diagnose and resolve the issue, Sarah needs to see exactly what Alex sees in the system. This is where Logto&#x27;s user impersonation feature comes in handy."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.logto.io/docs/recipes/impersonation/"><link data-rh="true" rel="alternate" href="https://docs.logto.io/docs/recipes/impersonation/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.logto.io/docs/recipes/impersonation/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DE7QZWOVO6-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Logto docs Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Logto docs" href="/opensearch.xml">

<script src="https://plausible.io/js/script.js" defer="defer" data-domain="logto.io"></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script>
<meta name="google-site-verification" content="3EYzsnarDwG6zL2dlHvyC8ySVcV6Q3RGlvh7-bvhb2k">



























<link rel="alternate" type="application/rss+xml" href="/tutorial/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tutorial/atom.xml" title="Logto docs Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/terms/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/terms/atom.xml" title="Logto docs Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/about/rss.xml" title="Logto docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/about/atom.xml" title="Logto docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.4b1fbbc9.css">
<script src="/assets/js/runtime~main.bb502382.js" defer="defer"></script>
<script src="/assets/js/main.7ac6da4d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_TFXe" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://logto.io" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logto.svg" alt="Silverhand Logo" class="themedComponent_QAuF themedComponent--light_QiUO"><img src="/img/logto_dark.svg" alt="Silverhand Logo" class="themedComponent_QAuF themedComponent--dark__Ahn"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a href="https://blog.logto.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_t9AJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/quick-starts/">Quick starts</a><a class="navbar__item navbar__link" href="/integrations/">Integrations</a><a href="https://openapi.logto.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/logto-io/logto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_t9AJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_aqN_ colorModeToggle_HRAq"><button class="clean-btn toggleButton_CRFT toggleButtonDisabled_Ej68" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_hCK7"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_sDx9"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_lSs3"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_PADX"><div class="docsWrapper_Qy7c"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Whlm" type="button"></button><div class="docRoot_b5Qv"><aside class="theme-doc-sidebar-container docSidebarContainer_y1AD"><div class="sidebarViewport_M8SP"><div class="sidebar_Xk71"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_ZSFS"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">ğŸ’ Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/get-started/">âš¡ Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/get-started/welcome/">ğŸ‰ Welcome to Logto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-section"><a class="menu__link" href="/docs/recipes/impersonation/">Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts/sign-in-experience/">ğŸ¾ Sign-in experience</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts/authn-vs-authz/">ğŸ†š Authentication vs. authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-section"><a class="menu__link" href="/docs/recipes/impersonation/">Recipes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/integrate-logto/">ğŸ”— Integrate Logto in your application</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/protect-your-api/">âš”ï¸ Protect your API</a><button aria-label="Expand sidebar category &#x27;âš”ï¸ Protect your API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/customize-sie/">ğŸ¨ Customize sign-in experience</a><button aria-label="Expand sidebar category &#x27;ğŸ¨ Customize sign-in experience&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/multi-factor-auth/">ğŸ›¡ï¸ Multi-factor authentication</a><button aria-label="Expand sidebar category &#x27;ğŸ›¡ï¸ Multi-factor authentication&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/configure-connectors/">ğŸª› Configure connectors</a><button aria-label="Expand sidebar category &#x27;ğŸª› Configure connectors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/interact-with-management-api/">ğŸš Interact with Management API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/manage-users/">ğŸ§‘â€ğŸš€ Manage users</a><button aria-label="Expand sidebar category &#x27;ğŸ§‘â€ğŸš€ Manage users&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/organizations/">ğŸ¢ Organizations (Multi-tenancy)</a><button aria-label="Expand sidebar category &#x27;ğŸ¢ Organizations (Multi-tenancy)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/single-sign-on/">â˜ï¸ Enterprise SSO (SAML &amp; OIDC)</a><button aria-label="Expand sidebar category &#x27;â˜ï¸ Enterprise SSO (SAML &amp; OIDC)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/user-profile/">ğŸ‘¤ User profiles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/inspect-audit-logs/">ğŸ“œ Inspect audit logs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/logto-as-idp/">ğŸŒ Logto as an Identity Provider (IdP)</a><button aria-label="Expand sidebar category &#x27;ğŸŒ Logto as an Identity Provider (IdP)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/protected-app/">ğŸ” Protected App</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/webhooks/">ğŸª Webhooks</a><button aria-label="Expand sidebar category &#x27;ğŸª Webhooks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/rbac/">ğŸ” Role-based access control (RBAC)</a><button aria-label="Expand sidebar category &#x27;ğŸ” Role-based access control (RBAC)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/recipes/custom-domain/">ğŸŒ Custom domain</a><button aria-label="Expand sidebar category &#x27;ğŸŒ Custom domain&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/deployment/">ğŸš€ Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/configure-storage-providers/">ğŸ’¾ File storage provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/custom-jwt/">ğŸ« Custom JWT claims</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/enable-central-cache/">ğŸ—„ï¸ Enable central cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/recipes/migrations/">ğŸ”„ Migrate to Logto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/recipes/impersonation/">ğŸ­ User impersonation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-section"><a class="menu__link" href="/docs/recipes/impersonation/">References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/tenants/">ğŸ—‚ï¸ Tenants</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/openid-connect/">ğŸ“„ OpenID Connect</a><button aria-label="Expand sidebar category &#x27;ğŸ“„ OpenID Connect&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/using-cli/">ğŸ–¥ Using Logto CLI</a><button aria-label="Expand sidebar category &#x27;ğŸ–¥ Using Logto CLI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/applications/">ğŸ“± Applications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/connectors/">ğŸ”Œ Connectors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/references/core/">ğŸ§± Core Service</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/references/core/configuration/">Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/resources/">ğŸ“ API Resource</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/sdk-convention/">ğŸ“ƒ SDK convention</a><button aria-label="Expand sidebar category &#x27;ğŸ“ƒ SDK convention&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/references/users/">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Users</a><button aria-label="Expand sidebar category &#x27;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Users&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_RscU"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_TQDe"><div class="docItemContainer_RyjB"><article><div class="tocCollapsible_ao_3 theme-doc-toc-mobile tocMobile_xLUU"><button type="button" class="clean-btn tocCollapsibleButton_e4eD">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ğŸ­ User impersonation</h1>
<div class="availability_kRMk"><img alt="Cloud availability" src="https://img.shields.io/badge/Cloud-âœ“ available-4EA254"><img alt="OSS availability" src="https://img.shields.io/badge/OSS-since v1.19-4EA254"></div>
<p>Imagine Sarah, a support engineer at TechCorp, receives a urgent ticket from Alex, a customer who can&#x27;t access a critical resource. To efficiently diagnose and resolve the issue, Sarah needs to see exactly what Alex sees in the system. This is where Logto&#x27;s user impersonation feature comes in handy.</p>
<p>User impersonation allows authorized users like Sarah to temporarily act on behalf of other users like Alex within the system. This powerful feature is invaluable for troubleshooting, providing customer support, and performing administrative tasks.</p>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="how-it-works">How it works<a class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works" href="/docs/recipes/impersonation/#how-it-works">â€‹</a></h2>
<!-- -->
<p>The impersonation process involves three main steps:</p>
<ol>
<li>Sarah requests impersonation through TechCorp&#x27;s backend server</li>
<li>TechCorp&#x27;s server obtains a subject token from Logto&#x27;s Management API</li>
<li>Sarah&#x27;s application exchanges this subject token for an access token</li>
</ol>
<p>Let&#x27;s walk through how Sarah can use this feature to help Alex.</p>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="step-1-requesting-impersonation">Step 1: Requesting impersonation<a class="hash-link" aria-label="Direct link to Step 1: Requesting impersonation" title="Direct link to Step 1: Requesting impersonation" href="/docs/recipes/impersonation/#step-1-requesting-impersonation">â€‹</a></h2>
<p>First, Sarah&#x27;s support application needs to request impersonation from TechCorp&#x27;s backend server.</p>
<h3 class="anchor anchorWithStickyNavbar_TAJ7" id="request-sarahs-application-to-techcorps-server">Request (Sarah&#x27;s application to TechCorp&#x27;s server)<a class="hash-link" aria-label="Direct link to Request (Sarah&#x27;s application to TechCorp&#x27;s server)" title="Direct link to Request (Sarah&#x27;s application to TechCorp&#x27;s server)" href="/docs/recipes/impersonation/#request-sarahs-application-to-techcorps-server">â€‹</a></h3>
<div class="language-http codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-http codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token request-line method property" style="color:#36acaa">POST</span><span class="token request-line"> </span><span class="token request-line request-target url" style="color:#36acaa">/api/request-impersonation</span><span class="token request-line"> </span><span class="token request-line http-version property" style="color:#36acaa">HTTP/1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Host</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">api.techcorp.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Authorization</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">Bearer &lt;Sarah&#x27;s_access_token&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">  </span><span class="token application-json property" style="color:#36acaa">&quot;userId&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;alex123&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">  </span><span class="token application-json property" style="color:#36acaa">&quot;reason&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;Investigating resource access issue&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">  </span><span class="token application-json property" style="color:#36acaa">&quot;ticketId&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;TECH-1234&quot;</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this API, the backend should perform proper authorization checks to ensure Sarah has the necessary permissions to impersonate Alex.</p>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="step-2-obtaining-a-subject-token">Step 2: Obtaining a subject token<a class="hash-link" aria-label="Direct link to Step 2: Obtaining a subject token" title="Direct link to Step 2: Obtaining a subject token" href="/docs/recipes/impersonation/#step-2-obtaining-a-subject-token">â€‹</a></h2>
<p>TechCorp&#x27;s server, upon validating Sarah&#x27;s request, will then call Logto&#x27;s <a href="/docs/recipes/interact-with-management-api/">Management API</a> to obtain a subject token.</p>
<h3 class="anchor anchorWithStickyNavbar_TAJ7" id="request-techcorps-server-to-logtos-management-api">Request (TechCorp&#x27;s server to Logto&#x27;s Management API)<a class="hash-link" aria-label="Direct link to Request (TechCorp&#x27;s server to Logto&#x27;s Management API)" title="Direct link to Request (TechCorp&#x27;s server to Logto&#x27;s Management API)" href="/docs/recipes/impersonation/#request-techcorps-server-to-logtos-management-api">â€‹</a></h3>
<div class="language-http codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-http codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token request-line method property" style="color:#36acaa">POST</span><span class="token request-line"> </span><span class="token request-line request-target url" style="color:#36acaa">/api/subject-tokens</span><span class="token request-line"> </span><span class="token request-line http-version property" style="color:#36acaa">HTTP/1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Host</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">techcorp.logto.app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Authorization</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">Bearer &lt;TechCorp_m2m_access_token&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">  </span><span class="token application-json property" style="color:#36acaa">&quot;userId&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;alex123&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">  </span><span class="token application-json property" style="color:#36acaa">&quot;context&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json punctuation" style="color:#393A34">{</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;ticketId&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;TECH-1234&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;reason&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;Resource access issue&quot;</span><span class="token application-json punctuation" style="color:#393A34">,</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">    </span><span class="token application-json property" style="color:#36acaa">&quot;supportEngineerId&quot;</span><span class="token application-json operator" style="color:#393A34">:</span><span class="token application-json"> </span><span class="token application-json string" style="color:#e3116c">&quot;sarah789&quot;</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json">  </span><span class="token application-json punctuation" style="color:#393A34">}</span><span class="token application-json"></span><br></span><span class="token-line" style="color:#393A34"><span class="token application-json"></span><span class="token application-json punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_TAJ7" id="response-logto-to-techcorps-server">Response (Logto to TechCorp&#x27;s server)<a class="hash-link" aria-label="Direct link to Response (Logto to TechCorp&#x27;s server)" title="Direct link to Response (Logto to TechCorp&#x27;s server)" href="/docs/recipes/impersonation/#response-logto-to-techcorps-server">â€‹</a></h3>
<div class="language-json codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-json codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;subjectToken&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sub_7h32jf8sK3j2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expiresIn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>TechCorp&#x27;s server should then return this subject token to Sarah&#x27;s application.</p>
<h3 class="anchor anchorWithStickyNavbar_TAJ7" id="response-techcorps-server-to-sarahs-application">Response (TechCorp&#x27;s server to Sarah&#x27;s application)<a class="hash-link" aria-label="Direct link to Response (TechCorp&#x27;s server to Sarah&#x27;s application)" title="Direct link to Response (TechCorp&#x27;s server to Sarah&#x27;s application)" href="/docs/recipes/impersonation/#response-techcorps-server-to-sarahs-application">â€‹</a></h3>
<div class="language-json codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-json codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;subjectToken&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sub_7h32jf8sK3j2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expiresIn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="step-3-exchanging-the-subject-token-for-an-access-token">Step 3: Exchanging the subject token for an access token<a class="hash-link" aria-label="Direct link to Step 3: Exchanging the subject token for an access token" title="Direct link to Step 3: Exchanging the subject token for an access token" href="/docs/recipes/impersonation/#step-3-exchanging-the-subject-token-for-an-access-token">â€‹</a></h2>
<p>Now, Sarah&#x27;s application exchanges this subject token for an access token representing Alex, specifying the resource where the token will be used.</p>
<h3 class="anchor anchorWithStickyNavbar_TAJ7" id="request-sarahs-application-to-logtos-token-endpoint">Request (Sarah&#x27;s application to Logto&#x27;s token endpoint)<a class="hash-link" aria-label="Direct link to Request (Sarah&#x27;s application to Logto&#x27;s token endpoint)" title="Direct link to Request (Sarah&#x27;s application to Logto&#x27;s token endpoint)" href="/docs/recipes/impersonation/#request-sarahs-application-to-logtos-token-endpoint">â€‹</a></h3>
<div class="language-http codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-http codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token request-line method property" style="color:#36acaa">POST</span><span class="token request-line"> </span><span class="token request-line request-target url" style="color:#36acaa">/oidc/token</span><span class="token request-line"> </span><span class="token request-line http-version property" style="color:#36acaa">HTTP/1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Host</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">techcorp.logto.app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/x-www-form-urlencoded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;client_id=techcorp_support_app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=resource:read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;subject_token=alx_7h32jf8sK3j2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;subject_token_type=urn:ietf:params:oauth:token-type:access_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;resource=https://api.techcorp.com/customer-data</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_TAJ7" id="response-logto-to-sarahs-application">Response (Logto to Sarah&#x27;s application)<a class="hash-link" aria-label="Direct link to Response (Logto to Sarah&#x27;s application)" title="Direct link to Response (Logto to Sarah&#x27;s application)" href="/docs/recipes/impersonation/#response-logto-to-sarahs-application">â€‹</a></h3>
<div class="language-json codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-json codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eyJhbG...&lt;truncated&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;issued_token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;urn:ietf:params:oauth:token-type:access_token&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;scope&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;resource:read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>access_token</code> returned will be bound to the specified resource, ensuring it can only be used with TechCorp&#x27;s customer data API.</p>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="example-usage">Example usage<a class="hash-link" aria-label="Direct link to Example usage" title="Direct link to Example usage" href="/docs/recipes/impersonation/#example-usage">â€‹</a></h2>
<p>Here&#x27;s how Sarah might use this in a Node.js support application:</p>
<div class="language-typescript codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-typescript codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ImpersonationResponse</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subjectToken</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expiresIn</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">TokenExchangeResponse</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  access_token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  issued_token_type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  token_type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expires_in</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scope</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">impersonateUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  userId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  clientId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ticketId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resource</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Step 1 &amp; 2: Request impersonation and get subject token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> impersonationResponse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;https://api.techcorp.com/api/request-impersonation&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        headers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Authorization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer &lt;Sarah&#x27;s_access_token&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string-property property" style="color:#36acaa">&#x27;Content-Type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;application/json&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          userId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          reason</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Investigating resource access issue&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ticketId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">impersonationResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">HTTP error occurred. Status: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">impersonationResponse</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">status</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> subjectToken </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> impersonationResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> ImpersonationResponse</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Step 3: Exchange subject token for access token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> tokenExchangeBody </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">URLSearchParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      grant_type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;urn:ietf:params:oauth:grant-type:token-exchange&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      client_id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> clientId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      scope</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;openid profile resource.read&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      subject_token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> subjectToken</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      subject_token_type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;urn:ietf:params:oauth:token-type:access_token&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      resource</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> resource</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> tokenExchangeResponse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://techcorp.logto.app/oidc/token&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      headers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&#x27;Content-Type&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> tokenExchangeBody</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">tokenExchangeResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">HTTP error! status: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">tokenExchangeResponse</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">status</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> tokenData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> tokenExchangeResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> TokenExchangeResponse</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> tokenData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">access_token</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Impersonation failed:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Sarah uses this function to impersonate Alex</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">performImpersonation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">void</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> accessToken </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">impersonateUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;alex123&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;techcorp_support_app&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;TECH-1234&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;https://api.techcorp.com/customer-data&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Impersonation access token for Alex:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> accessToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Failed to perform impersonation:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Execute the impersonation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">performImpersonation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="important-notes">Important notes<a class="hash-link" aria-label="Direct link to Important notes" title="Direct link to Important notes" href="/docs/recipes/impersonation/#important-notes">â€‹</a></h2>
<ol>
<li>The subject token is single-use and short-lived.</li>
<li>The impersonation access token doesn&#x27;t come with a refresh token. Sarah will need to repeat this process if the token expires before she resolves Alex&#x27;s issue.</li>
<li>TechCorp&#x27;s backend server must implement proper authorization checks to ensure only authorized support staff like Sarah can request impersonation.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="act-claim"><code>act</code> claim<a class="hash-link" aria-label="Direct link to act-claim" title="Direct link to act-claim" href="/docs/recipes/impersonation/#act-claim">â€‹</a></h2>
<p>When using the token exchange flow for impersonation, the issued access token can include an additional <code>act</code> (actor) claim. This claim represents the identity of the acting party - in our example, Sarah, who is performing the impersonation.</p>
<p>To include the <code>act</code> claim, Sarah&#x27;s application needs to provide an <code>actor_token</code> in the token exchange request. This token should be a valid access token for Sarah with the <code>openid</code> scope. Here&#x27;s how to include it in the token exchange request:</p>
<div class="language-http codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-http codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token request-line method property" style="color:#36acaa">POST</span><span class="token request-line"> </span><span class="token request-line request-target url" style="color:#36acaa">/oidc/token</span><span class="token request-line"> </span><span class="token request-line http-version property" style="color:#36acaa">HTTP/1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Host</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">techcorp.logto.app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token header header-name keyword" style="color:#00009f">Content-Type</span><span class="token header punctuation" style="color:#393A34">:</span><span class="token header"> </span><span class="token header header-value">application/x-www-form-urlencoded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;client_id=techcorp_support_app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=resource:read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;subject_token=alx_7h32jf8sK3j2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;subject_token_type=urn:ietf:params:oauth:token-type:access_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;actor_token=sarah_access_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;actor_token_type=urn:ietf:params:oauth:token-type:access_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;resource=https://api.techcorp.com/customer-data</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If an <code>actor_token</code> is provided, the resulting access token will contain an <code>act</code> claim like this:</p>
<div class="language-json codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-json codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;aud&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://api.techcorp.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;iss&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://techcorp.logto.app&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;exp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1443904177</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;sub&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;alex123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;act&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;sub&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sarah789&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This <code>act</code> claim clearly indicates that Sarah (sarah789) is acting on behalf of Alex (alex123). The <code>act</code> claim can be useful for auditing and tracking impersonation actions.</p>
<h2 class="anchor anchorWithStickyNavbar_TAJ7" id="customizing-jwt-claims">Customizing JWT claims<a class="hash-link" aria-label="Direct link to Customizing JWT claims" title="Direct link to Customizing JWT claims" href="/docs/recipes/impersonation/#customizing-jwt-claims">â€‹</a></h2>
<p>Logto allows you to customize the JWT claims for impersonation tokens. This can be useful for adding additional context or metadata to the impersonation process, such as the reason for impersonation or the associated support ticket.</p>
<p>When TechCorp&#x27;s server requests a subject token from Logto&#x27;s Management API, it can include a <code>context</code> object:</p>
<div class="language-json codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-json codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;userId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;alex123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;context&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ticketId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TECH-1234&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;reason&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Resource access issue&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;supportEngineerId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sarah789&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This context can then be used in a <a href="/docs/recipes/custom-jwt/">custom JWT</a> claims function to add specific claims to the final access token. Here&#x27;s an example of how this might be implemented:</p>
<div class="language-typescript codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-typescript codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getCustomJwtClaims</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> environmentVariables </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grant</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">type </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;urn:ietf:params:oauth:grant-type:token-exchange&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> ticketId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reason</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> supportEngineerId </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subjectTokenContext</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      impersonation_context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ticket_id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ticketId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reason</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> reason</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        support_engineer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> supportEngineerId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The resulting access token that Sarah receives might look like this:</p>
<div class="language-jsonc codeBlockContainer_pKIO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_E7av"><pre tabindex="0" class="prism-code language-jsonc codeBlock_otO3 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_sik3"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;sub&quot;: &quot;alex123&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;aud&quot;: &quot;https://api.techcorp.com/customer-data&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;impersonation_context&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ticket_id&quot;: &quot;TECH-1234&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;reason&quot;: &quot;Resource access issue&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;support_engineer&quot;: &quot;sarah789&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ... other standard claims</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_uoN5"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_UFMY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_umBn"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_wn37"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By customizing the JWT in this way, TechCorp can include valuable information about the impersonation context, making it easier to audit and understand impersonation activities in their system.</p>
<p><strong>Note</strong>: Be cautious when adding custom claims to your tokens. Avoid including sensitive information that could pose security risks if the token is intercepted or leaked. The JWTs are signed but not encrypted, so the claims are visible to anyone with access to the token.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/logto-io/docs/tree/master/docs/docs/recipes/impersonation/README.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_EdxD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_CbxS"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/recipes/migrations/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ğŸ”„ Migrate to Logto</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/references/tenants/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ğŸ—‚ï¸ Tenants</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_EnDe thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#how-it-works">How it works</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#step-1-requesting-impersonation">Step 1: Requesting impersonation</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#request-sarahs-application-to-techcorps-server">Request (Sarah&#39;s application to TechCorp&#39;s server)</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#step-2-obtaining-a-subject-token">Step 2: Obtaining a subject token</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#request-techcorps-server-to-logtos-management-api">Request (TechCorp&#39;s server to Logto&#39;s Management API)</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#response-logto-to-techcorps-server">Response (Logto to TechCorp&#39;s server)</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#response-techcorps-server-to-sarahs-application">Response (TechCorp&#39;s server to Sarah&#39;s application)</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#step-3-exchanging-the-subject-token-for-an-access-token">Step 3: Exchanging the subject token for an access token</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#request-sarahs-application-to-logtos-token-endpoint">Request (Sarah&#39;s application to Logto&#39;s token endpoint)</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#response-logto-to-sarahs-application">Response (Logto to Sarah&#39;s application)</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#example-usage">Example usage</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#important-notes">Important notes</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#act-claim"><code>act</code> claim</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/recipes/impersonation/#customizing-jwt-claims">Customizing JWT claims</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_TCBS"><div class="container_oxh8"><div class="logoRow_e6WH"><img src="/img/silverhand.svg" alt="Logo"></div><div class="footerRow_MwlS"><div class="copyRight_Do1v">Copyright Â© 2024 Silverhand Inc. Built with Docusaurus.</div><div class="links_lMuC"><a class="footer__link-item" href="/">Docs</a><a href="https://github.com/logto-io/logto" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a><a href="https://logto.io/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Us</a><a href="mailto: contact@logto.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></div></div></div></footer></div>
</body>
</html>