---
sidebar_label: Android
sidebar_position: 10
---

import FurtherReadings from '../fragments/_further-readings.md';
import ScopesAndClaims from '../fragments/_scopes_and_claims.mdx';
import CheckIntegration from './_check_integration.md';
import HandleAuthenticationStatus from './_handle_authentication_status.md';
import ImplementSignIn from './_implement_sign_in.mdx';
import ImplementSignOut from './_implement_sign_out.md';
import InitLogtoClient from './_init_logto_client.md';
import Installation from './_installation.mdx';
import ScopesSampleCode from './_scopes_sample_code.md';

# Android SDK tutorial

This tutorial will show you how to integrate Logto into your Android application.

:::note

- The example is based on [View system](https://developer.android.com/reference/android/view/View) and [View Model](https://developer.android.com/topic/libraries/architecture/viewmodel), but the concepts are the same when using [Jetpack Compose](https://developer.android.com/jetpack/compose).
- The example is written in Kotlin, but the concepts are the same for Java.
- Both [Kotlin](https://github.com/logto-io/kotlin/tree/master/android-sample-kotlin) and [Java](https://github.com/logto-io/kotlin/tree/master/android-sample-java) sample projects are available on our [SDK repository](https://github.com/logto-io/kotlin).

:::

## Prerequisites

- A [Logto Cloud](https://cloud.logto.io) account or a self-hosted Logto. (Check out the [âš¡ Get started](https://docs.logto.io/docs/tutorials/get-started/) guide to create one if you don't have.)
- A Logto native application created.
- A Kotlin Android application project.

## Installation

<Installation />

## Integration

### Init LogtoClient

<InitLogtoClient />

### Implement sign-in

<ImplementSignIn />

### Implement sign-out

<ImplementSignOut />

### Handle authentication status

<HandleAuthenticationStatus />

### Checkpoint: Test your application

<CheckIntegration />

## Scopes and claims

<ScopesAndClaims fetchUserInfoApi="fetchUserInfo">
  <ScopesSampleCode />
</ScopesAndClaims>

## API resources

We recommend to read [ðŸ” Role-Based Access Control (RBAC)](https://docs.logto.io/docs/recipes/rbac/) first to understand the basic concepts of Logto RBAC and how to set up API resources properly.

### Configure Logto client

Once you have set up the API resources, you can add them when configuring the Logto client:

```kotlin
val logtoConfig = LogtoConfig(
    //...other configs
    resources = listOf("https://shopping.your-app.com/api", "https://store.your-app.com/api"), // Add API resources
)
```

Each API resource has its own permissions (scopes).

For example, the `https://shopping.your-app.com/api` resource has the `shopping:read` and `shopping:write` permissions, and the `https://store.your-app.com/api` resource has the `store:read` and `store:write` permissions.

To request these permissions, you can add them when configuring the Logto client:

```kotlin
val logtoConfig = LogtoConfig(
    // ..other configs
    scopes = listOf("shopping:read", "shopping:write", "store:read", "store:write"),
    resources = listOf("https://shopping.your-app.com/api", "https://store.your-app.com/api"),
)
```

You may notice that scopes are defined separately from API resources. This is because [Resource Indicators for OAuth 2.0](https://www.rfc-editor.org/rfc/rfc8707.html) specifies the final scopes for the request will be the cartesian product of all the scopes at all the target services.

Thus, in the above case, scopes can be simplified from the definition in Logto, both of the API resources can have `read` and `write` scopes without the prefix. Then, in the Logto config:

```kotlin
val logtoConfig = LogtoConfig(
    // ...other configs
    scopes = listOf("read", "write"),
    resources = listOf("https://shopping.your-app.com/api", "https://store.your-app.com/api"),
)
```

For every API resource, it will request for both `read` and `write` scopes.

:::note
It is fine to request scopes that are not defined in the API resources. For example, you can request the `email` scope even if the API resources don't have the `email` scope available. Unavailable scopes will be safely ignored.
:::

After the successful sign-in, Logto will issue proper scopes to every API resource according to the user's roles.

### Fetch access token for the API resource

To fetch the access token for a specific API resource, you can use the `getAccessToken` method:

```kotlin
logtoClient.getAccessToken("https://shopping.your-app.com/api") { logtoException, accessToken ->
    logtoException?.let { println(it) }
    accessToken?.let { println(it) }
}
```

This method will return a JWT access token that can be used to access the API resource when the user has related permissions. If the current cached access token has expired, this method will automatically try to use a refresh token to get a new access token.

### Fetch organization token for user

If organization is new to you, please read [ðŸ¢ Organizations (Multi-tenancy)](https://docs.logto.io/docs/recipes/organizations/) to get started.

You need to add `UserScope.ORGANIZATIONS` scope when configuring the Logto client:

```kotlin
val logtoConfig = LogtoConfig(
    // ...other configs
    scopes = listOf(UserScope.ORGANIZATIONS),
)
```

Once the user is signed in, you can fetch the organization token for the user:

```kotlin
// Replace the parameter with a valid organization ID.
// Valid organization IDs for the user can be found in the ID token claim `organizations`.
logtoClient.getOrganizationToken("organization-id") { logtoException, organizationToken ->
    logtoException?.let { println(it) }
    organizationToken?.let { println(it) }
}

// or
logtoClient.getOrganizationTokenClaims("organization-id") { logtoException, claims ->
    logtoException?.let { println(it) }
    claims?.let { println(it) }
}
```

## Further readings

<FurtherReadings />
