"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[30204],{68445:(e,o,s)=>{s.d(o,{Ay:()=>d,RM:()=>r});var i=s(86070),a=s(15658);const r=[];function n(e){const{Url:o}={...(0,a.R)(),...e.components};return o||function(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Url",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o,{href:"/end-user-flows",children:" Fluxos do usu\xe1rio final: fluxos de autentica\xe7\xe3o, fluxos de conta e fluxos de organiza\xe7\xe3o "}),"\n",(0,i.jsx)(o,{href:"/connectors",children:" Configurar conectores "}),"\n",(0,i.jsx)(o,{href:"/authorization/api-resources/protect-your-api",children:" Proteger sua API "})]})}function d(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(n,{...e})}):n(e)}},55254:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"quick-starts/framework/wordpress/README","title":"Adicionar autentica\xe7\xe3o ao seu aplicativo WordPress","description":"Este tutorial mostrar\xe1 como integrar o Logto ao seu site Wordpress.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/quick-starts/framework/wordpress/README.mdx","sourceDirName":"quick-starts/framework/wordpress","slug":"/quick-starts/wordpress","permalink":"/pt-BR/quick-starts/wordpress","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/quick-starts/framework/wordpress/README.mdx","tags":[],"version":"current","frontMatter":{"slug":"/quick-starts/wordpress","sidebar_label":"WordPress","sidebar_custom_props":{"description":"WordPress \xe9 um sistema de gerenciamento de conte\xfado gratuito e de c\xf3digo aberto."}},"sidebar":"quickStartSidebar","previous":{"title":"Webflow","permalink":"/pt-BR/quick-starts/webflow"},"next":{"title":"M\xe1quina para m\xe1quina","permalink":"/pt-BR/quick-starts/m2m"}}');var a=s(86070),r=s(15658),n=s(68445);const d={slug:"/quick-starts/wordpress",sidebar_label:"WordPress",sidebar_custom_props:{description:"WordPress \xe9 um sistema de gerenciamento de conte\xfado gratuito e de c\xf3digo aberto."}},t="Adicionar autentica\xe7\xe3o ao seu aplicativo WordPress",c={},l=[{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos",level:2},{value:"Integra\xe7\xe3o",id:"integra\xe7\xe3o",level:2},{value:"Instalar o plugin",id:"instalar-o-plugin",level:3},{value:"Configurar o URI de redirecionamento",id:"configurar-o-uri-de-redirecionamento",level:3},{value:"Configurar o plugin",id:"configurar-o-plugin",level:3},{value:"Ponto de verifica\xe7\xe3o: Teste seu aplicativo",id:"ponto-de-verifica\xe7\xe3o-teste-seu-aplicativo",level:3},{value:"Mapeamento de pap\xe9is",id:"mapeamento-de-pap\xe9is",level:2},{value:"Pr\xe9-requisitos",id:"pr\xe9-requisitos-1",level:3},{value:"Implementar mapeamento de pap\xe9is",id:"implementar-mapeamento-de-pap\xe9is",level:3},{value:"Passo 1: acesse o functions.php do seu tema",id:"passo-1-acesse-o-functionsphp-do-seu-tema",level:3},{value:"Passo 2: escreva a fun\xe7\xe3o de mapeamento de pap\xe9is",id:"passo-2-escreva-a-fun\xe7\xe3o-de-mapeamento-de-pap\xe9is",level:3},{value:"Passo 3: entendendo o c\xf3digo e personalizando-o",id:"passo-3-entendendo-o-c\xf3digo-e-personalizando-o",level:3},{value:"Passo 4: teste sua configura\xe7\xe3o",id:"passo-4-teste-sua-configura\xe7\xe3o",level:3},{value:"Leituras adicionais",id:"leituras-adicionais",level:2},...n.RM];function p(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.header,{children:(0,a.jsx)(o.h1,{id:"adicionar-autentica\xe7\xe3o-ao-seu-aplicativo-wordpress",children:"Adicionar autentica\xe7\xe3o ao seu aplicativo WordPress"})}),"\n",(0,a.jsxs)(o.p,{children:["Este tutorial mostrar\xe1 como integrar o Logto ao seu site ",(0,a.jsx)(o.a,{href:"https://wordpress.org",children:"Wordpress"}),"."]}),"\n",(0,a.jsx)(o.h2,{id:"pr\xe9-requisitos",children:"Pr\xe9-requisitos"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["Uma conta no ",(0,a.jsx)(o.a,{href:"https://cloud.logto.io",children:"Logto Cloud"})," ou um ",(0,a.jsx)(o.a,{href:"/introduction/set-up-logto-oss",children:"Logto auto-hospedado"}),"."]}),"\n",(0,a.jsx)(o.li,{children:"Um aplicativo tradicional Logto criado."}),"\n",(0,a.jsxs)(o.li,{children:["Um projeto WordPress: siga o guia oficial de ",(0,a.jsx)(o.a,{href:"https://wordpress.org/support/article/how-to-install-wordpress/",children:"instala\xe7\xe3o do WordPress"})," para configurar seu site WordPress antes de prosseguir."]}),"\n"]}),"\n",(0,a.jsx)(o.h2,{id:"integra\xe7\xe3o",children:"Integra\xe7\xe3o"}),"\n",(0,a.jsx)(o.h3,{id:"instalar-o-plugin",children:"Instalar o plugin"}),"\n",(0,a.jsxs)(o.p,{children:["Usaremos o plugin ",(0,a.jsx)(o.a,{href:"https://wordpress.org/plugins/generic-openid-connect/",children:"OpenID Connect Generic"})," para integrar o Logto via protocolo OIDC ao seu site WordPress."]}),"\n",(0,a.jsxs)(o.ol,{children:["\n",(0,a.jsx)(o.li,{children:"Fa\xe7a login no seu site WordPress."}),"\n",(0,a.jsx)(o.li,{children:'Navegue at\xe9 "Plugins" e clique em "Adicionar Novo".'}),"\n",(0,a.jsx)(o.li,{children:'Procure por "OpenID Connect Generic" e instale o plugin de daggerhart.'}),"\n",(0,a.jsx)(o.li,{children:"Ative o plugin."}),"\n"]}),"\n",(0,a.jsx)(o.h3,{id:"configurar-o-uri-de-redirecionamento",children:"Configurar o URI de redirecionamento"}),"\n",(0,a.jsx)(o.p,{children:'Primeiro, vamos configurar o URI de redirecionamento. Voc\xea pode encontr\xe1-lo nas configura\xe7\xf5es do plugin, role para baixo at\xe9 a se\xe7\xe3o "Notas" e copie o valor "Redirect URI".'}),"\n",(0,a.jsx)(o.p,{children:'Mude para a p\xe1gina de detalhes do aplicativo no Logto Console. Adicione um Redirect URI e clique em "Salvar altera\xe7\xf5es".'}),"\n",(0,a.jsx)(o.h3,{id:"configurar-o-plugin",children:"Configurar o plugin"}),"\n",(0,a.jsx)(o.p,{children:"Consulte a tabela a seguir para os detalhes de configura\xe7\xe3o necess\xe1rios:"}),"\n",(0,a.jsxs)(o.table,{children:[(0,a.jsx)(o.thead,{children:(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.th,{children:"Campo do Plugin"}),(0,a.jsx)(o.th,{children:"Descri\xe7\xe3o"})]})}),(0,a.jsxs)(o.tbody,{children:[(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Client ID"}),(0,a.jsx)(o.td,{children:"O ID do aplicativo do seu aplicativo Logto"})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Client Secret"}),(0,a.jsx)(o.td,{children:"O segredo do aplicativo do seu aplicativo Logto"})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"OpenID Scope"}),(0,a.jsxs)(o.td,{children:["Insira ",(0,a.jsx)(o.code,{children:"email profile openid offline_access"})]})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Login Endpoint URL"}),(0,a.jsx)(o.td,{children:'A URL do endpoint de autoriza\xe7\xe3o do seu aplicativo Logto, que \xe9 https://[tenant-id].logto.app/oidc/auth, voc\xea pode clicar em "mostrar detalhes do endpoint" na p\xe1gina do aplicativo Logto para obter a URL.'})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Userinfo Endpoint URL"}),(0,a.jsx)(o.td,{children:"A URL do endpoint de informa\xe7\xf5es do usu\xe1rio do seu aplicativo Logto, que \xe9 https://[tenant-id].logto.app/oidc/me."})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Token Validation Endpoint URL"}),(0,a.jsx)(o.td,{children:"A URL do endpoint de valida\xe7\xe3o de token do seu aplicativo Logto, que \xe9 https://[tenant-id].logto.app/oidc/token."})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"End Session Endpoint URL"}),(0,a.jsx)(o.td,{children:"A URL do endpoint de encerramento de sess\xe3o do seu aplicativo Logto, que \xe9 https://[tenant-id].logto.app/oidc/session/end."})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Identity Key"}),(0,a.jsx)(o.td,{children:"A chave \xfanica no Token de ID que cont\xe9m a identidade do usu\xe1rio, pode ser email ou sub, dependendo da sua configura\xe7\xe3o."})]}),(0,a.jsxs)(o.tr,{children:[(0,a.jsx)(o.td,{children:"Nickname Key"}),(0,a.jsx)(o.td,{children:"A chave no Token de ID que cont\xe9m o apelido do usu\xe1rio, voc\xea pode defini-la como sub e alter\xe1-la posteriormente."})]})]})]}),"\n",(0,a.jsx)(o.h3,{id:"ponto-de-verifica\xe7\xe3o-teste-seu-aplicativo",children:"Ponto de verifica\xe7\xe3o: Teste seu aplicativo"}),"\n",(0,a.jsx)(o.p,{children:"Agora, voc\xea pode testar seu aplicativo:"}),"\n",(0,a.jsxs)(o.ol,{children:["\n",(0,a.jsx)(o.li,{children:"Saia do seu site WordPress."}),"\n",(0,a.jsx)(o.li,{children:'Visite a p\xe1gina de login do WordPress e clique no bot\xe3o "Sign in with Logto".'}),"\n",(0,a.jsx)(o.li,{children:"Voc\xea ser\xe1 redirecionado para a p\xe1gina de login do Logto."}),"\n",(0,a.jsx)(o.li,{children:"Fa\xe7a login com sua conta Logto."}),"\n",(0,a.jsx)(o.li,{children:"Voc\xea ser\xe1 redirecionado de volta para o site WordPress e logado automaticamente."}),"\n"]}),"\n",(0,a.jsx)(o.h2,{id:"mapeamento-de-pap\xe9is",children:"Mapeamento de pap\xe9is"}),"\n",(0,a.jsx)(o.p,{children:"O WordPress possui um sistema de gerenciamento de pap\xe9is de usu\xe1rio embutido que define quais a\xe7\xf5es (capacidades) um usu\xe1rio pode realizar em um site. Os pap\xe9is de usu\xe1rio padr\xe3o incluem Administrador, Editor, Autor, Colaborador e Assinante, cada um com seu pr\xf3prio conjunto de capacidades."}),"\n",(0,a.jsx)(o.p,{children:'O Logto emprega o Controle de Acesso Baseado em Papel (RBAC) como seu modelo de autoriza\xe7\xe3o, utilizando "escopos" como a menor unidade de permiss\xe3o. Esses escopos definem as a\xe7\xf5es espec\xedficas que um usu\xe1rio autenticado pode realizar dentro de um aplicativo. No entanto, o WordPress opera em um princ\xedpio diferente para gerenciar permiss\xf5es de usu\xe1rio, confiando em "pap\xe9is" predefinidos que agrupam v\xe1rias capacidades juntas.'}),"\n",(0,a.jsx)(o.p,{children:"Dada essa diferen\xe7a fundamental, sugerimos criar pap\xe9is especiais dentro do Logto que correspondam aos pap\xe9is definidos no WordPress. Esses pap\xe9is podem n\xe3o ter nenhum escopo, eles s\xe3o usados apenas como refer\xeancia para mapear usu\xe1rios para pap\xe9is do WordPress."}),"\n",(0,a.jsx)(o.h3,{id:"pr\xe9-requisitos-1",children:"Pr\xe9-requisitos"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["Configure pap\xe9is no Logto que correspondam aos pap\xe9is no WordPress. Por exemplo, se voc\xea tiver um papel 'editor' no WordPress, crie um papel 'group",":editors","' no Logto."]}),"\n"]}),"\n",(0,a.jsx)(o.h3,{id:"implementar-mapeamento-de-pap\xe9is",children:"Implementar mapeamento de pap\xe9is"}),"\n",(0,a.jsxs)(o.p,{children:["Para implementar o mapeamento de pap\xe9is, adicionaremos c\xf3digo personalizado ao arquivo ",(0,a.jsx)(o.code,{children:"functions.php"})," do tema do WordPress. Isso envolve o uso do gancho de a\xe7\xe3o ",(0,a.jsx)(o.code,{children:"wp_login"}),", que \xe9 acionado quando um usu\xe1rio faz login. Aqui est\xe1 um guia passo a passo sobre como configurar isso:"]}),"\n",(0,a.jsx)(o.h3,{id:"passo-1-acesse-o-functionsphp-do-seu-tema",children:"Passo 1: acesse o functions.php do seu tema"}),"\n",(0,a.jsxs)(o.p,{children:["Abra o arquivo ",(0,a.jsx)(o.code,{children:"functions.php"})," do seu tema. Voc\xea pode acessar este arquivo atrav\xe9s do painel de administra\xe7\xe3o do WordPress navegando at\xe9 Apar\xeancia > Editor de Tema e selecionando ",(0,a.jsx)(o.code,{children:"functions.php"})," na lista de arquivos \xe0 direita. Ou no c\xf3digo-fonte, navegue at\xe9 o diret\xf3rio do tema do WordPress e localize o arquivo ",(0,a.jsx)(o.code,{children:"functions.php"}),". Este arquivo permite que voc\xea adicione fun\xe7\xf5es PHP personalizadas que estendem a funcionalidade do seu site WordPress."]}),"\n",(0,a.jsx)(o.h3,{id:"passo-2-escreva-a-fun\xe7\xe3o-de-mapeamento-de-pap\xe9is",children:"Passo 2: escreva a fun\xe7\xe3o de mapeamento de pap\xe9is"}),"\n",(0,a.jsxs)(o.p,{children:["Abaixo est\xe1 um exemplo simples de uma fun\xe7\xe3o que voc\xea pode adicionar ao functions.php. Esta fun\xe7\xe3o ser\xe1 acionada no login do usu\xe1rio e atribuir\xe1 pap\xe9is com base na reivindica\xe7\xe3o ",(0,a.jsx)(o.code,{children:"roles"})," do usu\xe1rio obtida do Logto."]}),"\n",(0,a.jsx)(o.pre,{children:(0,a.jsx)(o.code,{className:"language-php",children:"function logto_handler($user_login, $user = null) {\n\tif (!$user) {\n\t\t$user = get_user_by('login', $user_login);\n\t}\n\n\t$oidc_claims = get_user_meta($user->ID, 'openid-connect-generic-last-user-claim', true);\n\n\tif (in_array('group:editors', $oidc_claims['roles'])) {\n\t\t$user->set_role('editor');\n\t} else {\n\t\t$user->set_role('subscriber');\n\t}\n}\n\nadd_action('wp_login', 'logto_handler', 10, 2);\n"})}),"\n",(0,a.jsx)(o.h3,{id:"passo-3-entendendo-o-c\xf3digo-e-personalizando-o",children:"Passo 3: entendendo o c\xf3digo e personalizando-o"}),"\n",(0,a.jsxs)(o.ul,{children:["\n",(0,a.jsxs)(o.li,{children:["\n",(0,a.jsxs)(o.p,{children:["Fun\xe7\xe3o ",(0,a.jsx)(o.code,{children:"logto_handler"}),": Esta fun\xe7\xe3o recebe dois par\xe2metros: ",(0,a.jsx)(o.code,{children:"$user_login"})," (nome de usu\xe1rio) e ",(0,a.jsx)(o.code,{children:"$user"})," (objeto usu\xe1rio). Ela recupera pap\xe9is do Logto que est\xe3o armazenados como ",(0,a.jsx)(o.code,{children:"openid-connect-generic-last-user-claim"})," nos metadados do usu\xe1rio, mapeia esse papel para um papel correspondente do WordPress e o atribui ao usu\xe1rio."]}),"\n"]}),"\n",(0,a.jsxs)(o.li,{children:["\n",(0,a.jsxs)(o.p,{children:[(0,a.jsx)(o.code,{children:"add_action"}),": Esta linha conecta a fun\xe7\xe3o ",(0,a.jsx)(o.code,{children:"logto_handler"})," \xe0 a\xe7\xe3o ",(0,a.jsx)(o.code,{children:"wp_login"}),", que \xe9 acionada ap\xf3s um usu\xe1rio fazer login. O ",(0,a.jsx)(o.code,{children:"10"})," \xe9 a prioridade (padr\xe3o), e ",(0,a.jsx)(o.code,{children:"2"})," indica o n\xfamero de argumentos que a fun\xe7\xe3o aceita."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(o.p,{children:["O exemplo acima atribui o papel 'editor' aos usu\xe1rios autenticados via Logto com o nome de papel ",(0,a.jsx)(o.code,{children:"group:editors"}),". No entanto, em um cen\xe1rio real, voc\xea provavelmente precisar\xe1 implementar mais tipos de mapeamentos de pap\xe9is."]}),"\n",(0,a.jsxs)(o.p,{children:["Voc\xea pode encontrar a lista de pap\xe9is do WordPress e suas capacidades ",(0,a.jsx)(o.a,{href:"https://wordpress.org/support/article/roles-and-capabilities/",children:"aqui"}),"."]}),"\n",(0,a.jsx)(o.h3,{id:"passo-4-teste-sua-configura\xe7\xe3o",children:"Passo 4: teste sua configura\xe7\xe3o"}),"\n",(0,a.jsxs)(o.p,{children:["Agora, vamos testar a fun\xe7\xe3o de mapeamento de pap\xe9is fazendo login com um usu\xe1rio que tenha o papel ",(0,a.jsx)(o.code,{children:"group:editors"})," no Logto. Ap\xf3s o login, verifique o papel do usu\xe1rio no WordPress para garantir que o mapeamento esteja funcionando corretamente."]}),"\n",(0,a.jsx)(o.h2,{id:"leituras-adicionais",children:"Leituras adicionais"}),"\n",(0,a.jsx)(n.Ay,{})]})}function u(e={}){const{wrapper:o}={...(0,r.R)(),...e.components};return o?(0,a.jsx)(o,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},15658:(e,o,s)=>{s.d(o,{R:()=>n,x:()=>d});var i=s(30758);const a={},r=i.createContext(a);function n(e){const o=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function d(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:n(e.components),i.createElement(r.Provider,{value:o},e.children)}}}]);