"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[17527],{93341:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>d,contentTitle:()=>t,default:()=>l,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"developers/signing-keys","title":"Chaves de assinatura","description":"As chaves de assinatura OIDC do Logto, tamb\xe9m conhecidas como \\"chaves privadas OIDC\\" e \\"chaves de cookie OIDC\\", s\xe3o as chaves de assinatura usadas para assinar tokens JWT (tokens de acesso e tokens de ID) e cookies de navegador nas sess\xf5es de login do Logto. Essas chaves de assinatura s\xe3o geradas ao semear o banco de dados do Logto (open-source) ou ao criar um novo locat\xe1rio (Cloud) e podem ser gerenciadas atrav\xe9s do CLI (open-source), Management APIs ou Console UI.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/developers/signing-keys.mdx","sourceDirName":"developers","slug":"/developers/signing-keys","permalink":"/pt-BR/developers/signing-keys","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/developers/signing-keys.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"signing-keys","title":"Chaves de assinatura","sidebar_label":"Chaves de assinatura","sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Imita\xe7\xe3o de usu\xe1rio","permalink":"/pt-BR/developers/user-impersonation"},"next":{"title":"Webhooks","permalink":"/pt-BR/developers/webhooks/"}}');var i=o(86070),n=o(15658);const r={id:"signing-keys",title:"Chaves de assinatura",sidebar_label:"Chaves de assinatura",sidebar_position:4},t="Chaves de assinatura",d={},c=[{value:"Como funciona?",id:"como-funciona",level:2},{value:"Rotacionar chaves de assinatura a partir do Console UI",id:"rotacionar-chaves-de-assinatura-a-partir-do-console-ui",level:2}];function u(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components},{CloudLink:o}=a;return o||function(e,a){throw new Error("Expected "+(a?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CloudLink",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"chaves-de-assinatura",children:"Chaves de assinatura"})}),"\n",(0,i.jsxs)(a.p,{children:["As ",(0,i.jsx)(a.a,{href:"https://auth.wiki/signing-key",children:"chaves de assinatura OIDC"}),' do Logto, tamb\xe9m conhecidas como "chaves privadas OIDC" e "chaves de cookie OIDC", s\xe3o as chaves de assinatura usadas para assinar tokens JWT (',(0,i.jsx)(a.a,{href:"https://auth.wiki/access-token",children:"tokens de acesso"})," e ",(0,i.jsx)(a.a,{href:"https://auth.wiki/id-token",children:"tokens de ID"}),") e cookies de navegador nas ",(0,i.jsx)(a.a,{href:"/end-user-flows/sign-out#sign-in-session",children:"sess\xf5es de login"})," do Logto. Essas chaves de assinatura s\xe3o geradas ao semear o banco de dados do Logto (",(0,i.jsx)(a.a,{href:"/logto-oss",children:"open-source"}),") ou ao criar um novo locat\xe1rio (",(0,i.jsx)(a.a,{href:"/logto-cloud",children:"Cloud"}),") e podem ser gerenciadas atrav\xe9s do ",(0,i.jsx)(a.a,{href:"/logto-oss/using-cli",children:"CLI"})," (open-source), Management APIs ou Console UI."]}),"\n",(0,i.jsx)(a.p,{children:"Por padr\xe3o, o Logto usa o algoritmo de curva el\xedptica (EC) para gerar assinaturas digitais. No entanto, considerando que os usu\xe1rios frequentemente precisam verificar assinaturas JWT e muitas ferramentas antigas n\xe3o suportam o algoritmo EC (apenas suportando RSA), implementamos a funcionalidade para rotacionar chaves privadas e permitir que os usu\xe1rios escolham o algoritmo de assinatura (incluindo tanto RSA quanto EC). Isso garante compatibilidade com servi\xe7os que usam ferramentas de verifica\xe7\xe3o de assinatura desatualizadas."}),"\n",(0,i.jsx)(a.admonition,{type:"note",children:(0,i.jsx)(a.p,{children:"Teoricamente, as chaves de assinatura n\xe3o devem ser vazadas e n\xe3o t\xeam um tempo de expira\xe7\xe3o, o que significa que n\xe3o h\xe1 necessidade de rotacion\xe1-las. No entanto, rotacionar periodicamente a chave de assinatura ap\xf3s um certo per\xedodo pode aumentar a seguran\xe7a."})}),"\n",(0,i.jsx)(a.h2,{id:"como-funciona",children:"Como funciona?"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Chave privada OIDC"}),"\nAo inicializar uma inst\xe2ncia do Logto, um par de chave p\xfablica e chave privada \xe9 gerado automaticamente e registrado no provedor OIDC subjacente. Assim, quando o Logto emite um novo token JWT (token de acesso ou token de ID), o token \xe9 assinado com a chave privada. Ao mesmo tempo, qualquer aplicativo cliente que receba um token JWT pode usar a chave p\xfablica emparelhada para verificar a assinatura do token, a fim de garantir que o token n\xe3o foi adulterado por terceiros. A chave privada \xe9 protegida no servidor Logto. A chave p\xfablica, no entanto, como o nome sugere, \xe9 p\xfablica para todos e pode ser acessada atrav\xe9s da interface ",(0,i.jsx)(a.code,{children:"/oidc/jwks"})," do endpoint OIDC. Um algoritmo de chave de assinatura pode ser especificado ao gerar a chave privada, e o Logto usa o algoritmo EC (Curva El\xedptica) por padr\xe3o. Os usu\xe1rios administradores podem mudar o algoritmo padr\xe3o para RSA (Rivest-Shamir-Adleman) rotacionando as chaves privadas."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Chave de cookie OIDC"}),'\nQuando o usu\xe1rio inicia um fluxo de login ou cadastro, uma "sess\xe3o OIDC" ser\xe1 criada no servidor, assim como um conjunto de cookies de navegador. Com esses cookies, o navegador pode solicitar \xe0 Logto Experience API para realizar uma s\xe9rie de intera\xe7\xf5es em nome do usu\xe1rio, como login, cadastro e redefini\xe7\xe3o de senha. No entanto, ao contr\xe1rio dos tokens JWT, os cookies s\xe3o apenas assinados e verificados pelo pr\xf3prio servi\xe7o OIDC do Logto, medidas de criptografia assim\xe9trica n\xe3o s\xe3o necess\xe1rias. Assim, n\xe3o temos chaves p\xfablicas emparelhadas para chaves de assinatura de cookies, nem algoritmos de criptografia assim\xe9trica.']}),"\n"]}),"\n",(0,i.jsx)(a.h2,{id:"rotacionar-chaves-de-assinatura-a-partir-do-console-ui",children:"Rotacionar chaves de assinatura a partir do Console UI"}),"\n",(0,i.jsx)(a.p,{children:'O Logto introduz um recurso de "Rota\xe7\xe3o de Chaves de Assinatura", que permite criar uma nova chave privada OIDC e chave de cookie em seu locat\xe1rio.'}),"\n",(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:["Navegue at\xe9 ",(0,i.jsx)(o,{to:"/signing-keys",children:"Console > Chaves de assinatura"}),". A partir da\xed, voc\xea pode gerenciar tanto as chaves privadas OIDC quanto as chaves de cookie OIDC."]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:'Para rotacionar a chave de assinatura, clique no bot\xe3o "Rotacionar chaves privadas" ou "Rotacionar chaves de cookie". Ao rotacionar chaves privadas, voc\xea tem a op\xe7\xe3o de mudar o algoritmo de assinatura.'}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:"E voc\xea encontrar\xe1 uma tabela que lista todas as chaves de assinatura em uso. Nota: Voc\xea pode excluir a chave anterior, mas n\xe3o pode excluir a atual."}),"\n",(0,i.jsxs)(a.table,{children:[(0,i.jsx)(a.thead,{children:(0,i.jsxs)(a.tr,{children:[(0,i.jsx)(a.th,{children:"Status"}),(0,i.jsx)(a.th,{children:"Descri\xe7\xe3o"})]})}),(0,i.jsxs)(a.tbody,{children:[(0,i.jsxs)(a.tr,{children:[(0,i.jsx)(a.td,{children:"Atual"}),(0,i.jsx)(a.td,{children:"Isso indica que esta chave est\xe1 atualmente em uso ativo em seus aplicativos e APIs."})]}),(0,i.jsxs)(a.tr,{children:[(0,i.jsx)(a.td,{children:"Anterior"}),(0,i.jsx)(a.td,{children:"Refere-se a uma chave que foi usada anteriormente, mas foi rotacionada. Tokens existentes com esta chave de assinatura permanecem v\xe1lidos."})]})]})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:"Lembre-se de que a rota\xe7\xe3o envolve as seguintes tr\xeas a\xe7\xf5es:"}),"\n",(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Criar uma nova chave de assinatura"}),": Isso exigir\xe1 que todos os seus ",(0,i.jsx)(a.strong,{children:"aplicativos"})," e ",(0,i.jsx)(a.strong,{children:"APIs"})," adotem a nova chave de assinatura."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Rotacionar a chave atual"}),': A chave existente ser\xe1 designada como "anterior" ap\xf3s a rota\xe7\xe3o e n\xe3o ser\xe1 utilizada por novos aplicativos e APIs criados. No entanto, tokens assinados com esta chave ainda permanecer\xe3o v\xe1lidos.']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Remover sua chave anterior"}),': Chaves rotuladas como "anterior" ser\xe3o revogadas e removidas da tabela.']}),"\n"]}),"\n",(0,i.jsxs)(a.admonition,{type:"warning",children:[(0,i.jsx)(a.p,{children:"Nunca rotacione chaves de assinatura consecutivamente (duas ou mais vezes), pois isso pode invalidar TODOS os tokens emitidos."}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"Para usu\xe1rios OSS, ap\xf3s rotacionar a chave de assinatura, \xe9 necess\xe1rio reiniciar a inst\xe2ncia do Logto para que a nova chave de assinatura entre em vigor."}),"\n",(0,i.jsx)(a.li,{children:"Para usu\xe1rios Cloud, a nova chave de assinatura entra em vigor imediatamente ap\xf3s a rota\xe7\xe3o, mas certifique-se de n\xe3o rotacionar a chave de assinatura v\xe1rias vezes consecutivamente."}),"\n"]})]})]})}function l(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},15658:(e,a,o)=>{o.d(a,{R:()=>r,x:()=>t});var s=o(30758);const i={},n=s.createContext(i);function r(e){const a=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(n.Provider,{value:a},e.children)}}}]);