"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[35003],{50261:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>a,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"concepts/opaque-token","title":"Token opaco","description":"Durante o processo de autentica\xe7\xe3o, se nenhum recurso for especificado, o Logto emitir\xe1 um token de acesso opaco em vez de um JWT. O token opaco \xe9 uma string aleat\xf3ria e \xe9 muito mais curto que um JWT:","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/concepts/opaque-token.mdx","sourceDirName":"concepts","slug":"/concepts/opaque-token","permalink":"/pt-BR/concepts/opaque-token","draft":false,"unlisted":false,"editUrl":"https://github.com/logto-io/docs/tree/master/i18n/pt-BR/docusaurus-plugin-content-docs/current/concepts/opaque-token.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"docsSidebar","previous":{"title":"Configura\xe7\xe3o","permalink":"/pt-BR/concepts/core-service/configuration"},"next":{"title":"Conceitos","permalink":"/pt-BR/concepts/"}}');var s=n(86070),c=n(15658);const i={sidebar_position:6},r="Token opaco",a={},d=[];function l(e){const o={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.header,{children:(0,s.jsx)(o.h1,{id:"token-opaco",children:"Token opaco"})}),"\n",(0,s.jsx)(o.p,{children:"Durante o processo de autentica\xe7\xe3o, se nenhum recurso for especificado, o Logto emitir\xe1 um token de acesso opaco em vez de um JWT. O token opaco \xe9 uma string aleat\xf3ria e \xe9 muito mais curto que um JWT:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-json",children:'{\n  "access_token": "some-random-string", // token opaco\n  "expires_in": 3600,\n  "id_token": "eyJhbGc...aBc", // JWT\n  "scope": "openid profile email",\n  "token_type": "Bearer"\n}\n'})}),"\n",(0,s.jsxs)(o.p,{children:["O token opaco pode ser usado para chamar o ",(0,s.jsx)(o.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#UserInfo",children:"endpoint userinfo"})," e acessar recursos protegidos que requerem autentica\xe7\xe3o. Como n\xe3o \xe9 um JWT, como o servidor de recursos pode valid\xe1-lo?"]}),"\n",(0,s.jsxs)(o.p,{children:["O Logto fornece um ",(0,s.jsx)(o.a,{href:"https://www.rfc-editor.org/rfc/rfc7662.html",children:"endpoint de introspec\xe7\xe3o"})," que pode ser usado para validar tokens opacos. Por padr\xe3o, o endpoint de introspec\xe7\xe3o \xe9 ",(0,s.jsx)(o.code,{children:"/oidc/token/introspection"})," e aceita requisi\xe7\xf5es ",(0,s.jsx)(o.code,{children:"POST"}),". O seguinte par\xe2metro \xe9 necess\xe1rio:"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"token"}),": o token opaco a ser validado"]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:"O endpoint tamb\xe9m requer autentica\xe7\xe3o do cliente. Voc\xea pode usar um dos seguintes m\xe9todos:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Autentica\xe7\xe3o HTTP Basic: Use o cabe\xe7alho ",(0,s.jsx)(o.code,{children:"Authorization"})," com o valor ",(0,s.jsx)(o.code,{children:"Basic <base64-encoded-credentials>"}),". As credenciais devem ser o client ID e o client secret separados por dois pontos (",(0,s.jsx)(o.code,{children:":"}),") e codificados em base64."]}),"\n",(0,s.jsxs)(o.li,{children:["Autentica\xe7\xe3o HTTP POST: Use os par\xe2metros ",(0,s.jsx)(o.code,{children:"client_id"})," e ",(0,s.jsx)(o.code,{children:"client_secret"}),":","\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"client_id"}),": o client ID do aplicativo que solicitou o token"]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"client_secret"}),": o client secret do aplicativo que solicitou o token"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:'O client ID (app ID) e o client secret (app secret) podem ser as credenciais do aplicativo de qualquer aplicativo "web tradicional" ou "m\xe1quina para m\xe1quina" no Logto. O endpoint de introspec\xe7\xe3o retornar\xe1 um erro se as credenciais forem inv\xe1lidas.'}),"\n",(0,s.jsx)(o.p,{children:"O endpoint de introspec\xe7\xe3o retorna um objeto JSON com as reivindica\xe7\xf5es do token:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-json",children:'{\n  "active": true, // se o token \xe9 v\xe1lido ou n\xe3o\n  "sub": "1234567890" // o sujeito do token (o ID do usu\xe1rio)\n}\n'})}),"\n",(0,s.jsxs)(o.p,{children:["Se o token for inv\xe1lido, o campo ",(0,s.jsx)(o.code,{children:"active"})," ser\xe1 ",(0,s.jsx)(o.code,{children:"false"})," e o campo ",(0,s.jsx)(o.code,{children:"sub"})," ser\xe1 omitido."]}),"\n",(0,s.jsx)(o.p,{children:"Aqui est\xe1 um exemplo n\xe3o normativo da requisi\xe7\xe3o de introspec\xe7\xe3o:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-bash",children:"curl --location \\\n  --request POST 'https://[tenant-id].logto.app/oidc/token/introspection' \\\n  --header 'Content-Type: application/x-www-form-urlencoded' \\\n  --data-urlencode 'token=some-random-string' \\\n  --data-urlencode 'client_id=1234567890' \\\n  --data-urlencode 'client_secret=1234567890'\n"})}),"\n",(0,s.jsxs)(o.p,{children:["Lembre-se de substituir ",(0,s.jsx)(o.code,{children:"[tenant-id]"})," pelo seu tenant ID."]})]})}function p(e={}){const{wrapper:o}={...(0,c.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},15658:(e,o,n)=>{n.d(o,{R:()=>i,x:()=>r});var t=n(30758);const s={},c=t.createContext(s);function i(e){const o=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(c.Provider,{value:o},e.children)}}}]);